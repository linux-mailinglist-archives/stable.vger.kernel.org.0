Return-Path: <stable-owner@vger.kernel.org>
X-Original-To: lists+stable@lfdr.de
Delivered-To: lists+stable@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 8D07B4DD91F
	for <lists+stable@lfdr.de>; Fri, 18 Mar 2022 12:42:36 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S235932AbiCRLnw (ORCPT <rfc822;lists+stable@lfdr.de>);
        Fri, 18 Mar 2022 07:43:52 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:54484 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S235913AbiCRLnv (ORCPT
        <rfc822;stable@vger.kernel.org>); Fri, 18 Mar 2022 07:43:51 -0400
Received: from smtp-out1.suse.de (smtp-out1.suse.de [195.135.220.28])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id DABFC23D45D;
        Fri, 18 Mar 2022 04:42:32 -0700 (PDT)
Received: from relay2.suse.de (relay2.suse.de [149.44.160.134])
        by smtp-out1.suse.de (Postfix) with ESMTP id 96796210ED;
        Fri, 18 Mar 2022 11:42:31 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=suse.de; s=susede2_rsa;
        t=1647603751; h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
         mime-version:mime-version:content-type:content-type;
        bh=f1ZVdboT7c9rIoEb7RezDlk6NpIv+NmCnDrOMrXxS0A=;
        b=ceCTjOlCWBKYX3+xABN2FPaqDSejKfMkQpkv5gL6fy0ueCK/Wi8DM84w6tGEYtXJAHpVWo
        Llz5V9Rv87K814ny4nDJwcpvIu9Q99/kdD8x5bU6v7/U1Oa3Um/6Bv+0U+0fzhCGziVHGB
        t36DYVCjFHPa8zHYcKWqYFQiODBRcZU=
DKIM-Signature: v=1; a=ed25519-sha256; c=relaxed/relaxed; d=suse.de;
        s=susede2_ed25519; t=1647603751;
        h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
         mime-version:mime-version:content-type:content-type;
        bh=f1ZVdboT7c9rIoEb7RezDlk6NpIv+NmCnDrOMrXxS0A=;
        b=jr3ZSvPXFd/gNfLA5fgldpJISKVyteAJ7QgIKitygi0+2jeXqyKBMxc4UDdikP1+tiWD/1
        QRQR3F4JxnaAtvDw==
Received: from alsa1.suse.de (alsa1.suse.de [10.160.4.42])
        by relay2.suse.de (Postfix) with ESMTP id 69B4EA3B95;
        Fri, 18 Mar 2022 11:42:31 +0000 (UTC)
Date:   Fri, 18 Mar 2022 12:42:31 +0100
Message-ID: <s5htubv32s8.wl-tiwai@suse.de>
From:   Takashi Iwai <tiwai@suse.de>
To:     linux-input@vger.kernel.org
Cc:     =?UTF-8?B?Sm9zw6kgRXhww7NzaXRv?= <jose.exposito89@gmail.com>,
        Peter Hutterer <peter.hutterer@who-t.net>,
        Benjamin Tissoires <benjamin.tissoires@redhat.com>,
        Jiri Kosina <jkosina@suse.cz>, stable@vger.kernel.org,
        regressions@lists.linux.dev, linux-kernel@vger.kernel.org
Subject: [REGRESSION] Right touchpad button disabled on Dell 7750
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
X-Spam-Status: No, score=-4.4 required=5.0 tests=BAYES_00,DKIM_SIGNED,
        DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF,RCVD_IN_DNSWL_MED,SPF_HELO_NONE,
        SPF_PASS,T_SCC_BODY_TEXT_LINE autolearn=ham autolearn_force=no
        version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <stable.vger.kernel.org>
X-Mailing-List: stable@vger.kernel.org

Hi,

we received a bug report about the regression of the touchpad on Dell
7750 laptop, the right touchpad button is disabled on recent kernels:
  https://bugzilla.suse.com/show_bug.cgi?id=1197243

Note that it's a physical button, not a virtual clickpad button.

The regression seems introduced by the upstream commit
37ef4c19b4c659926ce65a7ac709ceaefb211c40 ("Input: clear
BTN_RIGHT/MIDDLE on buttonpads") that was backported to stable 5.16.x
kernel.

The device is managed by hid-multitouch driver, and the further
investigation revealed that it's rather an incorrectly recognized
buttonpad property; namely, ID_DG_BUTTONTYPE reports it being 0 =
clickable touchpad although it's not.  I built a test kernel to ignore
this check and it was confirmed to make the right button working again
by the reporter.

Is this check really correct in general?  Or do we need some
device-specific quirk?


thanks,

Takashi
