Return-Path: <stable-owner@vger.kernel.org>
X-Original-To: lists+stable@lfdr.de
Delivered-To: lists+stable@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 0AB5A6BB602
	for <lists+stable@lfdr.de>; Wed, 15 Mar 2023 15:30:04 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S232369AbjCOOaC (ORCPT <rfc822;lists+stable@lfdr.de>);
        Wed, 15 Mar 2023 10:30:02 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:55406 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S233190AbjCOO36 (ORCPT
        <rfc822;stable@vger.kernel.org>); Wed, 15 Mar 2023 10:29:58 -0400
Received: from smtp-out1.suse.de (smtp-out1.suse.de [195.135.220.28])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 597491D93E;
        Wed, 15 Mar 2023 07:29:55 -0700 (PDT)
Received: from imap2.suse-dmz.suse.de (imap2.suse-dmz.suse.de [192.168.254.74])
        (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
         key-exchange X25519 server-signature ECDSA (P-521) server-digest SHA512)
        (No client certificate requested)
        by smtp-out1.suse.de (Postfix) with ESMTPS id 15F3D21998;
        Wed, 15 Mar 2023 14:29:54 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=suse.de; s=susede2_rsa;
        t=1678890594; h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
         mime-version:mime-version:content-type:content-type:
         in-reply-to:in-reply-to:references:references;
        bh=pEEvvpkPPugTcbTlcdMI/RxLPz8sFar3C0rRm+fPlmw=;
        b=Vn4gYdbQ4e9NdYVtScnkQUz09x3bkUttpdsGtFLLI5vGXCdSU6FYOvABEe/1FpAiBjOK29
        HeJSzaK2zPbMjIhrppn4Uiyjdz2U9TdgBr6ikCChSF+UT7VheaP57obw0gQ2W6nOwIMazJ
        P03YZCKB/TwZGZqgp17LfXCuyKtgxgY=
DKIM-Signature: v=1; a=ed25519-sha256; c=relaxed/relaxed; d=suse.de;
        s=susede2_ed25519; t=1678890594;
        h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
         mime-version:mime-version:content-type:content-type:
         in-reply-to:in-reply-to:references:references;
        bh=pEEvvpkPPugTcbTlcdMI/RxLPz8sFar3C0rRm+fPlmw=;
        b=HZFaonGWBQfk2UAnBL7sSeNfDYOrKbu2430078pgORh52tk//5VpWOLPIZClBfa6RQA68p
        aV9112ktx+uyDEBw==
Received: from imap2.suse-dmz.suse.de (imap2.suse-dmz.suse.de [192.168.254.74])
        (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
         key-exchange X25519 server-signature ECDSA (P-521) server-digest SHA512)
        (No client certificate requested)
        by imap2.suse-dmz.suse.de (Postfix) with ESMTPS id D8D4E13A2F;
        Wed, 15 Mar 2023 14:29:53 +0000 (UTC)
Received: from dovecot-director2.suse.de ([192.168.254.65])
        by imap2.suse-dmz.suse.de with ESMTPSA
        id iSY1NGHWEWRCSgAAMHmgww
        (envelope-from <tiwai@suse.de>); Wed, 15 Mar 2023 14:29:53 +0000
Date:   Wed, 15 Mar 2023 15:29:53 +0100
Message-ID: <87o7ou9jfi.wl-tiwai@suse.de>
From:   Takashi Iwai <tiwai@suse.de>
To:     Jetro Jormalainen <jje-lxkl@jetro.fi>
Cc:     Meng Tang <tangmeng@uniontech.com>, regressions@lists.linux.dev,
        linux-kernel@vger.kernel.org, Takashi Iwai <tiwai@suse.de>,
        stable@vger.kernel.org
Subject: Re: [REGRESSION] External mic not working on Lenovo Ideapad U310, ALSA: hda/conexant: Add quirk for LENOVO 20149 Notebook model
In-Reply-To: <20230308215009.4d3e58a6@mopti>
References: <20230308215009.4d3e58a6@mopti>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) Emacs/27.2 Mule/6.0
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
X-Spam-Status: No, score=-4.4 required=5.0 tests=BAYES_00,DKIM_SIGNED,
        DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF,RCVD_IN_DNSWL_MED,SPF_HELO_NONE,
        SPF_PASS,URIBL_BLOCKED autolearn=ham autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <stable.vger.kernel.org>
X-Mailing-List: stable@vger.kernel.org

On Wed, 08 Mar 2023 20:50:09 +0100,
Jetro Jormalainen wrote:
> 
> External mic on Lenovo Ideapad U310 has not been working with and
> after 5.19.2 release. Same problem still exists on 6.3.0-rc1. Reverting
> this commit makes external mic to work on 6.3.0-rc1. These were tested
> on vanilla kernels.
> 
> Bisecting shows that this commit breaks external mic:
> f83bb2592482fe94c6eea07a8121763c80f36ce5
> ALSA: hda/conexant: Add quirk for LENOVO 20149 Notebook model

Sounds like multiple models using the same PCI SSID.
Could you share the alsa-info.sh output?
Meng, also could you give alsa-info.sh output of Lenovo 20149, too?


thanks,

Takashi


> After this commit Pulseaudio only shows "Microphone" port as before
> there was "Internal microphone" and "Microphone". However when
> recording this "Microphone" port that seems to record internal
> microphone. External mic cannot be recorded at all after this commit.
> 
> External mic not working (dmesg):
> 
> [    7.565222] snd_hda_codec_conexant hdaudioC1D0: CX20590: BIOS auto-probing.
> [    7.566141] snd_hda_codec_conexant hdaudioC1D0: autoconfig for CX20590: line_outs=1 (0x1f/0x0/0x0/0x0/0x0) type:speaker
> [    7.566152] snd_hda_codec_conexant hdaudioC1D0:    speaker_outs=0 (0x0/0x0/0x0/0x0/0x0)
> [    7.566158] snd_hda_codec_conexant hdaudioC1D0:    hp_outs=1 (0x19/0x0/0x0/0x0/0x0)
> [    7.566162] snd_hda_codec_conexant hdaudioC1D0:    mono: mono_out=0x0
> [    7.566166] snd_hda_codec_conexant hdaudioC1D0:    inputs:
> [    7.566169] snd_hda_codec_conexant hdaudioC1D0:      Mic=0x23
> [    7.566172] snd_hda_codec_conexant hdaudioC1D0:    dig-in=0x1a
> 
> External mic working (dmesg):
> 
> [    8.381160] snd_hda_codec_conexant hdaudioC1D0: CX20590: BIOS auto-probing.
> [    8.381691] snd_hda_codec_conexant hdaudioC1D0: autoconfig for CX20590: line_outs=1 (0x1f/0x0/0x0/0x0/0x0) type:speaker
> [    8.381700] snd_hda_codec_conexant hdaudioC1D0:    speaker_outs=0 (0x0/0x0/0x0/0x0/0x0)
> [    8.381705] snd_hda_codec_conexant hdaudioC1D0:    hp_outs=1 (0x19/0x0/0x0/0x0/0x0)
> [    8.381710] snd_hda_codec_conexant hdaudioC1D0:    mono: mono_out=0x0
> [    8.381714] snd_hda_codec_conexant hdaudioC1D0:    inputs:
> [    8.381717] snd_hda_codec_conexant hdaudioC1D0:      Internal Mic=0x23
> [    8.381721] snd_hda_codec_conexant hdaudioC1D0:      Mic=0x1a
> 
> 
> cat /proc/version:
> Linux version 6.3.0-rc1-1 (linux@archlinux) (gcc (GCC) 12.2.1 20230201, GNU ld (GNU Binutils) 2.40) #10 SMP PREEMPT_DYNAMIC Wed, 08 Mar 2023 17:45:22 +0000
> 
> hostnamectl | grep "Operating System":
> Operating System: Arch Linux
> 
> uname -mi:
> x86_64 unknown
> 
> #regzbot introduced: f83bb2592482

