Return-Path: <stable-owner@vger.kernel.org>
X-Original-To: lists+stable@lfdr.de
Delivered-To: lists+stable@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id DC37813B33A
	for <lists+stable@lfdr.de>; Tue, 14 Jan 2020 20:50:24 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1728863AbgANTuU (ORCPT <rfc822;lists+stable@lfdr.de>);
        Tue, 14 Jan 2020 14:50:20 -0500
Received: from imap2.colo.codethink.co.uk ([78.40.148.184]:33090 "EHLO
        imap2.colo.codethink.co.uk" rhost-flags-OK-OK-OK-OK)
        by vger.kernel.org with ESMTP id S1728761AbgANTuT (ORCPT
        <rfc822;stable@vger.kernel.org>); Tue, 14 Jan 2020 14:50:19 -0500
Received: from [167.98.27.226] (helo=xylophone)
        by imap2.colo.codethink.co.uk with esmtpsa  (Exim 4.92 #3 (Debian))
        id 1irSCc-0005FL-IV; Tue, 14 Jan 2020 19:50:14 +0000
Message-ID: <a6abde17a846dddb081b603615b6c2ad530deec9.camel@codethink.co.uk>
Subject: [4.9-stable] Mostly security fixes
From:   Ben Hutchings <ben.hutchings@codethink.co.uk>
To:     Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
        Sasha Levin <Alexander.Levin@microsoft.com>
Cc:     stable <stable@vger.kernel.org>
Date:   Tue, 14 Jan 2020 19:50:14 +0000
Organization: Codethink Ltd.
Content-Type: multipart/mixed; boundary="=-9IbwdlaL6lCQYKApHd02"
User-Agent: Evolution 3.30.5-1.1 
MIME-Version: 1.0
Sender: stable-owner@vger.kernel.org
Precedence: bulk
List-ID: <stable.vger.kernel.org>
X-Mailing-List: stable@vger.kernel.org


--=-9IbwdlaL6lCQYKApHd02
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: 7bit

Some more fixes that required backporting for 4.9.  All these fixes
are related to CVEs though some of them don't seem to have any security
impact.

Ben.

-- 
Ben Hutchings, Software Developer                         Codethink Ltd
https://www.codethink.co.uk/                 Dale House, 35 Dale Street
                                     Manchester, M1 2HF, United Kingdom

--=-9IbwdlaL6lCQYKApHd02
Content-Type: application/mbox; name="security-4.9.mbox"
Content-Disposition: attachment; filename="security-4.9.mbox"
Content-Transfer-Encoding: base64

RnJvbSBhZmRmODA1MjY5NTQzMzA5YTYxMjIwYTEwZGM3YjU1N2RhNTQ5MWNjIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBTYW5qYXkgS29uZHVyaSA8c2FuamF5LmtvbmR1cmlAcmVkcGlu
ZXNpZ25hbHMuY29tPgpEYXRlOiBUdWUsIDE1IE1heSAyMDE4IDE0OjM0OjMwICswNTMwClN1Ympl
Y3Q6IHJzaTogYWRkIGZpeCBmb3IgY3Jhc2ggZHVyaW5nIGFzc2VydGlvbnMKCmNvbW1pdCBhYmQz
OWM2ZGVkOWRiNTNhYTQ0YzI1NDAwOTJiZGQ1ZmI2NTkwZmE4IHVwc3RyZWFtLgoKT2JzZXJ2ZWQg
Y3Jhc2ggaW4gc29tZSBzY2VuYXJpb3Mgd2hlbiBhc3NlcnRpb24gaGFzIG9jY3VycmVkLAp0aGlz
IGlzIGJlY2F1c2UgaHcgc3RydWN0dXJlIGlzIGZyZWVkIGFuZCBpcyB0cmllZCB0byBnZXQKYWNj
ZXNzZWQgaW4gc29tZSBmdW5jdGlvbnMgd2hlcmUgbnVsbCBjaGVjayBpcyBhbHJlYWR5CnByZXNl
bnQuIFNvLCBhdm9pZGVkIHRoZSBjcmFzaCBieSBtYWtpbmcgdGhlIGh3IHRvIE5VTEwgYWZ0ZXIK
ZnJlZWluZy4KClNpZ25lZC1vZmYtYnk6IFNhbmpheSBLb25kdXJpIDxzYW5qYXkua29uZHVyaUBy
ZWRwaW5lc2lnbmFscy5jb20+ClNpZ25lZC1vZmYtYnk6IFN1c2hhbnQgS3VtYXIgTWlzaHJhIDxz
dXNoYW50Lm1pc2hyYUByZWRwaW5lc2lnbmFscy5jb20+ClNpZ25lZC1vZmYtYnk6IEthbGxlIFZh
bG8gPGt2YWxvQGNvZGVhdXJvcmEub3JnPgpTaWduZWQtb2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxi
ZW4uaHV0Y2hpbmdzQGNvZGV0aGluay5jby51az4KLS0tCiBkcml2ZXJzL25ldC93aXJlbGVzcy9y
c2kvcnNpXzkxeF9tYWM4MDIxMS5jIHwgMSArCiAxIGZpbGUgY2hhbmdlZCwgMSBpbnNlcnRpb24o
KykKCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC93aXJlbGVzcy9yc2kvcnNpXzkxeF9tYWM4MDIx
MS5jIGIvZHJpdmVycy9uZXQvd2lyZWxlc3MvcnNpL3JzaV85MXhfbWFjODAyMTEuYwppbmRleCBk
YmIyMzg5OWRkY2IuLjg5MTI5NWViZDg3NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQvd2lyZWxl
c3MvcnNpL3JzaV85MXhfbWFjODAyMTEuYworKysgYi9kcml2ZXJzL25ldC93aXJlbGVzcy9yc2kv
cnNpXzkxeF9tYWM4MDIxMS5jCkBAIC0xOTksNiArMTk5LDcgQEAgdm9pZCByc2lfbWFjODAyMTFf
ZGV0YWNoKHN0cnVjdCByc2lfaHcgKmFkYXB0ZXIpCiAJCWllZWU4MDIxMV9zdG9wX3F1ZXVlcyho
dyk7CiAJCWllZWU4MDIxMV91bnJlZ2lzdGVyX2h3KGh3KTsKIAkJaWVlZTgwMjExX2ZyZWVfaHco
aHcpOworCQlhZGFwdGVyLT5odyA9IE5VTEw7CiAJfQogCiAJcnNpX3JlbW92ZV9kYmdmcyhhZGFw
dGVyKTsKCkZyb20gMDljYzlmMWZiMGVkNzQwZGJmNmMxMDMyMzYxNDIzNzJmMWU4Mjk3YSBNb24g
U2VwIDE3IDAwOjAwOjAwIDIwMDEKRnJvbTogQXJkIEJpZXNoZXV2ZWwgPGFyZC5iaWVzaGV1dmVs
QGxpbmFyby5vcmc+CkRhdGU6IEZyaSwgMjEgT2N0IDIwMTYgMTI6MjI6NTYgKzAxMDAKU3ViamVj
dDogYXJtNjQ6IG1tOiBCVUcgb24gdW5zdXBwb3J0ZWQgbWFuaXB1bGF0aW9ucyBvZiBsaXZlIGtl
cm5lbCBtYXBwaW5ncwoKY29tbWl0IGU5ODIxNmI1MjE3NmJhMmJmYTRiZGIwMmYxNzhmNGQwODgz
MmQ0NjUgdXBzdHJlYW0uCgpOb3cgdGhhdCB3ZSB0YWtlIGNhcmUgbm90IG1hbmlwdWxhdGUgdGhl
IGxpdmUga2VybmVsIHBhZ2UgdGFibGVzIGluIGEKd2F5IHRoYXQgbWF5IGxlYWQgdG8gVExCIGNv
bmZsaWN0cywgdGhlIGNhc2Ugd2hlcmUgYSB0YWJsZSBtYXBwaW5nIGlzCnJlcGxhY2VkIGJ5IGEg
YmxvY2sgbWFwcGluZyBjYW4gbm8gbG9uZ2VyIG9jY3VyLiBTbyByZW1vdmUgdGhlIGhhbmRsaW5n
Cm9mIHRoaXMgYXQgdGhlIFBVRCBhbmQgUE1EIGxldmVscywgYW5kIGluc3RlYWQsIEJVRygpIG9u
IGFueSBvY2N1cnJlbmNlCm9mIGxpdmUga2VybmVsIHBhZ2UgdGFibGUgbWFuaXB1bGF0aW9ucyB0
aGF0IG1vZGlmeSBhbnl0aGluZyBvdGhlciB0aGFuCnRoZSBwZXJtaXNzaW9uIGJpdHMuCgpTaW5j
ZSBtYXJrX3JvZGF0YV9ybygpIGlzIHRoZSBvbmx5IGNhbGxlciB3aGVyZSB0aGUga2VybmVsIG1h
cHBpbmdzIHRoYXQKYXJlIGJlaW5nIG1hbmlwdWxhdGVkIGFyZSBhY3R1YWxseSBsaXZlLCBkcm9w
IHRoZSB2YXJpb3VzIGNvbmRpdGlvbmFsCmZsdXNoX3RsYl9hbGwoKSBpbnZvY2F0aW9ucywgYW5k
IGFkZCBhIHNpbmdsZSBjYWxsIHRvIG1hcmtfcm9kYXRhX3JvKCkKaW5zdGVhZC4KClNpZ25lZC1v
ZmYtYnk6IEFyZCBCaWVzaGV1dmVsIDxhcmQuYmllc2hldXZlbEBsaW5hcm8ub3JnPgpTaWduZWQt
b2ZmLWJ5OiBDYXRhbGluIE1hcmluYXMgPGNhdGFsaW4ubWFyaW5hc0Bhcm0uY29tPgpTaWduZWQt
b2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxiZW4uaHV0Y2hpbmdzQGNvZGV0aGluay5jby51az4KLS0t
CiBhcmNoL2FybTY0L21tL21tdS5jIHwgNzAgKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0t
LS0tLS0tLS0tLS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgNDMgaW5zZXJ0aW9ucygrKSwgMjcgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvYXJjaC9hcm02NC9tbS9tbXUuYyBiL2FyY2gvYXJtNjQv
bW0vbW11LmMKaW5kZXggZWZkNjVmYzg1MjM4Li5iOTFlZTFlOGRjY2MgMTAwNjQ0Ci0tLSBhL2Fy
Y2gvYXJtNjQvbW0vbW11LmMKKysrIGIvYXJjaC9hcm02NC9tbS9tbXUuYwpAQCAtMjgsOCArMjgs
NiBAQAogI2luY2x1ZGUgPGxpbnV4L21lbWJsb2NrLmg+CiAjaW5jbHVkZSA8bGludXgvZnMuaD4K
ICNpbmNsdWRlIDxsaW51eC9pby5oPgotI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4KLSNpbmNsdWRl
IDxsaW51eC9zdG9wX21hY2hpbmUuaD4KIAogI2luY2x1ZGUgPGFzbS9iYXJyaWVyLmg+CiAjaW5j
bHVkZSA8YXNtL2NwdXR5cGUuaD4KQEAgLTk1LDYgKzkzLDE3IEBAIHN0YXRpYyBwaHlzX2FkZHJf
dCBfX2luaXQgZWFybHlfcGd0YWJsZV9hbGxvYyh2b2lkKQogCXJldHVybiBwaHlzOwogfQogCitz
dGF0aWMgYm9vbCBwZ2F0dHJfY2hhbmdlX2lzX3NhZmUodTY0IG9sZCwgdTY0IG5ldykKK3sKKwkv
KgorCSAqIFRoZSBmb2xsb3dpbmcgbWFwcGluZyBhdHRyaWJ1dGVzIG1heSBiZSB1cGRhdGVkIGlu
IGxpdmUKKwkgKiBrZXJuZWwgbWFwcGluZ3Mgd2l0aG91dCB0aGUgbmVlZCBmb3IgYnJlYWstYmVm
b3JlLW1ha2UuCisJICovCisJc3RhdGljIGNvbnN0IHB0ZXZhbF90IG1hc2sgPSBQVEVfUFhOIHwg
UFRFX1JET05MWSB8IFBURV9XUklURTsKKworCXJldHVybiBvbGQgID09IDAgfHwgbmV3ICA9PSAw
IHx8ICgob2xkIF4gbmV3KSAmIH5tYXNrKSA9PSAwOworfQorCiBzdGF0aWMgdm9pZCBhbGxvY19p
bml0X3B0ZShwbWRfdCAqcG1kLCB1bnNpZ25lZCBsb25nIGFkZHIsCiAJCQkJICB1bnNpZ25lZCBs
b25nIGVuZCwgdW5zaWduZWQgbG9uZyBwZm4sCiAJCQkJICBwZ3Byb3RfdCBwcm90LApAQCAtMTE1
LDggKzEyNCwxNyBAQCBzdGF0aWMgdm9pZCBhbGxvY19pbml0X3B0ZShwbWRfdCAqcG1kLCB1bnNp
Z25lZCBsb25nIGFkZHIsCiAKIAlwdGUgPSBwdGVfc2V0X2ZpeG1hcF9vZmZzZXQocG1kLCBhZGRy
KTsKIAlkbyB7CisJCXB0ZV90IG9sZF9wdGUgPSAqcHRlOworCiAJCXNldF9wdGUocHRlLCBwZm5f
cHRlKHBmbiwgcHJvdCkpOwogCQlwZm4rKzsKKworCQkvKgorCQkgKiBBZnRlciB0aGUgUFRFIGVu
dHJ5IGhhcyBiZWVuIHBvcHVsYXRlZCBvbmNlLCB3ZQorCQkgKiBvbmx5IGFsbG93IHVwZGF0ZXMg
dG8gdGhlIHBlcm1pc3Npb24gYXR0cmlidXRlcy4KKwkJICovCisJCUJVR19PTighcGdhdHRyX2No
YW5nZV9pc19zYWZlKHB0ZV92YWwob2xkX3B0ZSksIHB0ZV92YWwoKnB0ZSkpKTsKKwogCX0gd2hp
bGUgKHB0ZSsrLCBhZGRyICs9IFBBR0VfU0laRSwgYWRkciAhPSBlbmQpOwogCiAJcHRlX2NsZWFy
X2ZpeG1hcCgpOwpAQCAtMTQ2LDI3ICsxNjQsMjcgQEAgc3RhdGljIHZvaWQgYWxsb2NfaW5pdF9w
bWQocHVkX3QgKnB1ZCwgdW5zaWduZWQgbG9uZyBhZGRyLCB1bnNpZ25lZCBsb25nIGVuZCwKIAog
CXBtZCA9IHBtZF9zZXRfZml4bWFwX29mZnNldChwdWQsIGFkZHIpOwogCWRvIHsKKwkJcG1kX3Qg
b2xkX3BtZCA9ICpwbWQ7CisKIAkJbmV4dCA9IHBtZF9hZGRyX2VuZChhZGRyLCBlbmQpOworCiAJ
CS8qIHRyeSBzZWN0aW9uIG1hcHBpbmcgZmlyc3QgKi8KIAkJaWYgKCgoYWRkciB8IG5leHQgfCBw
aHlzKSAmIH5TRUNUSU9OX01BU0spID09IDAgJiYKIAkJICAgICAgYWxsb3dfYmxvY2tfbWFwcGlu
Z3MpIHsKLQkJCXBtZF90IG9sZF9wbWQgPSpwbWQ7CiAJCQlwbWRfc2V0X2h1Z2UocG1kLCBwaHlz
LCBwcm90KTsKKwogCQkJLyoKLQkJCSAqIENoZWNrIGZvciBwcmV2aW91cyB0YWJsZSBlbnRyaWVz
IGNyZWF0ZWQgZHVyaW5nCi0JCQkgKiBib290IChfX2NyZWF0ZV9wYWdlX3RhYmxlcykgYW5kIGZs
dXNoIHRoZW0uCisJCQkgKiBBZnRlciB0aGUgUE1EIGVudHJ5IGhhcyBiZWVuIHBvcHVsYXRlZCBv
bmNlLCB3ZQorCQkJICogb25seSBhbGxvdyB1cGRhdGVzIHRvIHRoZSBwZXJtaXNzaW9uIGF0dHJp
YnV0ZXMuCiAJCQkgKi8KLQkJCWlmICghcG1kX25vbmUob2xkX3BtZCkpIHsKLQkJCQlmbHVzaF90
bGJfYWxsKCk7Ci0JCQkJaWYgKHBtZF90YWJsZShvbGRfcG1kKSkgewotCQkJCQlwaHlzX2FkZHJf
dCB0YWJsZSA9IHBtZF9wYWdlX3BhZGRyKG9sZF9wbWQpOwotCQkJCQlpZiAoIVdBUk5fT05fT05D
RShzbGFiX2lzX2F2YWlsYWJsZSgpKSkKLQkJCQkJCW1lbWJsb2NrX2ZyZWUodGFibGUsIFBBR0Vf
U0laRSk7Ci0JCQkJfQotCQkJfQorCQkJQlVHX09OKCFwZ2F0dHJfY2hhbmdlX2lzX3NhZmUocG1k
X3ZhbChvbGRfcG1kKSwKKwkJCQkJCSAgICAgIHBtZF92YWwoKnBtZCkpKTsKIAkJfSBlbHNlIHsK
IAkJCWFsbG9jX2luaXRfcHRlKHBtZCwgYWRkciwgbmV4dCwgX19waHlzX3RvX3BmbihwaHlzKSwK
IAkJCQkgICAgICAgcHJvdCwgcGd0YWJsZV9hbGxvYyk7CisKKwkJCUJVR19PTihwbWRfdmFsKG9s
ZF9wbWQpICE9IDAgJiYKKwkJCSAgICAgICBwbWRfdmFsKG9sZF9wbWQpICE9IHBtZF92YWwoKnBt
ZCkpOwogCQl9CiAJCXBoeXMgKz0gbmV4dCAtIGFkZHI7CiAJfSB3aGlsZSAocG1kKyssIGFkZHIg
PSBuZXh0LCBhZGRyICE9IGVuZCk7CkBAIC0yMDQsMzMgKzIyMiwyOCBAQCBzdGF0aWMgdm9pZCBh
bGxvY19pbml0X3B1ZChwZ2RfdCAqcGdkLCB1bnNpZ25lZCBsb25nIGFkZHIsIHVuc2lnbmVkIGxv
bmcgZW5kLAogCiAJcHVkID0gcHVkX3NldF9maXhtYXBfb2Zmc2V0KHBnZCwgYWRkcik7CiAJZG8g
eworCQlwdWRfdCBvbGRfcHVkID0gKnB1ZDsKKwogCQluZXh0ID0gcHVkX2FkZHJfZW5kKGFkZHIs
IGVuZCk7CiAKIAkJLyoKIAkJICogRm9yIDRLIGdyYW51bGUgb25seSwgYXR0ZW1wdCB0byBwdXQg
ZG93biBhIDFHQiBibG9jawogCQkgKi8KIAkJaWYgKHVzZV8xR19ibG9jayhhZGRyLCBuZXh0LCBw
aHlzKSAmJiBhbGxvd19ibG9ja19tYXBwaW5ncykgewotCQkJcHVkX3Qgb2xkX3B1ZCA9ICpwdWQ7
CiAJCQlwdWRfc2V0X2h1Z2UocHVkLCBwaHlzLCBwcm90KTsKIAogCQkJLyoKLQkJCSAqIElmIHdl
IGhhdmUgYW4gb2xkIHZhbHVlIGZvciBhIHB1ZCwgaXQgd2lsbAotCQkJICogYmUgcG9pbnRpbmcg
dG8gYSBwbWQgdGFibGUgdGhhdCB3ZSBubyBsb25nZXIKLQkJCSAqIG5lZWQgKGZyb20gc3dhcHBl
cl9wZ19kaXIpLgotCQkJICoKLQkJCSAqIExvb2sgdXAgdGhlIG9sZCBwbWQgdGFibGUgYW5kIGZy
ZWUgaXQuCisJCQkgKiBBZnRlciB0aGUgUFVEIGVudHJ5IGhhcyBiZWVuIHBvcHVsYXRlZCBvbmNl
LCB3ZQorCQkJICogb25seSBhbGxvdyB1cGRhdGVzIHRvIHRoZSBwZXJtaXNzaW9uIGF0dHJpYnV0
ZXMuCiAJCQkgKi8KLQkJCWlmICghcHVkX25vbmUob2xkX3B1ZCkpIHsKLQkJCQlmbHVzaF90bGJf
YWxsKCk7Ci0JCQkJaWYgKHB1ZF90YWJsZShvbGRfcHVkKSkgewotCQkJCQlwaHlzX2FkZHJfdCB0
YWJsZSA9IHB1ZF9wYWdlX3BhZGRyKG9sZF9wdWQpOwotCQkJCQlpZiAoIVdBUk5fT05fT05DRShz
bGFiX2lzX2F2YWlsYWJsZSgpKSkKLQkJCQkJCW1lbWJsb2NrX2ZyZWUodGFibGUsIFBBR0VfU0la
RSk7Ci0JCQkJfQotCQkJfQorCQkJQlVHX09OKCFwZ2F0dHJfY2hhbmdlX2lzX3NhZmUocHVkX3Zh
bChvbGRfcHVkKSwKKwkJCQkJCSAgICAgIHB1ZF92YWwoKnB1ZCkpKTsKIAkJfSBlbHNlIHsKIAkJ
CWFsbG9jX2luaXRfcG1kKHB1ZCwgYWRkciwgbmV4dCwgcGh5cywgcHJvdCwKIAkJCQkgICAgICAg
cGd0YWJsZV9hbGxvYywgYWxsb3dfYmxvY2tfbWFwcGluZ3MpOworCisJCQlCVUdfT04ocHVkX3Zh
bChvbGRfcHVkKSAhPSAwICYmCisJCQkgICAgICAgcHVkX3ZhbChvbGRfcHVkKSAhPSBwdWRfdmFs
KCpwdWQpKTsKIAkJfQogCQlwaHlzICs9IG5leHQgLSBhZGRyOwogCX0gd2hpbGUgKHB1ZCsrLCBh
ZGRyID0gbmV4dCwgYWRkciAhPSBlbmQpOwpAQCAtMzk2LDYgKzQwOSw5IEBAIHZvaWQgbWFya19y
b2RhdGFfcm8odm9pZCkKIAlzZWN0aW9uX3NpemUgPSAodW5zaWduZWQgbG9uZylfX2luaXRfYmVn
aW4gLSAodW5zaWduZWQgbG9uZylfX3N0YXJ0X3JvZGF0YTsKIAljcmVhdGVfbWFwcGluZ19sYXRl
KF9fcGEoX19zdGFydF9yb2RhdGEpLCAodW5zaWduZWQgbG9uZylfX3N0YXJ0X3JvZGF0YSwKIAkJ
CSAgICBzZWN0aW9uX3NpemUsIFBBR0VfS0VSTkVMX1JPKTsKKworCS8qIGZsdXNoIHRoZSBUTEJz
IGFmdGVyIHVwZGF0aW5nIGxpdmUga2VybmVsIG1hcHBpbmdzICovCisJZmx1c2hfdGxiX2FsbCgp
OwogfQogCiBzdGF0aWMgdm9pZCBfX2luaXQgbWFwX2tlcm5lbF9zZWdtZW50KHBnZF90ICpwZ2Qs
IHZvaWQgKnZhX3N0YXJ0LCB2b2lkICp2YV9lbmQsCgpGcm9tIGVmMGVjMmI2ZjEzZWU3OTQ0ZTgw
ZDQzYjdmZDMwMzk2YTQ5MmQ5NmIgTW9uIFNlcCAxNyAwMDowMDowMCAyMDAxCkZyb206IEtyaXN0
aW5hIE1hcnRzZW5rbyA8a3Jpc3RpbmEubWFydHNlbmtvQGFybS5jb20+CkRhdGU6IFdlZCwgMTMg
RGVjIDIwMTcgMTc6MDc6MjAgKzAwMDAKU3ViamVjdDogYXJtNjQ6IGRvbid0IG9wZW4gY29kZSBw
YWdlIHRhYmxlIGVudHJ5IGNyZWF0aW9uCgpjb21taXQgMTkzMzgzMDQzZjE0YTM5ODM5M2RjMThi
YWU4MzgwZjdmZTY2NWVjMyB1cHN0cmVhbS4KCkluc3RlYWQgb2Ygb3BlbiBjb2RpbmcgdGhlIGdl
bmVyYXRpb24gb2YgcGFnZSB0YWJsZSBlbnRyaWVzLCB1c2UgdGhlCm1hY3Jvcy9mdW5jdGlvbnMg
dGhhdCBleGlzdCBmb3IgdGhpcyAtIHBmbl9wKmQgYW5kIHAqZF9wb3B1bGF0ZS4gTW9zdApjb2Rl
IGluIHRoZSBrZXJuZWwgYWxyZWFkeSB1c2VzIHRoZXNlIG1hY3JvcywgdGhpcyBwYXRjaCB0cmll
cyB0byBmaXgKdXAgdGhlIGZldyBwbGFjZXMgdGhhdCBkb24ndC4gVGhpcyBpcyB1c2VmdWwgZm9y
IHRoZSBuZXh0IHBhdGNoIGluIHRoaXMKc2VyaWVzLCB3aGljaCBuZWVkcyB0byBjaGFuZ2UgdGhl
IHBhZ2UgdGFibGUgZW50cnkgbG9naWMsIGFuZCBpdCdzCmJldHRlciB0byBoYXZlIHRoYXQgbG9n
aWMgaW4gb25lIHBsYWNlLgoKVGhlIEtWTSBleHRlbmRlZCBJRCBtYXAgaXMgc3BlY2lhbCwgc2lu
Y2Ugd2UncmUgY3JlYXRpbmcgYSBsZXZlbCBhYm92ZQpDT05GSUdfUEdUQUJMRV9MRVZFTFMgYW5k
IHRoZSByZXF1aXJlZCBmdW5jdGlvbiBpc24ndCBhdmFpbGFibGUuIExlYXZlCml0IGFzIGlzIGFu
ZCBhZGQgYSBjb21tZW50IHRvIGV4cGxhaW4gaXQuIChUaGUgbm9ybWFsIGtlcm5lbCBJRCBtYXAg
Y29kZQpkb2Vzbid0IG5lZWQgdGhpcyBjaGFuZ2UgYmVjYXVzZSBpdHMgcGFnZSB0YWJsZXMgYXJl
IGNyZWF0ZWQgaW4gYXNzZW1ibHkKKF9fY3JlYXRlX3BhZ2VfdGFibGVzKSkuCgpUZXN0ZWQtYnk6
IFN1enVraSBLIFBvdWxvc2UgPHN1enVraS5wb3Vsb3NlQGFybS5jb20+ClJldmlld2VkLWJ5OiBT
dXp1a2kgSyBQb3Vsb3NlIDxzdXp1a2kucG91bG9zZUBhcm0uY29tPgpSZXZpZXdlZC1ieTogTWFy
YyBaeW5naWVyIDxtYXJjLnp5bmdpZXJAYXJtLmNvbT4KVGVzdGVkLWJ5OiBCb2IgUGljY28gPGJv
Yi5waWNjb0BvcmFjbGUuY29tPgpSZXZpZXdlZC1ieTogQm9iIFBpY2NvIDxib2IucGljY29Ab3Jh
Y2xlLmNvbT4KU2lnbmVkLW9mZi1ieTogS3Jpc3RpbmEgTWFydHNlbmtvIDxrcmlzdGluYS5tYXJ0
c2Vua29AYXJtLmNvbT4KU2lnbmVkLW9mZi1ieTogQ2F0YWxpbiBNYXJpbmFzIDxjYXRhbGluLm1h
cmluYXNAYXJtLmNvbT4KW2J3aDogQmFja3BvcnRlZCB0byA0Ljk6IGFkanVzdCBjb250ZXh0XQpT
aWduZWQtb2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxiZW4uaHV0Y2hpbmdzQGNvZGV0aGluay5jby51
az4KLS0tCiBhcmNoL2FybTY0L2luY2x1ZGUvYXNtL2t2bV9tbXUuaCB8ICA1ICsrKysrCiBhcmNo
L2FybTY0L2luY2x1ZGUvYXNtL3BndGFibGUuaCB8ICAxICsKIGFyY2gvYXJtNjQva2VybmVsL2hp
YmVybmF0ZS5jICAgIHwgIDMgKy0tCiBhcmNoL2FybTY0L21tL21tdS5jICAgICAgICAgICAgICB8
IDE0ICsrKysrKysrKy0tLS0tCiA0IGZpbGVzIGNoYW5nZWQsIDE2IGluc2VydGlvbnMoKyksIDcg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvYXJjaC9hcm02NC9pbmNsdWRlL2FzbS9rdm1fbW11
LmggYi9hcmNoL2FybTY0L2luY2x1ZGUvYXNtL2t2bV9tbXUuaAppbmRleCA1NDc1MTlhYmM3NTEu
LmZmNzIxNjU5ZWI5NCAxMDA2NDQKLS0tIGEvYXJjaC9hcm02NC9pbmNsdWRlL2FzbS9rdm1fbW11
LmgKKysrIGIvYXJjaC9hcm02NC9pbmNsdWRlL2FzbS9rdm1fbW11LmgKQEAgLTMwMCw2ICszMDAs
MTEgQEAgc3RhdGljIGlubGluZSBib29sIF9fa3ZtX2NwdV91c2VzX2V4dGVuZGVkX2lkbWFwKHZv
aWQpCiAJcmV0dXJuIF9fY3B1X3VzZXNfZXh0ZW5kZWRfaWRtYXAoKTsKIH0KIAorLyoKKyAqIENh
bid0IHVzZSBwZ2RfcG9wdWxhdGUgaGVyZSwgYmVjYXVzZSB0aGUgZXh0ZW5kZWQgaWRtYXAgYWRk
cyBhbiBleHRyYSBsZXZlbAorICogYWJvdmUgQ09ORklHX1BHVEFCTEVfTEVWRUxTICh3aGljaCBp
cyAyIG9yIDMgaWYgd2UncmUgdXNpbmcgdGhlIGV4dGVuZGVkCisgKiBpZG1hcCksIGFuZCBwZ2Rf
cG9wdWxhdGUgaXMgb25seSBhdmFpbGFibGUgaWYgQ09ORklHX1BHVEFCTEVfTEVWRUxTID0gNC4K
KyAqLwogc3RhdGljIGlubGluZSB2b2lkIF9fa3ZtX2V4dGVuZF9oeXBtYXAocGdkX3QgKmJvb3Rf
aHlwX3BnZCwKIAkJCQkgICAgICAgcGdkX3QgKmh5cF9wZ2QsCiAJCQkJICAgICAgIHBnZF90ICpt
ZXJnZWRfaHlwX3BnZCwKZGlmZiAtLWdpdCBhL2FyY2gvYXJtNjQvaW5jbHVkZS9hc20vcGd0YWJs
ZS5oIGIvYXJjaC9hcm02NC9pbmNsdWRlL2FzbS9wZ3RhYmxlLmgKaW5kZXggNTZiYTEzODlhOTVh
Li4xOTlmNDM0Zjk5YTQgMTAwNjQ0Ci0tLSBhL2FyY2gvYXJtNjQvaW5jbHVkZS9hc20vcGd0YWJs
ZS5oCisrKyBiL2FyY2gvYXJtNjQvaW5jbHVkZS9hc20vcGd0YWJsZS5oCkBAIC0zNTMsNiArMzUz
LDcgQEAgc3RhdGljIGlubGluZSBpbnQgcG1kX3Byb3Rub25lKHBtZF90IHBtZCkKIAogI2RlZmlu
ZSBwdWRfd3JpdGUocHVkKQkJcHRlX3dyaXRlKHB1ZF9wdGUocHVkKSkKICNkZWZpbmUgcHVkX3Bm
bihwdWQpCQkoKChwdWRfdmFsKHB1ZCkgJiBQVURfTUFTSykgJiBQSFlTX01BU0spID4+IFBBR0Vf
U0hJRlQpCisjZGVmaW5lIHBmbl9wdWQocGZuLHByb3QpCShfX3B1ZCgoKHBoeXNfYWRkcl90KShw
Zm4pIDw8IFBBR0VfU0hJRlQpIHwgcGdwcm90X3ZhbChwcm90KSkpCiAKICNkZWZpbmUgc2V0X3Bt
ZF9hdChtbSwgYWRkciwgcG1kcCwgcG1kKQlzZXRfcHRlX2F0KG1tLCBhZGRyLCAocHRlX3QgKilw
bWRwLCBwbWRfcHRlKHBtZCkpCiAKZGlmZiAtLWdpdCBhL2FyY2gvYXJtNjQva2VybmVsL2hpYmVy
bmF0ZS5jIGIvYXJjaC9hcm02NC9rZXJuZWwvaGliZXJuYXRlLmMKaW5kZXggNzZjOWI1MWZhN2Yx
Li5jNGFlYzEyOWVkMjAgMTAwNjQ0Ci0tLSBhL2FyY2gvYXJtNjQva2VybmVsL2hpYmVybmF0ZS5j
CisrKyBiL2FyY2gvYXJtNjQva2VybmVsL2hpYmVybmF0ZS5jCkBAIC0yNDcsOCArMjQ3LDcgQEAg
c3RhdGljIGludCBjcmVhdGVfc2FmZV9leGVjX3BhZ2Uodm9pZCAqc3JjX3N0YXJ0LCBzaXplX3Qg
bGVuZ3RoLAogCX0KIAogCXB0ZSA9IHB0ZV9vZmZzZXRfa2VybmVsKHBtZCwgZHN0X2FkZHIpOwot
CXNldF9wdGUocHRlLCBfX3B0ZSh2aXJ0X3RvX3BoeXMoKHZvaWQgKilkc3QpIHwKLQkJCSBwZ3By
b3RfdmFsKFBBR0VfS0VSTkVMX0VYRUMpKSk7CisJc2V0X3B0ZShwdGUsIHBmbl9wdGUodmlydF90
b19wZm4oZHN0KSwgUEFHRV9LRVJORUxfRVhFQykpOwogCiAJLyoKIAkgKiBMb2FkIG91ciBuZXcg
cGFnZSB0YWJsZXMuIEEgc3RyaWN0IEJCTSBhcHByb2FjaCByZXF1aXJlcyB0aGF0IHdlCmRpZmYg
LS1naXQgYS9hcmNoL2FybTY0L21tL21tdS5jIGIvYXJjaC9hcm02NC9tbS9tbXUuYwppbmRleCBi
OTFlZTFlOGRjY2MuLjJiMjQ1MGE5MGQ2MiAxMDA2NDQKLS0tIGEvYXJjaC9hcm02NC9tbS9tbXUu
YworKysgYi9hcmNoL2FybTY0L21tL21tdS5jCkBAIC00OTUsOCArNDk1LDggQEAgc3RhdGljIHZv
aWQgX19pbml0IG1hcF9rZXJuZWwocGdkX3QgKnBnZCkKIAkJICogZW50cnkgaW5zdGVhZC4KIAkJ
ICovCiAJCUJVR19PTighSVNfRU5BQkxFRChDT05GSUdfQVJNNjRfMTZLX1BBR0VTKSk7Ci0JCXNl
dF9wdWQocHVkX3NldF9maXhtYXBfb2Zmc2V0KHBnZCwgRklYQUREUl9TVEFSVCksCi0JCQlfX3B1
ZChfX3BhKGJtX3BtZCkgfCBQVURfVFlQRV9UQUJMRSkpOworCQlwdWRfcG9wdWxhdGUoJmluaXRf
bW0sIHB1ZF9zZXRfZml4bWFwX29mZnNldChwZ2QsIEZJWEFERFJfU1RBUlQpLAorCQkJICAgICBs
bV9hbGlhcyhibV9wbWQpKTsKIAkJcHVkX2NsZWFyX2ZpeG1hcCgpOwogCX0gZWxzZSB7CiAJCUJV
RygpOwpAQCAtNjExLDcgKzYxMSw3IEBAIGludCBfX21lbWluaXQgdm1lbW1hcF9wb3B1bGF0ZSh1
bnNpZ25lZCBsb25nIHN0YXJ0LCB1bnNpZ25lZCBsb25nIGVuZCwgaW50IG5vZGUpCiAJCQlpZiAo
IXApCiAJCQkJcmV0dXJuIC1FTk9NRU07CiAKLQkJCXNldF9wbWQocG1kLCBfX3BtZChfX3BhKHAp
IHwgUFJPVF9TRUNUX05PUk1BTCkpOworCQkJcG1kX3NldF9odWdlKHBtZCwgX19wYShwKSwgX19w
Z3Byb3QoUFJPVF9TRUNUX05PUk1BTCkpOwogCQl9IGVsc2UKIAkJCXZtZW1tYXBfdmVyaWZ5KChw
dGVfdCAqKXBtZCwgbm9kZSwgYWRkciwgbmV4dCk7CiAJfSB3aGlsZSAoYWRkciA9IG5leHQsIGFk
ZHIgIT0gZW5kKTsKQEAgLTc5NywxNSArNzk3LDE5IEBAIGludCBfX2luaXQgYXJjaF9pb3JlbWFw
X3BtZF9zdXBwb3J0ZWQodm9pZCkKIAogaW50IHB1ZF9zZXRfaHVnZShwdWRfdCAqcHVkLCBwaHlz
X2FkZHJfdCBwaHlzLCBwZ3Byb3RfdCBwcm90KQogeworCXBncHJvdF90IHNlY3RfcHJvdCA9IF9f
cGdwcm90KFBVRF9UWVBFX1NFQ1QgfAorCQkJCQlwZ3Byb3RfdmFsKG1rX3NlY3RfcHJvdChwcm90
KSkpOwogCUJVR19PTihwaHlzICYgflBVRF9NQVNLKTsKLQlzZXRfcHVkKHB1ZCwgX19wdWQocGh5
cyB8IFBVRF9UWVBFX1NFQ1QgfCBwZ3Byb3RfdmFsKG1rX3NlY3RfcHJvdChwcm90KSkpKTsKKwlz
ZXRfcHVkKHB1ZCwgcGZuX3B1ZChfX3BoeXNfdG9fcGZuKHBoeXMpLCBzZWN0X3Byb3QpKTsKIAly
ZXR1cm4gMTsKIH0KIAogaW50IHBtZF9zZXRfaHVnZShwbWRfdCAqcG1kLCBwaHlzX2FkZHJfdCBw
aHlzLCBwZ3Byb3RfdCBwcm90KQogeworCXBncHJvdF90IHNlY3RfcHJvdCA9IF9fcGdwcm90KFBN
RF9UWVBFX1NFQ1QgfAorCQkJCQlwZ3Byb3RfdmFsKG1rX3NlY3RfcHJvdChwcm90KSkpOwogCUJV
R19PTihwaHlzICYgflBNRF9NQVNLKTsKLQlzZXRfcG1kKHBtZCwgX19wbWQocGh5cyB8IFBNRF9U
WVBFX1NFQ1QgfCBwZ3Byb3RfdmFsKG1rX3NlY3RfcHJvdChwcm90KSkpKTsKKwlzZXRfcG1kKHBt
ZCwgcGZuX3BtZChfX3BoeXNfdG9fcGZuKHBoeXMpLCBzZWN0X3Byb3QpKTsKIAlyZXR1cm4gMTsK
IH0KIAoKRnJvbSBiYTUwOGRlMmM4MWM2Yjc3ZjMwMWQxM2E0NTcwM2FhN2FlYzM1NzcxIE1vbiBT
ZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBCZW4gSHV0Y2hpbmdzIDxiZW4uaHV0Y2hpbmdzQGNv
ZGV0aGluay5jby51az4KRGF0ZTogVHVlLCAxNCBKYW4gMjAyMCAxNTo0NDoxMSArMDAwMApTdWJq
ZWN0OiBhcm02NDogbW06IENoYW5nZSBwYWdlIHRhYmxlIHBvaW50ZXIgbmFtZSBpbiBwW21kXV9z
ZXRfaHVnZSgpCgpUaGlzIGlzIHByZXBhcmF0aW9uIGZvciB0aGUgZm9sbG93aW5nIGJhY2twb3J0
ZWQgZml4ZXMuICBJdCB3YXMgZG9uZQp1cHN0cmVhbSBhcyBwYXJ0IG9mIGNvbW1pdCAyMGEwMDRl
N2IwMTcgImFybTY0OiBtbTogVXNlClJFQURfT05DRS9XUklURV9PTkNFIHdoZW4gYWNjZXNzaW5n
IHBhZ2UgdGFibGVzIiwgdGhlIHJlc3Qgb2Ygd2hpY2gKZG9lcyBub3Qgc2VlbSBzdWl0YWJsZSBm
b3Igc3RhYmxlLgoKU2lnbmVkLW9mZi1ieTogQmVuIEh1dGNoaW5ncyA8YmVuLmh1dGNoaW5nc0Bj
b2RldGhpbmsuY28udWs+Ci0tLQogYXJjaC9hcm02NC9tbS9tbXUuYyB8IDggKysrKy0tLS0KIDEg
ZmlsZSBjaGFuZ2VkLCA0IGluc2VydGlvbnMoKyksIDQgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0
IGEvYXJjaC9hcm02NC9tbS9tbXUuYyBiL2FyY2gvYXJtNjQvbW0vbW11LmMKaW5kZXggMmIyNDUw
YTkwZDYyLi5lYjE0YWI0ODBlZTQgMTAwNjQ0Ci0tLSBhL2FyY2gvYXJtNjQvbW0vbW11LmMKKysr
IGIvYXJjaC9hcm02NC9tbS9tbXUuYwpAQCAtNzk1LDIxICs3OTUsMjEgQEAgaW50IF9faW5pdCBh
cmNoX2lvcmVtYXBfcG1kX3N1cHBvcnRlZCh2b2lkKQogCXJldHVybiAhSVNfRU5BQkxFRChDT05G
SUdfQVJNNjRfUFREVU1QX0RFQlVHRlMpOwogfQogCi1pbnQgcHVkX3NldF9odWdlKHB1ZF90ICpw
dWQsIHBoeXNfYWRkcl90IHBoeXMsIHBncHJvdF90IHByb3QpCitpbnQgcHVkX3NldF9odWdlKHB1
ZF90ICpwdWRwLCBwaHlzX2FkZHJfdCBwaHlzLCBwZ3Byb3RfdCBwcm90KQogewogCXBncHJvdF90
IHNlY3RfcHJvdCA9IF9fcGdwcm90KFBVRF9UWVBFX1NFQ1QgfAogCQkJCQlwZ3Byb3RfdmFsKG1r
X3NlY3RfcHJvdChwcm90KSkpOwogCUJVR19PTihwaHlzICYgflBVRF9NQVNLKTsKLQlzZXRfcHVk
KHB1ZCwgcGZuX3B1ZChfX3BoeXNfdG9fcGZuKHBoeXMpLCBzZWN0X3Byb3QpKTsKKwlzZXRfcHVk
KHB1ZHAsIHBmbl9wdWQoX19waHlzX3RvX3BmbihwaHlzKSwgc2VjdF9wcm90KSk7CiAJcmV0dXJu
IDE7CiB9CiAKLWludCBwbWRfc2V0X2h1Z2UocG1kX3QgKnBtZCwgcGh5c19hZGRyX3QgcGh5cywg
cGdwcm90X3QgcHJvdCkKK2ludCBwbWRfc2V0X2h1Z2UocG1kX3QgKnBtZHAsIHBoeXNfYWRkcl90
IHBoeXMsIHBncHJvdF90IHByb3QpCiB7CiAJcGdwcm90X3Qgc2VjdF9wcm90ID0gX19wZ3Byb3Qo
UE1EX1RZUEVfU0VDVCB8CiAJCQkJCXBncHJvdF92YWwobWtfc2VjdF9wcm90KHByb3QpKSk7CiAJ
QlVHX09OKHBoeXMgJiB+UE1EX01BU0spOwotCXNldF9wbWQocG1kLCBwZm5fcG1kKF9fcGh5c190
b19wZm4ocGh5cyksIHNlY3RfcHJvdCkpOworCXNldF9wbWQocG1kcCwgcGZuX3BtZChfX3BoeXNf
dG9fcGZuKHBoeXMpLCBzZWN0X3Byb3QpKTsKIAlyZXR1cm4gMTsKIH0KIAoKRnJvbSBlYzQ1NmIy
MWIzNzZlYjI3NzFjODQ0YmZjZjdhZmUwZjYyZDFkNTExIE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAw
MQpGcm9tOiBXaWxsIERlYWNvbiA8d2lsbC5kZWFjb25AYXJtLmNvbT4KRGF0ZTogV2VkLCAyMSBG
ZWIgMjAxOCAxMjo1OToyNyArMDAwMApTdWJqZWN0OiBhcm02NDogRW5mb3JjZSBCQk0gZm9yIGh1
Z2UgSU8vVk1BUCBtYXBwaW5ncwoKY29tbWl0IDE1MTIyZWUyYzUxNWEyNTNiMGM2NmEzZTYxOGJj
N2ViZTM1MTA1ZWIgdXBzdHJlYW0uCgppb3JlbWFwX3BhZ2VfcmFuZ2UgZG9lc24ndCBob25vdXIg
YnJlYWstYmVmb3JlLW1ha2UgYW5kIGF0dGVtcHRzIHRvIHB1dApkb3duIGh1Z2UgbWFwcGluZ3Mg
KHVzaW5nIHAqZF9zZXRfaHVnZSkgb3ZlciB0aGUgdG9wIG9mIHByZS1leGlzdGluZwp0YWJsZSBl
bnRyaWVzLiBUaGlzIGxlYWRzIHRvIHVzIGxlYWtpbmcgcGFnZSB0YWJsZSBtZW1vcnkgYW5kIGFs
c28gZ2l2ZXMKcmlzZSB0byBUTEIgY29uZmxpY3RzIGFuZCBzcHVyaW91cyBhYm9ydHMsIHdoaWNo
IGhhdmUgYmVlbiBzZWVuIGluCnByYWN0aWNlIG9uIENvcnRleC1BNzUuCgpVbnRpbCB0aGlzIGhh
cyBiZWVuIHJlc29sdmVkLCByZWZ1c2UgdG8gcHV0IGJsb2NrIG1hcHBpbmdzIHdoZW4gdGhlCmV4
aXN0aW5nIGVudHJ5IGlzIGZvdW5kIHRvIGJlIHByZXNlbnQuCgpGaXhlczogMzI0NDIwYmY5MWY2
MCAoImFybTY0OiBhZGQgc3VwcG9ydCBmb3IgaW9yZW1hcCgpIGJsb2NrIG1hcHBpbmdzIikKUmVw
b3J0ZWQtYnk6IEhhbmp1biBHdW8gPGhhbmp1bi5ndW9AbGluYXJvLm9yZz4KUmVwb3J0ZWQtYnk6
IExlaSBMaSA8bGlvdXMubGlsZWlAaGlzaWxpY29uLmNvbT4KQWNrZWQtYnk6IEFyZCBCaWVzaGV1
dmVsIDxhcmQuYmllc2hldXZlbEBsaW5hcm8ub3JnPgpTaWduZWQtb2ZmLWJ5OiBXaWxsIERlYWNv
biA8d2lsbC5kZWFjb25AYXJtLmNvbT4KU2lnbmVkLW9mZi1ieTogQ2F0YWxpbiBNYXJpbmFzIDxj
YXRhbGluLm1hcmluYXNAYXJtLmNvbT4KU2lnbmVkLW9mZi1ieTogQmVuIEh1dGNoaW5ncyA8YmVu
Lmh1dGNoaW5nc0Bjb2RldGhpbmsuY28udWs+Ci0tLQogYXJjaC9hcm02NC9tbS9tbXUuYyB8IDEw
ICsrKysrKysrKysKIDEgZmlsZSBjaGFuZ2VkLCAxMCBpbnNlcnRpb25zKCspCgpkaWZmIC0tZ2l0
IGEvYXJjaC9hcm02NC9tbS9tbXUuYyBiL2FyY2gvYXJtNjQvbW0vbW11LmMKaW5kZXggZWIxNGFi
NDgwZWU0Li45MWMwZDY4ZTZiM2QgMTAwNjQ0Ci0tLSBhL2FyY2gvYXJtNjQvbW0vbW11LmMKKysr
IGIvYXJjaC9hcm02NC9tbS9tbXUuYwpAQCAtNzk5LDYgKzc5OSwxMSBAQCBpbnQgcHVkX3NldF9o
dWdlKHB1ZF90ICpwdWRwLCBwaHlzX2FkZHJfdCBwaHlzLCBwZ3Byb3RfdCBwcm90KQogewogCXBn
cHJvdF90IHNlY3RfcHJvdCA9IF9fcGdwcm90KFBVRF9UWVBFX1NFQ1QgfAogCQkJCQlwZ3Byb3Rf
dmFsKG1rX3NlY3RfcHJvdChwcm90KSkpOworCisJLyogaW9yZW1hcF9wYWdlX3JhbmdlIGRvZXNu
J3QgaG9ub3VyIEJCTSAqLworCWlmIChwdWRfcHJlc2VudChSRUFEX09OQ0UoKnB1ZHApKSkKKwkJ
cmV0dXJuIDA7CisKIAlCVUdfT04ocGh5cyAmIH5QVURfTUFTSyk7CiAJc2V0X3B1ZChwdWRwLCBw
Zm5fcHVkKF9fcGh5c190b19wZm4ocGh5cyksIHNlY3RfcHJvdCkpOwogCXJldHVybiAxOwpAQCAt
ODA4LDYgKzgxMywxMSBAQCBpbnQgcG1kX3NldF9odWdlKHBtZF90ICpwbWRwLCBwaHlzX2FkZHJf
dCBwaHlzLCBwZ3Byb3RfdCBwcm90KQogewogCXBncHJvdF90IHNlY3RfcHJvdCA9IF9fcGdwcm90
KFBNRF9UWVBFX1NFQ1QgfAogCQkJCQlwZ3Byb3RfdmFsKG1rX3NlY3RfcHJvdChwcm90KSkpOwor
CisJLyogaW9yZW1hcF9wYWdlX3JhbmdlIGRvZXNuJ3QgaG9ub3VyIEJCTSAqLworCWlmIChwbWRf
cHJlc2VudChSRUFEX09OQ0UoKnBtZHApKSkKKwkJcmV0dXJuIDA7CisKIAlCVUdfT04ocGh5cyAm
IH5QTURfTUFTSyk7CiAJc2V0X3BtZChwbWRwLCBwZm5fcG1kKF9fcGh5c190b19wZm4ocGh5cyks
IHNlY3RfcHJvdCkpOwogCXJldHVybiAxOwoKRnJvbSAzMDVmZjI3ZGU2NDY5MzUxMzY2ZTZmYzE2
Njg0MmNjMzY1MzdjOTYzIE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBMYXVyYSBBYmJv
dHQgPGxhYmJvdHRAcmVkaGF0LmNvbT4KRGF0ZTogV2VkLCAyMyBNYXkgMjAxOCAxMTo0Mzo0NiAt
MDcwMApTdWJqZWN0OiBhcm02NDogTWFrZSBzdXJlIHBlcm1pc3Npb24gdXBkYXRlcyBoYXBwZW4g
Zm9yIHBtZC9wdWQKCmNvbW1pdCA4MjAzNGMyM2ZjYmMyMzg5YzczZDk3NzM3ZjYxZmEyZGQ2NTI2
NDEzIHVwc3RyZWFtLgoKQ29tbWl0IDE1MTIyZWUyYzUxNSAoImFybTY0OiBFbmZvcmNlIEJCTSBm
b3IgaHVnZSBJTy9WTUFQIG1hcHBpbmdzIikKZGlzYWxsb3dlZCBibG9jayBtYXBwaW5ncyBmb3Ig
aW9yZW1hcCBzaW5jZSB0aGF0IGNvZGUgZG9lcyBub3QgaG9ub3IKYnJlYWstYmVmb3JlLW1ha2Uu
IFRoZSBzYW1lIEFQSXMgYXJlIGFsc28gdXNlZCBmb3IgcGVybWlzc2lvbiB1cGRhdGluZwp0aG91
Z2ggYW5kIHRoZSBleHRyYSBjaGVja3MgcHJldmVudCB0aGUgcGVybWlzc2lvbiB1cGRhdGVzIGZy
b20gaGFwcGVuaW5nLApldmVuIHRob3VnaCB0aGlzIHNob3VsZCBiZSBwZXJtaXR0ZWQuIFRoaXMg
cmVzdWx0cyBpbiByZWFkLW9ubHkgcGVybWlzc2lvbnMKbm90IGJlaW5nIGZ1bGx5IGFwcGxpZWQu
IFZpc2libHksIHRoaXMgY2FuIG9jY2FzaW9uYWx5IGJlIHNlZW4gYXMgYSBmYWlsdXJlCm9uIHRo
ZSBidWlsdCBpbiByb2RhdGEgdGVzdCB3aGVuIHRoZSB0ZXN0IGRhdGEgZW5kcyB1cCBpbiBhIHNl
Y3Rpb24gb3IKYXMgYW4gb2RkIFJXIGdhcCBvbiB0aGUgcGFnZSB0YWJsZSBkdW1wLiBGaXggdGhp
cyBieSB1c2luZwpwZ2F0dHJfY2hhbmdlX2lzX3NhZmUgaW5zdGVhZCBvZiBwKmRfcHJlc2VudCBm
b3IgZGV0ZXJtaW5pbmcgaWYgdGhlCmNoYW5nZSBpcyBwZXJtaXR0ZWQuCgpSZXZpZXdlZC1ieTog
S2VlcyBDb29rIDxrZWVzY29va0BjaHJvbWl1bS5vcmc+ClRlc3RlZC1ieTogUGV0ZXIgUm9iaW5z
b24gPHBicm9iaW5zb25AZ21haWwuY29tPgpSZXBvcnRlZC1ieTogUGV0ZXIgUm9iaW5zb24gPHBi
cm9iaW5zb25AZ21haWwuY29tPgpGaXhlczogMTUxMjJlZTJjNTE1ICgiYXJtNjQ6IEVuZm9yY2Ug
QkJNIGZvciBodWdlIElPL1ZNQVAgbWFwcGluZ3MiKQpTaWduZWQtb2ZmLWJ5OiBMYXVyYSBBYmJv
dHQgPGxhYmJvdHRAcmVkaGF0LmNvbT4KU2lnbmVkLW9mZi1ieTogV2lsbCBEZWFjb24gPHdpbGwu
ZGVhY29uQGFybS5jb20+ClNpZ25lZC1vZmYtYnk6IEJlbiBIdXRjaGluZ3MgPGJlbi5odXRjaGlu
Z3NAY29kZXRoaW5rLmNvLnVrPgotLS0KIGFyY2gvYXJtNjQvbW0vbW11LmMgfCAxNiArKysrKysr
KysrLS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgMTAgaW5zZXJ0aW9ucygrKSwgNiBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS9hcmNoL2FybTY0L21tL21tdS5jIGIvYXJjaC9hcm02NC9tbS9tbXUu
YwppbmRleCA5MWMwZDY4ZTZiM2QuLjYwYmU1YmMwOTg0YSAxMDA2NDQKLS0tIGEvYXJjaC9hcm02
NC9tbS9tbXUuYworKysgYi9hcmNoL2FybTY0L21tL21tdS5jCkBAIC03OTksMTMgKzc5OSwxNSBA
QCBpbnQgcHVkX3NldF9odWdlKHB1ZF90ICpwdWRwLCBwaHlzX2FkZHJfdCBwaHlzLCBwZ3Byb3Rf
dCBwcm90KQogewogCXBncHJvdF90IHNlY3RfcHJvdCA9IF9fcGdwcm90KFBVRF9UWVBFX1NFQ1Qg
fAogCQkJCQlwZ3Byb3RfdmFsKG1rX3NlY3RfcHJvdChwcm90KSkpOworCXB1ZF90IG5ld19wdWQg
PSBwZm5fcHVkKF9fcGh5c190b19wZm4ocGh5cyksIHNlY3RfcHJvdCk7CiAKLQkvKiBpb3JlbWFw
X3BhZ2VfcmFuZ2UgZG9lc24ndCBob25vdXIgQkJNICovCi0JaWYgKHB1ZF9wcmVzZW50KFJFQURf
T05DRSgqcHVkcCkpKQorCS8qIE9ubHkgYWxsb3cgcGVybWlzc2lvbiBjaGFuZ2VzIGZvciBub3cg
Ki8KKwlpZiAoIXBnYXR0cl9jaGFuZ2VfaXNfc2FmZShSRUFEX09OQ0UocHVkX3ZhbCgqcHVkcCkp
LAorCQkJCSAgIHB1ZF92YWwobmV3X3B1ZCkpKQogCQlyZXR1cm4gMDsKIAogCUJVR19PTihwaHlz
ICYgflBVRF9NQVNLKTsKLQlzZXRfcHVkKHB1ZHAsIHBmbl9wdWQoX19waHlzX3RvX3BmbihwaHlz
KSwgc2VjdF9wcm90KSk7CisJc2V0X3B1ZChwdWRwLCBuZXdfcHVkKTsKIAlyZXR1cm4gMTsKIH0K
IApAQCAtODEzLDEzICs4MTUsMTUgQEAgaW50IHBtZF9zZXRfaHVnZShwbWRfdCAqcG1kcCwgcGh5
c19hZGRyX3QgcGh5cywgcGdwcm90X3QgcHJvdCkKIHsKIAlwZ3Byb3RfdCBzZWN0X3Byb3QgPSBf
X3BncHJvdChQTURfVFlQRV9TRUNUIHwKIAkJCQkJcGdwcm90X3ZhbChta19zZWN0X3Byb3QocHJv
dCkpKTsKKwlwbWRfdCBuZXdfcG1kID0gcGZuX3BtZChfX3BoeXNfdG9fcGZuKHBoeXMpLCBzZWN0
X3Byb3QpOwogCi0JLyogaW9yZW1hcF9wYWdlX3JhbmdlIGRvZXNuJ3QgaG9ub3VyIEJCTSAqLwot
CWlmIChwbWRfcHJlc2VudChSRUFEX09OQ0UoKnBtZHApKSkKKwkvKiBPbmx5IGFsbG93IHBlcm1p
c3Npb24gY2hhbmdlcyBmb3Igbm93ICovCisJaWYgKCFwZ2F0dHJfY2hhbmdlX2lzX3NhZmUoUkVB
RF9PTkNFKHBtZF92YWwoKnBtZHApKSwKKwkJCQkgICBwbWRfdmFsKG5ld19wbWQpKSkKIAkJcmV0
dXJuIDA7CiAKIAlCVUdfT04ocGh5cyAmIH5QTURfTUFTSyk7Ci0Jc2V0X3BtZChwbWRwLCBwZm5f
cG1kKF9fcGh5c190b19wZm4ocGh5cyksIHNlY3RfcHJvdCkpOworCXNldF9wbWQocG1kcCwgbmV3
X3BtZCk7CiAJcmV0dXJuIDE7CiB9CiAKCkZyb20gNzJlZGE5YTY5YjFmZmE2YmMxZDVmMDVkMmMw
ODllODVmNjUwYjU1OCBNb24gU2VwIDE3IDAwOjAwOjAwIDIwMDEKRnJvbTogRGVkeSBMYW5za3kg
PGRsYW5za3lAY29kZWF1cm9yYS5vcmc+CkRhdGU6IFN1biwgMjkgSnVsIDIwMTggMTQ6NTk6MTYg
KzAzMDAKU3ViamVjdDogY2ZnODAyMTEvbWFjODAyMTE6IG1ha2UgaWVlZTgwMjExX3NlbmRfbGF5
ZXIyX3VwZGF0ZSBhIHB1YmxpYwogZnVuY3Rpb24KCmNvbW1pdCAzMGNhMWFhNTM2MjExZjVhYzNk
ZTAxNzM1MTNhN2E5OWE5OGE5N2YzIHVwc3RyZWFtLgoKTWFrZSBpZWVlODAyMTFfc2VuZF9sYXll
cjJfdXBkYXRlKCkgYSBjb21tb24gZnVuY3Rpb24gc28gb3RoZXIgZHJpdmVycwpjYW4gcmUtdXNl
IGl0LgoKU2lnbmVkLW9mZi1ieTogRGVkeSBMYW5za3kgPGRsYW5za3lAY29kZWF1cm9yYS5vcmc+
ClNpZ25lZC1vZmYtYnk6IEpvaGFubmVzIEJlcmcgPGpvaGFubmVzLmJlcmdAaW50ZWwuY29tPgpb
YndoOiBCYWNrcG9ydGVkIHRvIDQuOSBhcyBkZXBlbmRlbmN5IG9mIGNvbW1pdCAzZTQ5MzE3M2I3
ODQKICJtYWM4MDIxMTogRG8gbm90IHNlbmQgTGF5ZXIgMiBVcGRhdGUgZnJhbWUgYmVmb3JlIGF1
dGhvcml6YXRpb24iOgogLSBSZXRhaW4gdHlwZS1jYXN0aW5nIG9mIHNrYl9wdXQoKSByZXR1cm4g
dmFsdWUKIC0gQWRqdXN0IGNvbnRleHRdClNpZ25lZC1vZmYtYnk6IEJlbiBIdXRjaGluZ3MgPGJl
bi5odXRjaGluZ3NAY29kZXRoaW5rLmNvLnVrPgotLS0KIGluY2x1ZGUvbmV0L2NmZzgwMjExLmgg
fCAxMSArKysrKysrKysrCiBuZXQvbWFjODAyMTEvY2ZnLmMgICAgIHwgNDggKystLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiBuZXQvd2lyZWxlc3MvdXRpbC5jICAgIHwg
NDUgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiAzIGZpbGVzIGNoYW5n
ZWQsIDU4IGluc2VydGlvbnMoKyksIDQ2IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2luY2x1
ZGUvbmV0L2NmZzgwMjExLmggYi9pbmNsdWRlL25ldC9jZmc4MDIxMS5oCmluZGV4IDlkNTc2Mzky
MjNjMy4uMjhhMGQ3YThjMTQyIDEwMDY0NAotLS0gYS9pbmNsdWRlL25ldC9jZmc4MDIxMS5oCisr
KyBiL2luY2x1ZGUvbmV0L2NmZzgwMjExLmgKQEAgLTQxODEsNiArNDE4MSwxNyBAQCBzdGF0aWMg
aW5saW5lIGNvbnN0IHU4ICpjZmc4MDIxMV9maW5kX2llKHU4IGVpZCwgY29uc3QgdTggKmllcywg
aW50IGxlbikKIGNvbnN0IHU4ICpjZmc4MDIxMV9maW5kX3ZlbmRvcl9pZSh1bnNpZ25lZCBpbnQg
b3VpLCBpbnQgb3VpX3R5cGUsCiAJCQkJICBjb25zdCB1OCAqaWVzLCBpbnQgbGVuKTsKIAorLyoq
CisgKiBjZmc4MDIxMV9zZW5kX2xheWVyMl91cGRhdGUgLSBzZW5kIGxheWVyIDIgdXBkYXRlIGZy
YW1lCisgKgorICogQGRldjogbmV0d29yayBkZXZpY2UKKyAqIEBhZGRyOiBTVEEgTUFDIGFkZHJl
c3MKKyAqCisgKiBXaXJlbGVzcyBkcml2ZXJzIGNhbiB1c2UgdGhpcyBmdW5jdGlvbiB0byB1cGRh
dGUgZm9yd2FyZGluZyB0YWJsZXMgaW4gYnJpZGdlCisgKiBkZXZpY2VzIHVwb24gU1RBIGFzc29j
aWF0aW9uLgorICovCit2b2lkIGNmZzgwMjExX3NlbmRfbGF5ZXIyX3VwZGF0ZShzdHJ1Y3QgbmV0
X2RldmljZSAqZGV2LCBjb25zdCB1OCAqYWRkcik7CisKIC8qKgogICogRE9DOiBSZWd1bGF0b3J5
IGVuZm9yY2VtZW50IGluZnJhc3RydWN0dXJlCiAgKgpkaWZmIC0tZ2l0IGEvbmV0L21hYzgwMjEx
L2NmZy5jIGIvbmV0L21hYzgwMjExL2NmZy5jCmluZGV4IDNiMmM0NjkyZDk2Ni4uNThjYzJkZDBh
MTk0IDEwMDY0NAotLS0gYS9uZXQvbWFjODAyMTEvY2ZnLmMKKysrIGIvbmV0L21hYzgwMjExL2Nm
Zy5jCkBAIC0xMDQ4LDUwICsxMDQ4LDYgQEAgc3RhdGljIGludCBpZWVlODAyMTFfc3RvcF9hcChz
dHJ1Y3Qgd2lwaHkgKndpcGh5LCBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQogCXJldHVybiAwOwog
fQogCi0vKiBMYXllciAyIFVwZGF0ZSBmcmFtZSAoODAyLjIgVHlwZSAxIExMQyBYSUQgVXBkYXRl
IHJlc3BvbnNlKSAqLwotc3RydWN0IGlhcHBfbGF5ZXIyX3VwZGF0ZSB7Ci0JdTggZGFbRVRIX0FM
RU5dOwkvKiBicm9hZGNhc3QgKi8KLQl1OCBzYVtFVEhfQUxFTl07CS8qIFNUQSBhZGRyICovCi0J
X19iZTE2IGxlbjsJCS8qIDYgKi8KLQl1OCBkc2FwOwkJLyogMCAqLwotCXU4IHNzYXA7CQkvKiAw
ICovCi0JdTggY29udHJvbDsKLQl1OCB4aWRfaW5mb1szXTsKLX0gX19wYWNrZWQ7Ci0KLXN0YXRp
YyB2b2lkIGllZWU4MDIxMV9zZW5kX2xheWVyMl91cGRhdGUoc3RydWN0IHN0YV9pbmZvICpzdGEp
Ci17Ci0Jc3RydWN0IGlhcHBfbGF5ZXIyX3VwZGF0ZSAqbXNnOwotCXN0cnVjdCBza19idWZmICpz
a2I7Ci0KLQkvKiBTZW5kIExldmVsIDIgVXBkYXRlIEZyYW1lIHRvIHVwZGF0ZSBmb3J3YXJkaW5n
IHRhYmxlcyBpbiBsYXllciAyCi0JICogYnJpZGdlIGRldmljZXMgKi8KLQotCXNrYiA9IGRldl9h
bGxvY19za2Ioc2l6ZW9mKCptc2cpKTsKLQlpZiAoIXNrYikKLQkJcmV0dXJuOwotCW1zZyA9IChz
dHJ1Y3QgaWFwcF9sYXllcjJfdXBkYXRlICopc2tiX3B1dChza2IsIHNpemVvZigqbXNnKSk7Ci0K
LQkvKiA4MDIuMiBUeXBlIDEgTG9naWNhbCBMaW5rIENvbnRyb2wgKExMQykgRXhjaGFuZ2UgSWRl
bnRpZmllciAoWElEKQotCSAqIFVwZGF0ZSByZXNwb25zZSBmcmFtZTsgSUVFRSBTdGQgODAyLjIt
MTk5OCwgNS40LjEuMi4xICovCi0KLQlldGhfYnJvYWRjYXN0X2FkZHIobXNnLT5kYSk7Ci0JbWVt
Y3B5KG1zZy0+c2EsIHN0YS0+c3RhLmFkZHIsIEVUSF9BTEVOKTsKLQltc2ctPmxlbiA9IGh0b25z
KDYpOwotCW1zZy0+ZHNhcCA9IDA7Ci0JbXNnLT5zc2FwID0gMHgwMTsJLyogTlVMTCBMU0FQLCBD
UiBCaXQ6IFJlc3BvbnNlICovCi0JbXNnLT5jb250cm9sID0gMHhhZjsJLyogWElEIHJlc3BvbnNl
IGxzYi4xMTExRjEwMS4KLQkJCQkgKiBGPTAgKG5vIHBvbGwgY29tbWFuZDsgdW5zb2xpY2l0ZWQg
ZnJhbWUpICovCi0JbXNnLT54aWRfaW5mb1swXSA9IDB4ODE7CS8qIFhJRCBmb3JtYXQgaWRlbnRp
ZmllciAqLwotCW1zZy0+eGlkX2luZm9bMV0gPSAxOwkvKiBMTEMgdHlwZXMvY2xhc3NlczogVHlw
ZSAxIExMQyAqLwotCW1zZy0+eGlkX2luZm9bMl0gPSAwOwkvKiBYSUQgc2VuZGVyJ3MgcmVjZWl2
ZSB3aW5kb3cgc2l6ZSAoUlcpICovCi0KLQlza2ItPmRldiA9IHN0YS0+c2RhdGEtPmRldjsKLQlz
a2ItPnByb3RvY29sID0gZXRoX3R5cGVfdHJhbnMoc2tiLCBzdGEtPnNkYXRhLT5kZXYpOwotCW1l
bXNldChza2ItPmNiLCAwLCBzaXplb2Yoc2tiLT5jYikpOwotCW5ldGlmX3J4X25pKHNrYik7Ci19
Ci0KIHN0YXRpYyBpbnQgc3RhX2FwcGx5X2F1dGhfZmxhZ3Moc3RydWN0IGllZWU4MDIxMV9sb2Nh
bCAqbG9jYWwsCiAJCQkJc3RydWN0IHN0YV9pbmZvICpzdGEsCiAJCQkJdTMyIG1hc2ssIHUzMiBz
ZXQpCkBAIC0xNDU1LDcgKzE0MTEsNyBAQCBzdGF0aWMgaW50IGllZWU4MDIxMV9hZGRfc3RhdGlv
bihzdHJ1Y3Qgd2lwaHkgKndpcGh5LCBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAogCX0KIAogCWlm
IChsYXllcjJfdXBkYXRlKQotCQlpZWVlODAyMTFfc2VuZF9sYXllcjJfdXBkYXRlKHN0YSk7CisJ
CWNmZzgwMjExX3NlbmRfbGF5ZXIyX3VwZGF0ZShzdGEtPnNkYXRhLT5kZXYsIHN0YS0+c3RhLmFk
ZHIpOwogCiAJcmN1X3JlYWRfdW5sb2NrKCk7CiAKQEAgLTE1NjUsNyArMTUyMSw3IEBAIHN0YXRp
YyBpbnQgaWVlZTgwMjExX2NoYW5nZV9zdGF0aW9uKHN0cnVjdCB3aXBoeSAqd2lwaHksCiAJCQkJ
YXRvbWljX2luYygmc3RhLT5zZGF0YS0+YnNzLT5udW1fbWNhc3Rfc3RhKTsKIAkJfQogCi0JCWll
ZWU4MDIxMV9zZW5kX2xheWVyMl91cGRhdGUoc3RhKTsKKwkJY2ZnODAyMTFfc2VuZF9sYXllcjJf
dXBkYXRlKHN0YS0+c2RhdGEtPmRldiwgc3RhLT5zdGEuYWRkcik7CiAJfQogCiAJZXJyID0gc3Rh
X2FwcGx5X3BhcmFtZXRlcnMobG9jYWwsIHN0YSwgcGFyYW1zKTsKZGlmZiAtLWdpdCBhL25ldC93
aXJlbGVzcy91dGlsLmMgYi9uZXQvd2lyZWxlc3MvdXRpbC5jCmluZGV4IGM5M2YzMzNjNjc1Yi4u
ZWNjZTdmODcwNmI0IDEwMDY0NAotLS0gYS9uZXQvd2lyZWxlc3MvdXRpbC5jCisrKyBiL25ldC93
aXJlbGVzcy91dGlsLmMKQEAgLTE3OTQsMyArMTc5NCw0OCBAQCBFWFBPUlRfU1lNQk9MKHJmYzEw
NDJfaGVhZGVyKTsKIGNvbnN0IHVuc2lnbmVkIGNoYXIgYnJpZGdlX3R1bm5lbF9oZWFkZXJbXSBf
X2FsaWduZWQoMikgPQogCXsgMHhhYSwgMHhhYSwgMHgwMywgMHgwMCwgMHgwMCwgMHhmOCB9Owog
RVhQT1JUX1NZTUJPTChicmlkZ2VfdHVubmVsX2hlYWRlcik7CisKKy8qIExheWVyIDIgVXBkYXRl
IGZyYW1lICg4MDIuMiBUeXBlIDEgTExDIFhJRCBVcGRhdGUgcmVzcG9uc2UpICovCitzdHJ1Y3Qg
aWFwcF9sYXllcjJfdXBkYXRlIHsKKwl1OCBkYVtFVEhfQUxFTl07CS8qIGJyb2FkY2FzdCAqLwor
CXU4IHNhW0VUSF9BTEVOXTsJLyogU1RBIGFkZHIgKi8KKwlfX2JlMTYgbGVuOwkJLyogNiAqLwor
CXU4IGRzYXA7CQkvKiAwICovCisJdTggc3NhcDsJCS8qIDAgKi8KKwl1OCBjb250cm9sOworCXU4
IHhpZF9pbmZvWzNdOworfSBfX3BhY2tlZDsKKwordm9pZCBjZmc4MDIxMV9zZW5kX2xheWVyMl91
cGRhdGUoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgY29uc3QgdTggKmFkZHIpCit7CisJc3RydWN0
IGlhcHBfbGF5ZXIyX3VwZGF0ZSAqbXNnOworCXN0cnVjdCBza19idWZmICpza2I7CisKKwkvKiBT
ZW5kIExldmVsIDIgVXBkYXRlIEZyYW1lIHRvIHVwZGF0ZSBmb3J3YXJkaW5nIHRhYmxlcyBpbiBs
YXllciAyCisJICogYnJpZGdlIGRldmljZXMgKi8KKworCXNrYiA9IGRldl9hbGxvY19za2Ioc2l6
ZW9mKCptc2cpKTsKKwlpZiAoIXNrYikKKwkJcmV0dXJuOworCW1zZyA9IChzdHJ1Y3QgaWFwcF9s
YXllcjJfdXBkYXRlICopc2tiX3B1dChza2IsIHNpemVvZigqbXNnKSk7CisKKwkvKiA4MDIuMiBU
eXBlIDEgTG9naWNhbCBMaW5rIENvbnRyb2wgKExMQykgRXhjaGFuZ2UgSWRlbnRpZmllciAoWElE
KQorCSAqIFVwZGF0ZSByZXNwb25zZSBmcmFtZTsgSUVFRSBTdGQgODAyLjItMTk5OCwgNS40LjEu
Mi4xICovCisKKwlldGhfYnJvYWRjYXN0X2FkZHIobXNnLT5kYSk7CisJZXRoZXJfYWRkcl9jb3B5
KG1zZy0+c2EsIGFkZHIpOworCW1zZy0+bGVuID0gaHRvbnMoNik7CisJbXNnLT5kc2FwID0gMDsK
Kwltc2ctPnNzYXAgPSAweDAxOwkvKiBOVUxMIExTQVAsIENSIEJpdDogUmVzcG9uc2UgKi8KKwlt
c2ctPmNvbnRyb2wgPSAweGFmOwkvKiBYSUQgcmVzcG9uc2UgbHNiLjExMTFGMTAxLgorCQkJCSAq
IEY9MCAobm8gcG9sbCBjb21tYW5kOyB1bnNvbGljaXRlZCBmcmFtZSkgKi8KKwltc2ctPnhpZF9p
bmZvWzBdID0gMHg4MTsJLyogWElEIGZvcm1hdCBpZGVudGlmaWVyICovCisJbXNnLT54aWRfaW5m
b1sxXSA9IDE7CS8qIExMQyB0eXBlcy9jbGFzc2VzOiBUeXBlIDEgTExDICovCisJbXNnLT54aWRf
aW5mb1syXSA9IDA7CS8qIFhJRCBzZW5kZXIncyByZWNlaXZlIHdpbmRvdyBzaXplIChSVykgKi8K
KworCXNrYi0+ZGV2ID0gZGV2OworCXNrYi0+cHJvdG9jb2wgPSBldGhfdHlwZV90cmFucyhza2Is
IGRldik7CisJbWVtc2V0KHNrYi0+Y2IsIDAsIHNpemVvZihza2ItPmNiKSk7CisJbmV0aWZfcnhf
bmkoc2tiKTsKK30KK0VYUE9SVF9TWU1CT0woY2ZnODAyMTFfc2VuZF9sYXllcjJfdXBkYXRlKTsK
CkZyb20gNmFhMTg2Yjg2OTJjOWFhNDZiYTJkZmQ4ZWQ1NTE5MmI0ZTFlYzIwNCBNb24gU2VwIDE3
IDAwOjAwOjAwIDIwMDEKRnJvbTogSm91bmkgTWFsaW5lbiA8am91bmlAY29kZWF1cm9yYS5vcmc+
CkRhdGU6IFdlZCwgMTEgU2VwIDIwMTkgMTY6MDM6MDUgKzAzMDAKU3ViamVjdDogbWFjODAyMTE6
IERvIG5vdCBzZW5kIExheWVyIDIgVXBkYXRlIGZyYW1lIGJlZm9yZSBhdXRob3JpemF0aW9uCgpj
b21taXQgM2U0OTMxNzNiNzg0MTI1OWEwOGM1YzhlNWNiZTkwYWRiMzQ5ZGE3ZSB1cHN0cmVhbS4K
ClRoZSBMYXllciAyIFVwZGF0ZSBmcmFtZSBpcyB1c2VkIHRvIHVwZGF0ZSBicmlkZ2VzIHdoZW4g
YSBzdGF0aW9uIHJvYW1zCnRvIGFub3RoZXIgQVAgZXZlbiBpZiB0aGF0IFNUQSBkb2VzIG5vdCB0
cmFuc21pdCBhbnkgZnJhbWVzIGFmdGVyIHRoZQpyZWFzc29jaWF0aW9uLiBUaGlzIGJlaGF2aW9y
IHdhcyBkZXNjcmliZWQgaW4gSUVFRSBTdGQgODAyLjExRi0yMDAzIGFzCnNvbWV0aGluZyB0aGF0
IHdvdWxkIGhhcHBlbiBiYXNlZCBvbiBNTE1FLUFTU09DSUFURS5pbmRpY2F0aW9uLCBpLmUuLApi
ZWZvcmUgY29tcGxldGluZyA0LXdheSBoYW5kc2hha2UuIEhvd2V2ZXIsIHRoaXMgSUVFRSB0cmlh
bC11c2UKcmVjb21tZW5kZWQgcHJhY3RpY2UgZG9jdW1lbnQgd2FzIHB1Ymxpc2hlZCBiZWZvcmUg
UlNOIChJRUVFIFN0ZAo4MDIuMTFpLTIwMDQpIGFuZCBhcyBzdWNoLCBkaWQgbm90IGNvbnNpZGVy
IFJTTiB1c2UgY2FzZXMuIEZ1cnRoZXJtb3JlLApJRUVFIFN0ZCA4MDIuMTFGLTIwMDMgd2FzIHdp
dGhkcmF3biBpbiAyMDA2IGFuZCBhcyBzdWNoLCBoYXMgbm90IGJlZW4KbWFpbnRhaW5lZCBhbWQg
c2hvdWxkIG5vdCBiZSB1c2VkIGFueW1vcmUuCgpTZW5kaW5nIG91dCB0aGUgTGF5ZXIgMiBVcGRh
dGUgZnJhbWUgaW1tZWRpYXRlbHkgYWZ0ZXIgYXNzb2NpYXRpb24gaXMKZmluZSBmb3Igb3BlbiBu
ZXR3b3JrcyAoYW5kIGFsc28gd2hlbiB1c2luZyBTQUUsIEZUIHByb3RvY29sLCBvciBGSUxTCmF1
dGhlbnRpY2F0aW9uIHdoZW4gdGhlIHN0YXRpb24gaXMgYWN0dWFsbHkgYXV0aGVudGljYXRlZCBi
eSB0aGUgdGltZQphc3NvY2lhdGlvbiBjb21wbGV0ZXMpLiBIb3dldmVyLCBpdCBpcyBub3QgYXBw
cm9wcmlhdGUgZm9yIGNhc2VzIHdoZXJlClJTTiBpcyB1c2VkIHdpdGggUFNLIG9yIEVBUCBhdXRo
ZW50aWNhdGlvbiBzaW5jZSB0aGUgc3RhdGlvbiBpcyBhY3R1YWxseQpmdWxseSBhdXRoZW50aWNh
dGVkIG9ubHkgb25jZSB0aGUgNC13YXkgaGFuZHNoYWtlIGNvbXBsZXRlcyBhZnRlcgphdXRoZW50
aWNhdGlvbiBhbmQgYXR0YWNrZXJzIG1pZ2h0IGJlIGFibGUgdG8gdXNlIHRoZSB1bmF1dGhlbnRp
Y2F0ZWQKdHJpZ2dlcmluZyBvZiBMYXllciAyIFVwZGF0ZSBmcmFtZSB0cmFuc21pc3Npb24gdG8g
ZGlzcnVwdCBicmlkZ2UKYmVoYXZpb3IuCgpGaXggdGhpcyBieSBwb3N0cG9uaW5nIHRyYW5zbWlz
c2lvbiBvZiB0aGUgTGF5ZXIgMiBVcGRhdGUgZnJhbWUgZnJvbQpzdGF0aW9uIGVudHJ5IGFkZGl0
aW9uIHRvIHRoZSBwb2ludCB3aGVuIHRoZSBzdGF0aW9uIGVudHJ5IGlzIG1hcmtlZAphdXRob3Jp
emVkLiBTaW1pbGFybHksIHNlbmQgb3V0IHRoZSBWTEFOIGJpbmRpbmcgdXBkYXRlIG9ubHkgaWYg
dGhlIFNUQQplbnRyeSBoYXMgYWxyZWFkeSBiZWVuIGF1dGhvcml6ZWQuCgpTaWduZWQtb2ZmLWJ5
OiBKb3VuaSBNYWxpbmVuIDxqb3VuaUBjb2RlYXVyb3JhLm9yZz4KUmV2aWV3ZWQtYnk6IEpvaGFu
bmVzIEJlcmcgPGpvaGFubmVzQHNpcHNvbHV0aW9ucy5uZXQ+ClNpZ25lZC1vZmYtYnk6IERhdmlk
IFMuIE1pbGxlciA8ZGF2ZW1AZGF2ZW1sb2Z0Lm5ldD4KW2J3aDogQmFja3BvcnRlZCB0byA0Ljk6
IGFkanVzdCBjb250ZXh0XQpTaWduZWQtb2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxiZW4uaHV0Y2hp
bmdzQGNvZGV0aGluay5jby51az4KLS0tCiBuZXQvbWFjODAyMTEvY2ZnLmMgICAgICB8IDExICsr
Ky0tLS0tLS0tCiBuZXQvbWFjODAyMTEvc3RhX2luZm8uYyB8ICA0ICsrKysKIDIgZmlsZXMgY2hh
bmdlZCwgNyBpbnNlcnRpb25zKCspLCA4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL25ldC9t
YWM4MDIxMS9jZmcuYyBiL25ldC9tYWM4MDIxMS9jZmcuYwppbmRleCA1OGNjMmRkMGExOTQuLjg4
ZGQ1ZDIxOGZlMyAxMDA2NDQKLS0tIGEvbmV0L21hYzgwMjExL2NmZy5jCisrKyBiL25ldC9tYWM4
MDIxMS9jZmcuYwpAQCAtMTM1Nyw3ICsxMzU3LDYgQEAgc3RhdGljIGludCBpZWVlODAyMTFfYWRk
X3N0YXRpb24oc3RydWN0IHdpcGh5ICp3aXBoeSwgc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKIAlz
dHJ1Y3Qgc3RhX2luZm8gKnN0YTsKIAlzdHJ1Y3QgaWVlZTgwMjExX3N1Yl9pZl9kYXRhICpzZGF0
YTsKIAlpbnQgZXJyOwotCWludCBsYXllcjJfdXBkYXRlOwogCiAJaWYgKHBhcmFtcy0+dmxhbikg
ewogCQlzZGF0YSA9IElFRUU4MDIxMV9ERVZfVE9fU1VCX0lGKHBhcmFtcy0+dmxhbik7CkBAIC0x
NDAxLDE4ICsxNDAwLDEyIEBAIHN0YXRpYyBpbnQgaWVlZTgwMjExX2FkZF9zdGF0aW9uKHN0cnVj
dCB3aXBoeSAqd2lwaHksIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCiAJICAgIHRlc3Rfc3RhX2Zs
YWcoc3RhLCBXTEFOX1NUQV9BU1NPQykpCiAJCXJhdGVfY29udHJvbF9yYXRlX2luaXQoc3RhKTsK
IAotCWxheWVyMl91cGRhdGUgPSBzZGF0YS0+dmlmLnR5cGUgPT0gTkw4MDIxMV9JRlRZUEVfQVBf
VkxBTiB8fAotCQlzZGF0YS0+dmlmLnR5cGUgPT0gTkw4MDIxMV9JRlRZUEVfQVA7Ci0KIAllcnIg
PSBzdGFfaW5mb19pbnNlcnRfcmN1KHN0YSk7CiAJaWYgKGVycikgewogCQlyY3VfcmVhZF91bmxv
Y2soKTsKIAkJcmV0dXJuIGVycjsKIAl9CiAKLQlpZiAobGF5ZXIyX3VwZGF0ZSkKLQkJY2ZnODAy
MTFfc2VuZF9sYXllcjJfdXBkYXRlKHN0YS0+c2RhdGEtPmRldiwgc3RhLT5zdGEuYWRkcik7Ci0K
IAlyY3VfcmVhZF91bmxvY2soKTsKIAogCXJldHVybiAwOwpAQCAtMTUyMSw3ICsxNTE0LDkgQEAg
c3RhdGljIGludCBpZWVlODAyMTFfY2hhbmdlX3N0YXRpb24oc3RydWN0IHdpcGh5ICp3aXBoeSwK
IAkJCQlhdG9taWNfaW5jKCZzdGEtPnNkYXRhLT5ic3MtPm51bV9tY2FzdF9zdGEpOwogCQl9CiAK
LQkJY2ZnODAyMTFfc2VuZF9sYXllcjJfdXBkYXRlKHN0YS0+c2RhdGEtPmRldiwgc3RhLT5zdGEu
YWRkcik7CisJCWlmIChzdGEtPnN0YV9zdGF0ZSA9PSBJRUVFODAyMTFfU1RBX0FVVEhPUklaRUQp
CisJCQljZmc4MDIxMV9zZW5kX2xheWVyMl91cGRhdGUoc3RhLT5zZGF0YS0+ZGV2LAorCQkJCQkJ
ICAgIHN0YS0+c3RhLmFkZHIpOwogCX0KIAogCWVyciA9IHN0YV9hcHBseV9wYXJhbWV0ZXJzKGxv
Y2FsLCBzdGEsIHBhcmFtcyk7CmRpZmYgLS1naXQgYS9uZXQvbWFjODAyMTEvc3RhX2luZm8uYyBi
L25ldC9tYWM4MDIxMS9zdGFfaW5mby5jCmluZGV4IDhlOGExODVkYmI5Yi4uYzgwMGJjN2M1MTc2
IDEwMDY0NAotLS0gYS9uZXQvbWFjODAyMTEvc3RhX2luZm8uYworKysgYi9uZXQvbWFjODAyMTEv
c3RhX2luZm8uYwpAQCAtMTg5Niw2ICsxODk2LDEwIEBAIGludCBzdGFfaW5mb19tb3ZlX3N0YXRl
KHN0cnVjdCBzdGFfaW5mbyAqc3RhLAogCQkJaWVlZTgwMjExX2NoZWNrX2Zhc3RfeG1pdChzdGEp
OwogCQkJaWVlZTgwMjExX2NoZWNrX2Zhc3Rfcngoc3RhKTsKIAkJfQorCQlpZiAoc3RhLT5zZGF0
YS0+dmlmLnR5cGUgPT0gTkw4MDIxMV9JRlRZUEVfQVBfVkxBTiB8fAorCQkgICAgc3RhLT5zZGF0
YS0+dmlmLnR5cGUgPT0gTkw4MDIxMV9JRlRZUEVfQVApCisJCQljZmc4MDIxMV9zZW5kX2xheWVy
Ml91cGRhdGUoc3RhLT5zZGF0YS0+ZGV2LAorCQkJCQkJICAgIHN0YS0+c3RhLmFkZHIpOwogCQli
cmVhazsKIAlkZWZhdWx0OgogCQlicmVhazsKCkZyb20gMGYzY2FiYWUxMTFjNTRlODAxYmQzMTY0
YWRmOGFjMmZhYjRlYWM5MyBNb24gU2VwIDE3IDAwOjAwOjAwIDIwMDEKRnJvbTogVmFuZGFuYSBC
TiA8Ym52YW5kYW5hQGdtYWlsLmNvbT4KRGF0ZTogV2VkLCAyMiBNYXkgMjAxOSAwNDozNDoxNSAt
MDQwMApTdWJqZWN0OiBtZWRpYTogdXNiOnpyMzY0eHg6Rml4IEtBU0FOOm51bGwtcHRyLWRlcmVm
IFJlYWQgaW4KIHpyMzY0eHhfdmlkaW9jX3F1ZXJ5Y2FwCgpjb21taXQgNWQyZTczYTVmODBhNWI1
YWZmM2NhZjFlYzZkMzliNWIzZjU0YjI2ZSB1cHN0cmVhbS4KClN5ekthbGxlciBoaXQgdGhlIG51
bGwgcG9pbnRlciBkZXJlZiB3aGlsZSByZWFkaW5nIGZyb20gdW5pbml0aWFsaXplZAp1ZGV2LT5w
cm9kdWN0IGluIHpyMzY0eHhfdmlkaW9jX3F1ZXJ5Y2FwKCkuCgo9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KQlVHOiBLQVNB
TjogbnVsbC1wdHItZGVyZWYgaW4gcmVhZF93b3JkX2F0X2FfdGltZSsweGUvMHgyMAppbmNsdWRl
L2xpbnV4L2NvbXBpbGVyLmg6Mjc0ClJlYWQgb2Ygc2l6ZSAxIGF0IGFkZHIgMDAwMDAwMDAwMDAw
MDAwMCBieSB0YXNrIHY0bF9pZC81Mjg3CgpDUFU6IDEgUElEOiA1Mjg3IENvbW06IHY0bF9pZCBO
b3QgdGFpbnRlZCA1LjEuMC1yYzMtMzE5MDA0LWc0MzE1MWQ2ICM2CkhhcmR3YXJlIG5hbWU6IEdv
b2dsZSBHb29nbGUgQ29tcHV0ZSBFbmdpbmUvR29vZ2xlIENvbXB1dGUgRW5naW5lLCBCSU9TCkdv
b2dsZSAwMS8wMS8yMDExCkNhbGwgVHJhY2U6CiAgX19kdW1wX3N0YWNrIGxpYi9kdW1wX3N0YWNr
LmM6NzcgW2lubGluZV0KICBkdW1wX3N0YWNrKzB4ZTgvMHgxNmUgbGliL2R1bXBfc3RhY2suYzox
MTMKICBrYXNhbl9yZXBvcnQuY29sZCsweDUvMHgzYyBtbS9rYXNhbi9yZXBvcnQuYzozMjEKICBy
ZWFkX3dvcmRfYXRfYV90aW1lKzB4ZS8weDIwIGluY2x1ZGUvbGludXgvY29tcGlsZXIuaDoyNzQK
ICBzdHJzY3B5KzB4OGEvMHgyODAgbGliL3N0cmluZy5jOjIwNwogIHpyMzY0eHhfdmlkaW9jX3F1
ZXJ5Y2FwKzB4YjUvMHgyMTAgZHJpdmVycy9tZWRpYS91c2IvenIzNjR4eC96cjM2NHh4LmM6NzA2
CiAgdjRsX3F1ZXJ5Y2FwKzB4MTJiLzB4MzQwIGRyaXZlcnMvbWVkaWEvdjRsMi1jb3JlL3Y0bDIt
aW9jdGwuYzoxMDYyCiAgX192aWRlb19kb19pb2N0bCsweDViYi8weGI0MCBkcml2ZXJzL21lZGlh
L3Y0bDItY29yZS92NGwyLWlvY3RsLmM6Mjg3NAogIHZpZGVvX3VzZXJjb3B5KzB4NDRlLzB4ZjAw
IGRyaXZlcnMvbWVkaWEvdjRsMi1jb3JlL3Y0bDItaW9jdGwuYzozMDU2CiAgdjRsMl9pb2N0bCsw
eDE0ZS8weDFhMCBkcml2ZXJzL21lZGlhL3Y0bDItY29yZS92NGwyLWRldi5jOjM2NAogIHZmc19p
b2N0bCBmcy9pb2N0bC5jOjQ2IFtpbmxpbmVdCiAgZmlsZV9pb2N0bCBmcy9pb2N0bC5jOjUwOSBb
aW5saW5lXQogIGRvX3Zmc19pb2N0bCsweGNlZC8weDEyZjAgZnMvaW9jdGwuYzo2OTYKICBrc3lz
X2lvY3RsKzB4YTAvMHhjMCBmcy9pb2N0bC5jOjcxMwogIF9fZG9fc3lzX2lvY3RsIGZzL2lvY3Rs
LmM6NzIwIFtpbmxpbmVdCiAgX19zZV9zeXNfaW9jdGwgZnMvaW9jdGwuYzo3MTggW2lubGluZV0K
ICBfX3g2NF9zeXNfaW9jdGwrMHg3NC8weGIwIGZzL2lvY3RsLmM6NzE4CiAgZG9fc3lzY2FsbF82
NCsweGNmLzB4NGYwIGFyY2gveDg2L2VudHJ5L2NvbW1vbi5jOjI5MAogIGVudHJ5X1NZU0NBTExf
NjRfYWZ0ZXJfaHdmcmFtZSsweDQ5LzB4YmUKUklQOiAwMDMzOjB4N2YzYjU2ZDhiMzQ3CkNvZGU6
IDkwIDkwIDkwIDQ4IDhiIDA1IGYxIGZhIDJhIDAwIDY0IGM3IDAwIDI2IDAwIDAwIDAwIDQ4IGM3
IGMwIGZmIGZmIGZmCmZmIGMzIDkwIDkwIDkwIDkwIDkwIDkwIDkwIDkwIDkwIDkwIGI4IDEwIDAw
IDAwIDAwIDBmIDA1IDw0OD4gM2QgMDEgZjAgZmYKZmYgNzMgMDEgYzMgNDggOGIgMGQgYzEgZmEg
MmEgMDAgMzEgZDIgNDggMjkgYzIgNjQKUlNQOiAwMDJiOjAwMDA3ZmZlMDA1ZDVkNjggRUZMQUdT
OiAwMDAwMDIwMiBPUklHX1JBWDogMDAwMDAwMDAwMDAwMDAxMApSQVg6IGZmZmZmZmZmZmZmZmZm
ZGEgUkJYOiAwMDAwMDAwMDAwMDAwMDAzIFJDWDogMDAwMDdmM2I1NmQ4YjM0NwpSRFg6IDAwMDA3
ZmZlMDA1ZDVkNzAgUlNJOiAwMDAwMDAwMDgwNjg1NjAwIFJESTogMDAwMDAwMDAwMDAwMDAwMwpS
QlA6IDAwMDAwMDAwMDAwMDAwMDAgUjA4OiAwMDAwMDAwMDAwMDAwMDAwIFIwOTogMDAwMDAwMDAw
MDAwMDAwMApSMTA6IDAwMDAwMDAwMDAwMDAwMDAgUjExOiAwMDAwMDAwMDAwMDAwMjAyIFIxMjog
MDAwMDAwMDAwMDQwMDg4NApSMTM6IDAwMDA3ZmZlMDA1ZDVlYzAgUjE0OiAwMDAwMDAwMDAwMDAw
MDAwIFIxNTogMDAwMDAwMDAwMDAwMDAwMAo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCkZvciB0aGlzIGRldmljZSB1ZGV2
LT5wcm9kdWN0IGlzIG5vdCBpbml0aWFsaXplZCBhbmQgYWNjZXNzaW5nIGl0IGNhdXNlcyBhIE5V
TEwgcG9pbnRlciBkZXJlZi4KClRoZSBmaXggaXMgdG8gY2hlY2sgZm9yIE5VTEwgYmVmb3JlIHN0
cnNjcHkoKSBhbmQgY29weSBlbXB0eSBzdHJpbmcsIGlmCnByb2R1Y3QgaXMgTlVMTAoKUmVwb3J0
ZWQtYnk6IHN5emJvdCs2NjAxMDAxMmZkNGM1MzFhMWE5NkBzeXprYWxsZXIuYXBwc3BvdG1haWwu
Y29tClNpZ25lZC1vZmYtYnk6IFZhbmRhbmEgQk4gPGJudmFuZGFuYUBnbWFpbC5jb20+ClNpZ25l
ZC1vZmYtYnk6IEhhbnMgVmVya3VpbCA8aHZlcmt1aWwtY2lzY29AeHM0YWxsLm5sPgpTaWduZWQt
b2ZmLWJ5OiBNYXVybyBDYXJ2YWxobyBDaGVoYWIgPG1jaGVoYWIrc2Ftc3VuZ0BrZXJuZWwub3Jn
PgpbYndoOiBCYWNrcG9ydGVkIHRvIDQuOTogVGhpcyBmdW5jdGlvbiB1c2VzIHN0cmxjcHkoKSBp
bnN0ZWFkIG9mIHN0cnNjcHkoKV0KU2lnbmVkLW9mZi1ieTogQmVuIEh1dGNoaW5ncyA8YmVuLmh1
dGNoaW5nc0Bjb2RldGhpbmsuY28udWs+Ci0tLQogZHJpdmVycy9tZWRpYS91c2IvenIzNjR4eC96
cjM2NHh4LmMgfCAzICsrLQogMSBmaWxlIGNoYW5nZWQsIDIgaW5zZXJ0aW9ucygrKSwgMSBkZWxl
dGlvbigtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdXNiL3pyMzY0eHgvenIzNjR4eC5j
IGIvZHJpdmVycy9tZWRpYS91c2IvenIzNjR4eC96cjM2NHh4LmMKaW5kZXggZTM3MzViZmNjMDJm
Li5jNTUxM2Y1NWU2NGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdXNiL3pyMzY0eHgvenIz
NjR4eC5jCisrKyBiL2RyaXZlcnMvbWVkaWEvdXNiL3pyMzY0eHgvenIzNjR4eC5jCkBAIC03MTEs
NyArNzExLDggQEAgc3RhdGljIGludCB6cjM2NHh4X3ZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlzdHJ1Y3QgenIzNjR4eF9jYW1lcmEgKmNhbSA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CiAKIAlzdHJsY3B5KGNhcC0+ZHJpdmVyLCBEUklWRVJfREVTQywgc2l6
ZW9mKGNhcC0+ZHJpdmVyKSk7Ci0Jc3RybGNweShjYXAtPmNhcmQsIGNhbS0+dWRldi0+cHJvZHVj
dCwgc2l6ZW9mKGNhcC0+Y2FyZCkpOworCWlmIChjYW0tPnVkZXYtPnByb2R1Y3QpCisJCXN0cmxj
cHkoY2FwLT5jYXJkLCBjYW0tPnVkZXYtPnByb2R1Y3QsIHNpemVvZihjYXAtPmNhcmQpKTsKIAlz
dHJsY3B5KGNhcC0+YnVzX2luZm8sIGRldl9uYW1lKCZjYW0tPnVkZXYtPmRldiksCiAJCXNpemVv
ZihjYXAtPmJ1c19pbmZvKSk7CiAJY2FwLT5kZXZpY2VfY2FwcyA9IFY0TDJfQ0FQX1ZJREVPX0NB
UFRVUkUgfAoKRnJvbSA2ODdmOWY3ZjNiYzU2MjU3MTA2NWU0YjBjM2I5YjgzOThiODg0NGViIE1v
biBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBOYXZpZCBFbWFtZG9vc3QgPG5hdmlkLmVtYW1k
b29zdEBnbWFpbC5jb20+CkRhdGU6IFR1ZSwgMTAgU2VwIDIwMTkgMTg6MDE6NDAgLTA1MDAKU3Vi
amVjdDogd2ltYXg6IGkyNDAwOiBmaXggbWVtb3J5IGxlYWsKCmNvbW1pdCAyNTA3ZTZhYjdhOWE0
NDA3NzNiZTQ3NjE0MWEyNTU5MzQ0NjhjNWVmIHVwc3RyZWFtLgoKSW4gaTI0MDBtX29wX3Jma2ls
bF9zd190b2dnbGUgY21kIGJ1ZmZlciBzaG91bGQgYmUgcmVsZWFzZWQgYWxvbmcgd2l0aApza2Ig
cmVzcG9uc2UuCgpTaWduZWQtb2ZmLWJ5OiBOYXZpZCBFbWFtZG9vc3QgPG5hdmlkLmVtYW1kb29z
dEBnbWFpbC5jb20+ClNpZ25lZC1vZmYtYnk6IERhdmlkIFMuIE1pbGxlciA8ZGF2ZW1AZGF2ZW1s
b2Z0Lm5ldD4KU2lnbmVkLW9mZi1ieTogQmVuIEh1dGNoaW5ncyA8YmVuLmh1dGNoaW5nc0Bjb2Rl
dGhpbmsuY28udWs+Ci0tLQogZHJpdmVycy9uZXQvd2ltYXgvaTI0MDBtL29wLXJma2lsbC5jIHwg
MSArCiAxIGZpbGUgY2hhbmdlZCwgMSBpbnNlcnRpb24oKykKCmRpZmYgLS1naXQgYS9kcml2ZXJz
L25ldC93aW1heC9pMjQwMG0vb3AtcmZraWxsLmMgYi9kcml2ZXJzL25ldC93aW1heC9pMjQwMG0v
b3AtcmZraWxsLmMKaW5kZXggYjBkYmEzNWE4YWQyLi43YzkyZThhY2U5YzIgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvbmV0L3dpbWF4L2kyNDAwbS9vcC1yZmtpbGwuYworKysgYi9kcml2ZXJzL25ldC93
aW1heC9pMjQwMG0vb3AtcmZraWxsLmMKQEAgLTE0Miw2ICsxNDIsNyBAQCBpbnQgaTI0MDBtX29w
X3Jma2lsbF9zd190b2dnbGUoc3RydWN0IHdpbWF4X2RldiAqd2ltYXhfZGV2LAogCQkJIiVkXG4i
LCByZXN1bHQpOwogCXJlc3VsdCA9IDA7CiBlcnJvcl9jbWQ6CisJa2ZyZWUoY21kKTsKIAlrZnJl
ZV9za2IoYWNrX3NrYik7CiBlcnJvcl9tc2dfdG9fZGV2OgogZXJyb3JfYWxsb2M6CgpGcm9tIDFi
ODExODE1MjU0ZTc5OWZiZDc4N2JiZjNhOWUzNjg0ZjBjNzBhOWIgTW9uIFNlcCAxNyAwMDowMDow
MCAyMDAxCkZyb206IE5hdmlkIEVtYW1kb29zdCA8bmF2aWQuZW1hbWRvb3N0QGdtYWlsLmNvbT4K
RGF0ZTogRnJpLCAyNSBPY3QgMjAxOSAyMzo1MzozMCAtMDUwMApTdWJqZWN0OiB3aW1heDogaTI0
MDA6IEZpeCBtZW1vcnkgbGVhayBpbiBpMjQwMG1fb3BfcmZraWxsX3N3X3RvZ2dsZQoKY29tbWl0
IDZmM2VmNWMyNWNjNzYyNjg3YTczNDFjMThjYmVhNWFmNTQ0NjE0MDcgdXBzdHJlYW0uCgpJbiB0
aGUgaW1wbGVtZW50YXRpb24gb2YgaTI0MDBtX29wX3Jma2lsbF9zd190b2dnbGUoKSB0aGUgYWxs
b2NhdGVkCmJ1ZmZlciBmb3IgY21kIHNob3VsZCBiZSByZWxlYXNlZCBiZWZvcmUgcmV0dXJuaW5n
LiBUaGUKZG9jdW1lbnRhdGlvbiBmb3IgaTI0MDBtX21zZ190b19kZXYoKSBzYXlzIHdoZW4gaXQg
cmV0dXJucyB0aGUgYnVmZmVyCmNhbiBiZSByZXVzZWQuIE1lYW5pbmcgY21kIHNob3VsZCBiZSBy
ZWxlYXNlZCBpbiBlaXRoZXIgY2FzZS4gTW92ZQprZnJlZShjbWQpIGJlZm9yZSByZXR1cm4gdG8g
YmUgcmVhY2hlZCBieSBhbGwgZXhlY3V0aW9uIHBhdGhzLgoKRml4ZXM6IDI1MDdlNmFiN2E5YSAo
IndpbWF4OiBpMjQwMDogZml4IG1lbW9yeSBsZWFrIikKU2lnbmVkLW9mZi1ieTogTmF2aWQgRW1h
bWRvb3N0IDxuYXZpZC5lbWFtZG9vc3RAZ21haWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBEYXZpZCBT
LiBNaWxsZXIgPGRhdmVtQGRhdmVtbG9mdC5uZXQ+ClNpZ25lZC1vZmYtYnk6IEJlbiBIdXRjaGlu
Z3MgPGJlbi5odXRjaGluZ3NAY29kZXRoaW5rLmNvLnVrPgotLS0KIGRyaXZlcnMvbmV0L3dpbWF4
L2kyNDAwbS9vcC1yZmtpbGwuYyB8IDIgKy0KIDEgZmlsZSBjaGFuZ2VkLCAxIGluc2VydGlvbigr
KSwgMSBkZWxldGlvbigtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L3dpbWF4L2kyNDAwbS9v
cC1yZmtpbGwuYyBiL2RyaXZlcnMvbmV0L3dpbWF4L2kyNDAwbS9vcC1yZmtpbGwuYwppbmRleCA3
YzkyZThhY2U5YzIuLmRjNmZlOTNjZTcxZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQvd2ltYXgv
aTI0MDBtL29wLXJma2lsbC5jCisrKyBiL2RyaXZlcnMvbmV0L3dpbWF4L2kyNDAwbS9vcC1yZmtp
bGwuYwpAQCAtMTQyLDEyICsxNDIsMTIgQEAgaW50IGkyNDAwbV9vcF9yZmtpbGxfc3dfdG9nZ2xl
KHN0cnVjdCB3aW1heF9kZXYgKndpbWF4X2RldiwKIAkJCSIlZFxuIiwgcmVzdWx0KTsKIAlyZXN1
bHQgPSAwOwogZXJyb3JfY21kOgotCWtmcmVlKGNtZCk7CiAJa2ZyZWVfc2tiKGFja19za2IpOwog
ZXJyb3JfbXNnX3RvX2RldjoKIGVycm9yX2FsbG9jOgogCWRfZm5lbmQoNCwgZGV2LCAiKHdpbWF4
X2RldiAlcCBzdGF0ZSAlZCkgPSAlZFxuIiwKIAkJd2ltYXhfZGV2LCBzdGF0ZSwgcmVzdWx0KTsK
KwlrZnJlZShjbWQpOwogCXJldHVybiByZXN1bHQ7CiB9CiAKCkZyb20gNmJkMjFlZTFhMDdjM2E5
ZTUwYjgwODkzYjM0MjA4ODUwNjQxZGM5YyBNb24gU2VwIDE3IDAwOjAwOjAwIDIwMDEKRnJvbTog
QmFycmV0IFJob2RlbiA8YnJob0Bnb29nbGUuY29tPgpEYXRlOiBUaHUsIDI1IEFwciAyMDE5IDEx
OjU1OjUwIC0wNDAwClN1YmplY3Q6IGV4dDQ6IGZpeCB1c2UtYWZ0ZXItZnJlZSByYWNlIHdpdGgg
ZGVidWdfd2FudF9leHRyYV9pc2l6ZQoKY29tbWl0IDdiYzA0YzVjMmNjNDY3YzViNDBmMmIwM2Jh
MDhkYTE3NGEwZDVmYTcgdXBzdHJlYW0uCgpXaGVuIHJlbW91bnRpbmcgd2l0aCBkZWJ1Z193YW50
X2V4dHJhX2lzaXplLCB3ZSB3ZXJlIG5vdCBwZXJmb3JtaW5nIHRoZQpzYW1lIGNoZWNrcyB0aGF0
IHdlIGRvIGR1cmluZyBhIG5vcm1hbCBtb3VudC4gIFRoYXQgYWxsb3dlZCB1cyB0byBzZXQgYQp2
YWx1ZSBmb3Igc193YW50X2V4dHJhX2lzaXplIHRoYXQgcmVhY2hlZCBvdXRzaWRlIHRoZSBzX2lu
b2RlX3NpemUuCgpGaXhlczogZTJiOTExYzUzNTg0ICgiZXh0NDogY2xlYW4gdXAgZmVhdHVyZSB0
ZXN0IG1hY3JvcyB3aXRoIHByZWRpY2F0ZSBmdW5jdGlvbnMiKQpSZXBvcnRlZC1ieTogc3l6Ym90
K2Y1ODRlZmEwYWM3MjEzYzIyNmI3QHN5emthbGxlci5hcHBzcG90bWFpbC5jb20KUmV2aWV3ZWQt
Ynk6IEphbiBLYXJhIDxqYWNrQHN1c2UuY3o+ClNpZ25lZC1vZmYtYnk6IEJhcnJldCBSaG9kZW4g
PGJyaG9AZ29vZ2xlLmNvbT4KU2lnbmVkLW9mZi1ieTogVGhlb2RvcmUgVHMnbyA8dHl0c29AbWl0
LmVkdT4KW2J3aDogQmFja3BvcnRlZCB0byA0Ljk6IFRoZSBkZWJ1Z193YW50X2V4dHJhX2lzaXpl
IG1vdW50IG9wdGlvbiBpcyBub3QKIHN1cHBvcnRlZF0KU2lnbmVkLW9mZi1ieTogQmVuIEh1dGNo
aW5ncyA8YmVuLmh1dGNoaW5nc0Bjb2RldGhpbmsuY28udWs+Ci0tLQogZnMvZXh0NC9zdXBlci5j
IHwgNTYgKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLQog
MSBmaWxlIGNoYW5nZWQsIDMzIGluc2VydGlvbnMoKyksIDIzIGRlbGV0aW9ucygtKQoKZGlmZiAt
LWdpdCBhL2ZzL2V4dDQvc3VwZXIuYyBiL2ZzL2V4dDQvc3VwZXIuYwppbmRleCAzMjYxNDc4YmZj
MzIuLmNlYTgxM2FkYmUxMiAxMDA2NDQKLS0tIGEvZnMvZXh0NC9zdXBlci5jCisrKyBiL2ZzL2V4
dDQvc3VwZXIuYwpAQCAtMzM0Miw2ICszMzQyLDM2IEBAIGludCBleHQ0X2NhbGN1bGF0ZV9vdmVy
aGVhZChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKQogCXJldHVybiAwOwogfQogCitzdGF0aWMgdm9p
ZCBleHQ0X2NsYW1wX3dhbnRfZXh0cmFfaXNpemUoc3RydWN0IHN1cGVyX2Jsb2NrICpzYikKK3sK
KwlzdHJ1Y3QgZXh0NF9zYl9pbmZvICpzYmkgPSBFWFQ0X1NCKHNiKTsKKwlzdHJ1Y3QgZXh0NF9z
dXBlcl9ibG9jayAqZXMgPSBzYmktPnNfZXM7CisKKwkvKiBkZXRlcm1pbmUgdGhlIG1pbmltdW0g
c2l6ZSBvZiBuZXcgbGFyZ2UgaW5vZGVzLCBpZiBwcmVzZW50ICovCisJaWYgKHNiaS0+c19pbm9k
ZV9zaXplID4gRVhUNF9HT09EX09MRF9JTk9ERV9TSVpFKSB7CisJCXNiaS0+c193YW50X2V4dHJh
X2lzaXplID0gc2l6ZW9mKHN0cnVjdCBleHQ0X2lub2RlKSAtCisJCQkJCQkgICAgIEVYVDRfR09P
RF9PTERfSU5PREVfU0laRTsKKwkJaWYgKGV4dDRfaGFzX2ZlYXR1cmVfZXh0cmFfaXNpemUoc2Ip
KSB7CisJCQlpZiAoc2JpLT5zX3dhbnRfZXh0cmFfaXNpemUgPAorCQkJICAgIGxlMTZfdG9fY3B1
KGVzLT5zX3dhbnRfZXh0cmFfaXNpemUpKQorCQkJCXNiaS0+c193YW50X2V4dHJhX2lzaXplID0K
KwkJCQkJbGUxNl90b19jcHUoZXMtPnNfd2FudF9leHRyYV9pc2l6ZSk7CisJCQlpZiAoc2JpLT5z
X3dhbnRfZXh0cmFfaXNpemUgPAorCQkJICAgIGxlMTZfdG9fY3B1KGVzLT5zX21pbl9leHRyYV9p
c2l6ZSkpCisJCQkJc2JpLT5zX3dhbnRfZXh0cmFfaXNpemUgPQorCQkJCQlsZTE2X3RvX2NwdShl
cy0+c19taW5fZXh0cmFfaXNpemUpOworCQl9CisJfQorCS8qIENoZWNrIGlmIGVub3VnaCBpbm9k
ZSBzcGFjZSBpcyBhdmFpbGFibGUgKi8KKwlpZiAoRVhUNF9HT09EX09MRF9JTk9ERV9TSVpFICsg
c2JpLT5zX3dhbnRfZXh0cmFfaXNpemUgPgorCQkJCQkJCXNiaS0+c19pbm9kZV9zaXplKSB7CisJ
CXNiaS0+c193YW50X2V4dHJhX2lzaXplID0gc2l6ZW9mKHN0cnVjdCBleHQ0X2lub2RlKSAtCisJ
CQkJCQkgICAgICAgRVhUNF9HT09EX09MRF9JTk9ERV9TSVpFOworCQlleHQ0X21zZyhzYiwgS0VS
Tl9JTkZPLAorCQkJICJyZXF1aXJlZCBleHRyYSBpbm9kZSBzcGFjZSBub3QgYXZhaWxhYmxlIik7
CisJfQorfQorCiBzdGF0aWMgdm9pZCBleHQ0X3NldF9yZXN2X2NsdXN0ZXJzKHN0cnVjdCBzdXBl
cl9ibG9jayAqc2IpCiB7CiAJZXh0NF9mc2Jsa190IHJlc3ZfY2x1c3RlcnM7CkBAIC00MTU2LDI5
ICs0MTg2LDcgQEAgc3RhdGljIGludCBleHQ0X2ZpbGxfc3VwZXIoc3RydWN0IHN1cGVyX2Jsb2Nr
ICpzYiwgdm9pZCAqZGF0YSwgaW50IHNpbGVudCkKIAlpZiAoZXh0NF9zZXR1cF9zdXBlcihzYiwg
ZXMsIHNiLT5zX2ZsYWdzICYgTVNfUkRPTkxZKSkKIAkJc2ItPnNfZmxhZ3MgfD0gTVNfUkRPTkxZ
OwogCi0JLyogZGV0ZXJtaW5lIHRoZSBtaW5pbXVtIHNpemUgb2YgbmV3IGxhcmdlIGlub2Rlcywg
aWYgcHJlc2VudCAqLwotCWlmIChzYmktPnNfaW5vZGVfc2l6ZSA+IEVYVDRfR09PRF9PTERfSU5P
REVfU0laRSkgewotCQlzYmktPnNfd2FudF9leHRyYV9pc2l6ZSA9IHNpemVvZihzdHJ1Y3QgZXh0
NF9pbm9kZSkgLQotCQkJCQkJICAgICBFWFQ0X0dPT0RfT0xEX0lOT0RFX1NJWkU7Ci0JCWlmIChl
eHQ0X2hhc19mZWF0dXJlX2V4dHJhX2lzaXplKHNiKSkgewotCQkJaWYgKHNiaS0+c193YW50X2V4
dHJhX2lzaXplIDwKLQkJCSAgICBsZTE2X3RvX2NwdShlcy0+c193YW50X2V4dHJhX2lzaXplKSkK
LQkJCQlzYmktPnNfd2FudF9leHRyYV9pc2l6ZSA9Ci0JCQkJCWxlMTZfdG9fY3B1KGVzLT5zX3dh
bnRfZXh0cmFfaXNpemUpOwotCQkJaWYgKHNiaS0+c193YW50X2V4dHJhX2lzaXplIDwKLQkJCSAg
ICBsZTE2X3RvX2NwdShlcy0+c19taW5fZXh0cmFfaXNpemUpKQotCQkJCXNiaS0+c193YW50X2V4
dHJhX2lzaXplID0KLQkJCQkJbGUxNl90b19jcHUoZXMtPnNfbWluX2V4dHJhX2lzaXplKTsKLQkJ
fQotCX0KLQkvKiBDaGVjayBpZiBlbm91Z2ggaW5vZGUgc3BhY2UgaXMgYXZhaWxhYmxlICovCi0J
aWYgKEVYVDRfR09PRF9PTERfSU5PREVfU0laRSArIHNiaS0+c193YW50X2V4dHJhX2lzaXplID4K
LQkJCQkJCQlzYmktPnNfaW5vZGVfc2l6ZSkgewotCQlzYmktPnNfd2FudF9leHRyYV9pc2l6ZSA9
IHNpemVvZihzdHJ1Y3QgZXh0NF9pbm9kZSkgLQotCQkJCQkJICAgICAgIEVYVDRfR09PRF9PTERf
SU5PREVfU0laRTsKLQkJZXh0NF9tc2coc2IsIEtFUk5fSU5GTywgInJlcXVpcmVkIGV4dHJhIGlu
b2RlIHNwYWNlIG5vdCIKLQkJCSAiYXZhaWxhYmxlIik7Ci0JfQorCWV4dDRfY2xhbXBfd2FudF9l
eHRyYV9pc2l6ZShzYik7CiAKIAlleHQ0X3NldF9yZXN2X2NsdXN0ZXJzKHNiKTsKIApAQCAtNDk1
OSw2ICs0OTY3LDggQEAgc3RhdGljIGludCBleHQ0X3JlbW91bnQoc3RydWN0IHN1cGVyX2Jsb2Nr
ICpzYiwgaW50ICpmbGFncywgY2hhciAqZGF0YSkKIAkJZ290byByZXN0b3JlX29wdHM7CiAJfQog
CisJZXh0NF9jbGFtcF93YW50X2V4dHJhX2lzaXplKHNiKTsKKwogCWlmICgob2xkX29wdHMuc19t
b3VudF9vcHQgJiBFWFQ0X01PVU5UX0pPVVJOQUxfQ0hFQ0tTVU0pIF4KIAkgICAgdGVzdF9vcHQo
c2IsIEpPVVJOQUxfQ0hFQ0tTVU0pKSB7CiAJCWV4dDRfbXNnKHNiLCBLRVJOX0VSUiwgImNoYW5n
aW5nIGpvdXJuYWxfY2hlY2tzdW0gIgoKRnJvbSBjM2E4OGNkOWU0NzY0YmU2Nzk3N2VhZmY1MWYw
MmE1NzE5ZjdlZWQ3IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBUaGVvZG9yZSBUcydv
IDx0eXRzb0BtaXQuZWR1PgpEYXRlOiBUaHUsIDcgTm92IDIwMTkgMjE6NDM6NDEgLTA1MDAKU3Vi
amVjdDogZXh0NDogYWRkIG1vcmUgcGFyYW5vaWEgY2hlY2tpbmcgaW4gZXh0NF9leHBhbmRfZXh0
cmFfaXNpemUgaGFuZGxpbmcKCmNvbW1pdCA0ZWE5OTkzNmExNjMwZjUxZmMzYTJkNjFhNThlYzRh
MWM0YjdkNTVhIHVwc3RyZWFtLgoKSXQncyBwb3NzaWJsZSB0byBzcGVjaWZ5IGEgbm9uLXplcm8g
c193YW50X2V4dHJhX2lzaXplIHZpYSBkZWJ1Z2dpbmcKb3B0aW9uLCBhbmQgdGhpcyBjYW4gY2F1
c2UgYmFkIHRoaW5ncyh0bSkgdG8gaGFwcGVuIHdoZW4gdXNpbmcgYSBmaWxlCnN5c3RlbSB3aXRo
IGFuIGlub2RlIHNpemUgb2YgMTI4IGJ5dGVzLgoKQWRkIGJldHRlciBjaGVja2luZyB3aGVuIHRo
ZSBmaWxlIHN5c3RlbSBpcyBtb3VudGVkLCBhcyB3ZWxsIGFzIHdoZW4Kd2UgYXJlIGFjdHVhbGx5
IGRvaW5nIHRoZSB0cnlpbmcgdG8gZG8gdGhlIGlub2RlIGV4cGFuc2lvbi4KCkxpbms6IGh0dHBz
Oi8vbG9yZS5rZXJuZWwub3JnL3IvMjAxOTExMTAxMjE1MTAuR0gyMzMyNUBtaXQuZWR1ClJlcG9y
dGVkLWJ5OiBzeXpib3QrZjhkNmY4Mzg2Y2VhY2RiZmZmNTdAc3l6a2FsbGVyLmFwcHNwb3RtYWls
LmNvbQpSZXBvcnRlZC1ieTogc3l6Ym90KzMzZDdlYTcyZTQ3ZGUzYmRmNGUxQHN5emthbGxlci5h
cHBzcG90bWFpbC5jb20KUmVwb3J0ZWQtYnk6IHN5emJvdCs0NGI2NzYzZWRmYzE3MTQ0Mjk2ZkBz
eXprYWxsZXIuYXBwc3BvdG1haWwuY29tClNpZ25lZC1vZmYtYnk6IFRoZW9kb3JlIFRzJ28gPHR5
dHNvQG1pdC5lZHU+Cltid2g6IEJhY2twb3J0ZWQgdG8gNC45OiBhZGp1c3QgY29udGV4dF0KU2ln
bmVkLW9mZi1ieTogQmVuIEh1dGNoaW5ncyA8YmVuLmh1dGNoaW5nc0Bjb2RldGhpbmsuY28udWs+
Ci0tLQogZnMvZXh0NC9pbm9kZS5jIHwgMTUgKysrKysrKysrKysrKysrCiBmcy9leHQ0L3N1cGVy
LmMgfCAyMCArKysrKysrKysrKystLS0tLS0tLQogMiBmaWxlcyBjaGFuZ2VkLCAyNyBpbnNlcnRp
b25zKCspLCA4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2ZzL2V4dDQvaW5vZGUuYyBiL2Zz
L2V4dDQvaW5vZGUuYwppbmRleCAwMGMzMjBlMmJhMWUuLjgxMzNlNjUyOTk5NCAxMDA2NDQKLS0t
IGEvZnMvZXh0NC9pbm9kZS5jCisrKyBiL2ZzL2V4dDQvaW5vZGUuYwpAQCAtNTQ3MiwxMCArNTQ3
MiwyNSBAQCBzdGF0aWMgaW50IGV4dDRfZXhwYW5kX2V4dHJhX2lzaXplKHN0cnVjdCBpbm9kZSAq
aW5vZGUsCiB7CiAJc3RydWN0IGV4dDRfaW5vZGUgKnJhd19pbm9kZTsKIAlzdHJ1Y3QgZXh0NF94
YXR0cl9pYm9keV9oZWFkZXIgKmhlYWRlcjsKKwl1bnNpZ25lZCBpbnQgaW5vZGVfc2l6ZSA9IEVY
VDRfSU5PREVfU0laRShpbm9kZS0+aV9zYik7CisJc3RydWN0IGV4dDRfaW5vZGVfaW5mbyAqZWkg
PSBFWFQ0X0koaW5vZGUpOwogCiAJaWYgKEVYVDRfSShpbm9kZSktPmlfZXh0cmFfaXNpemUgPj0g
bmV3X2V4dHJhX2lzaXplKQogCQlyZXR1cm4gMDsKIAorCS8qIHRoaXMgd2FzIGNoZWNrZWQgYXQg
aWdldCB0aW1lLCBidXQgZG91YmxlIGNoZWNrIGZvciBnb29kIG1lYXN1cmUgKi8KKwlpZiAoKEVY
VDRfR09PRF9PTERfSU5PREVfU0laRSArIGVpLT5pX2V4dHJhX2lzaXplID4gaW5vZGVfc2l6ZSkg
fHwKKwkgICAgKGVpLT5pX2V4dHJhX2lzaXplICYgMykpIHsKKwkJRVhUNF9FUlJPUl9JTk9ERShp
bm9kZSwgImJhZCBleHRyYV9pc2l6ZSAldSAoaW5vZGUgc2l6ZSAldSkiLAorCQkJCSBlaS0+aV9l
eHRyYV9pc2l6ZSwKKwkJCQkgRVhUNF9JTk9ERV9TSVpFKGlub2RlLT5pX3NiKSk7CisJCXJldHVy
biAtRUZTQ09SUlVQVEVEOworCX0KKwlpZiAoKG5ld19leHRyYV9pc2l6ZSA8IGVpLT5pX2V4dHJh
X2lzaXplKSB8fAorCSAgICAobmV3X2V4dHJhX2lzaXplIDwgNCkgfHwKKwkgICAgKG5ld19leHRy
YV9pc2l6ZSA+IGlub2RlX3NpemUgLSBFWFQ0X0dPT0RfT0xEX0lOT0RFX1NJWkUpKQorCQlyZXR1
cm4gLUVJTlZBTDsJLyogU2hvdWxkIG5ldmVyIGhhcHBlbiAqLworCiAJcmF3X2lub2RlID0gZXh0
NF9yYXdfaW5vZGUoJmlsb2MpOwogCiAJaGVhZGVyID0gSUhEUihpbm9kZSwgcmF3X2lub2RlKTsK
ZGlmZiAtLWdpdCBhL2ZzL2V4dDQvc3VwZXIuYyBiL2ZzL2V4dDQvc3VwZXIuYwppbmRleCBjZWE4
MTNhZGJlMTIuLjM5MWFiNTU4MDhjOSAxMDA2NDQKLS0tIGEvZnMvZXh0NC9zdXBlci5jCisrKyBi
L2ZzL2V4dDQvc3VwZXIuYwpAQCAtMzM0NiwxMSArMzM0NiwxNSBAQCBzdGF0aWMgdm9pZCBleHQ0
X2NsYW1wX3dhbnRfZXh0cmFfaXNpemUoc3RydWN0IHN1cGVyX2Jsb2NrICpzYikKIHsKIAlzdHJ1
Y3QgZXh0NF9zYl9pbmZvICpzYmkgPSBFWFQ0X1NCKHNiKTsKIAlzdHJ1Y3QgZXh0NF9zdXBlcl9i
bG9jayAqZXMgPSBzYmktPnNfZXM7CisJdW5zaWduZWQgZGVmX2V4dHJhX2lzaXplID0gc2l6ZW9m
KHN0cnVjdCBleHQ0X2lub2RlKSAtCisJCQkJCQlFWFQ0X0dPT0RfT0xEX0lOT0RFX1NJWkU7CiAK
LQkvKiBkZXRlcm1pbmUgdGhlIG1pbmltdW0gc2l6ZSBvZiBuZXcgbGFyZ2UgaW5vZGVzLCBpZiBw
cmVzZW50ICovCi0JaWYgKHNiaS0+c19pbm9kZV9zaXplID4gRVhUNF9HT09EX09MRF9JTk9ERV9T
SVpFKSB7Ci0JCXNiaS0+c193YW50X2V4dHJhX2lzaXplID0gc2l6ZW9mKHN0cnVjdCBleHQ0X2lu
b2RlKSAtCi0JCQkJCQkgICAgIEVYVDRfR09PRF9PTERfSU5PREVfU0laRTsKKwlpZiAoc2JpLT5z
X2lub2RlX3NpemUgPT0gRVhUNF9HT09EX09MRF9JTk9ERV9TSVpFKSB7CisJCXNiaS0+c193YW50
X2V4dHJhX2lzaXplID0gMDsKKwkJcmV0dXJuOworCX0KKwlpZiAoc2JpLT5zX3dhbnRfZXh0cmFf
aXNpemUgPCA0KSB7CisJCXNiaS0+c193YW50X2V4dHJhX2lzaXplID0gZGVmX2V4dHJhX2lzaXpl
OwogCQlpZiAoZXh0NF9oYXNfZmVhdHVyZV9leHRyYV9pc2l6ZShzYikpIHsKIAkJCWlmIChzYmkt
PnNfd2FudF9leHRyYV9pc2l6ZSA8CiAJCQkgICAgbGUxNl90b19jcHUoZXMtPnNfd2FudF9leHRy
YV9pc2l6ZSkpCkBAIC0zMzYzLDEwICszMzY3LDEwIEBAIHN0YXRpYyB2b2lkIGV4dDRfY2xhbXBf
d2FudF9leHRyYV9pc2l6ZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKQogCQl9CiAJfQogCS8qIENo
ZWNrIGlmIGVub3VnaCBpbm9kZSBzcGFjZSBpcyBhdmFpbGFibGUgKi8KLQlpZiAoRVhUNF9HT09E
X09MRF9JTk9ERV9TSVpFICsgc2JpLT5zX3dhbnRfZXh0cmFfaXNpemUgPgotCQkJCQkJCXNiaS0+
c19pbm9kZV9zaXplKSB7Ci0JCXNiaS0+c193YW50X2V4dHJhX2lzaXplID0gc2l6ZW9mKHN0cnVj
dCBleHQ0X2lub2RlKSAtCi0JCQkJCQkgICAgICAgRVhUNF9HT09EX09MRF9JTk9ERV9TSVpFOwor
CWlmICgoc2JpLT5zX3dhbnRfZXh0cmFfaXNpemUgPiBzYmktPnNfaW5vZGVfc2l6ZSkgfHwKKwkg
ICAgKEVYVDRfR09PRF9PTERfSU5PREVfU0laRSArIHNiaS0+c193YW50X2V4dHJhX2lzaXplID4K
KwkJCQkJCQlzYmktPnNfaW5vZGVfc2l6ZSkpIHsKKwkJc2JpLT5zX3dhbnRfZXh0cmFfaXNpemUg
PSBkZWZfZXh0cmFfaXNpemU7CiAJCWV4dDRfbXNnKHNiLCBLRVJOX0lORk8sCiAJCQkgInJlcXVp
cmVkIGV4dHJhIGlub2RlIHNwYWNlIG5vdCBhdmFpbGFibGUiKTsKIAl9CgpGcm9tIGFkYWZkMjNi
YzAzNmQwZDEyOWZhYzU3MzNkZTgyMDk4YzYwMjJmNTIgTW9uIFNlcCAxNyAwMDowMDowMCAyMDAx
CkZyb206IFl1ZUhhaWJpbmcgPHl1ZWhhaWJpbmdAaHVhd2VpLmNvbT4KRGF0ZTogTW9uLCAxIEFw
ciAyMDE5IDA5OjM1OjU0ICswODAwClN1YmplY3Q6IGRjY3A6IEZpeCBtZW1sZWFrIGluIF9fZmVh
dF9yZWdpc3Rlcl9zcAoKY29tbWl0IDFkM2ZmMDk1MGUyYjQwZGM4NjFiMTczOTAyOTY0OWQwM2Y1
OTE4MjAgdXBzdHJlYW0uCgpJZiBkY2NwX2ZlYXRfcHVzaF9jaGFuZ2UgZmFpbHMsIHdlIGZvcmdl
dCBmcmVlIHRoZSBtZW0Kd2hpY2ggaXMgYWxsb2NlZCBieSBrbWVtZHVwIGluIGRjY3BfZmVhdF9j
bG9uZV9zcF92YWwuCgpSZXBvcnRlZC1ieTogSHVsayBSb2JvdCA8aHVsa2NpQGh1YXdlaS5jb20+
CkZpeGVzOiBlOGVmOTY3YTU0ZjQgKCJkY2NwOiBSZWdpc3RyYXRpb24gcm91dGluZXMgZm9yIGNo
YW5naW5nIGZlYXR1cmUgdmFsdWVzIikKUmV2aWV3ZWQtYnk6IE11a2VzaCBPamhhIDxtb2poYUBj
b2RlYXVyb3JhLm9yZz4KU2lnbmVkLW9mZi1ieTogWXVlSGFpYmluZyA8eXVlaGFpYmluZ0BodWF3
ZWkuY29tPgpTaWduZWQtb2ZmLWJ5OiBEYXZpZCBTLiBNaWxsZXIgPGRhdmVtQGRhdmVtbG9mdC5u
ZXQ+ClNpZ25lZC1vZmYtYnk6IEJlbiBIdXRjaGluZ3MgPGJlbi5odXRjaGluZ3NAY29kZXRoaW5r
LmNvLnVrPgotLS0KIG5ldC9kY2NwL2ZlYXQuYyB8IDcgKysrKysrLQogMSBmaWxlIGNoYW5nZWQs
IDYgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigtKQoKZGlmZiAtLWdpdCBhL25ldC9kY2NwL2Zl
YXQuYyBiL25ldC9kY2NwL2ZlYXQuYwppbmRleCBmMjI3ZjAwMmM3M2QuLmRiODdkOWY1ODAxOSAx
MDA2NDQKLS0tIGEvbmV0L2RjY3AvZmVhdC5jCisrKyBiL25ldC9kY2NwL2ZlYXQuYwpAQCAtNzM4
LDcgKzczOCwxMiBAQCBzdGF0aWMgaW50IF9fZmVhdF9yZWdpc3Rlcl9zcChzdHJ1Y3QgbGlzdF9o
ZWFkICpmbiwgdTggZmVhdCwgdTggaXNfbG9jYWwsCiAJaWYgKGRjY3BfZmVhdF9jbG9uZV9zcF92
YWwoJmZ2YWwsIHNwX3ZhbCwgc3BfbGVuKSkKIAkJcmV0dXJuIC1FTk9NRU07CiAKLQlyZXR1cm4g
ZGNjcF9mZWF0X3B1c2hfY2hhbmdlKGZuLCBmZWF0LCBpc19sb2NhbCwgbWFuZGF0b3J5LCAmZnZh
bCk7CisJaWYgKGRjY3BfZmVhdF9wdXNoX2NoYW5nZShmbiwgZmVhdCwgaXNfbG9jYWwsIG1hbmRh
dG9yeSwgJmZ2YWwpKSB7CisJCWtmcmVlKGZ2YWwuc3AudmVjKTsKKwkJcmV0dXJuIC1FTk9NRU07
CisJfQorCisJcmV0dXJuIDA7CiB9CiAKIC8qKgo=


--=-9IbwdlaL6lCQYKApHd02--

