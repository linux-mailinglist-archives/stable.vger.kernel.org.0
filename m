Return-Path: <stable-owner@vger.kernel.org>
X-Original-To: lists+stable@lfdr.de
Delivered-To: lists+stable@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id DF7C71D016C
	for <lists+stable@lfdr.de>; Tue, 12 May 2020 23:59:56 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1728362AbgELV74 (ORCPT <rfc822;lists+stable@lfdr.de>);
        Tue, 12 May 2020 17:59:56 -0400
Received: from imap3.hz.codethink.co.uk ([176.9.8.87]:56206 "EHLO
        imap3.hz.codethink.co.uk" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1728313AbgELV7z (ORCPT
        <rfc822;stable@vger.kernel.org>); Tue, 12 May 2020 17:59:55 -0400
Received: from shadbolt.e.decadent.org.uk ([88.96.1.126] helo=xylophone)
        by imap3.hz.codethink.co.uk with esmtpsa  (Exim 4.92 #3 (Debian))
        id 1jYcw7-0008Na-8n; Tue, 12 May 2020 22:59:40 +0100
Message-ID: <7e20d8b5d48106dff7020ba0eec6f79d675b17c2.camel@codethink.co.uk>
Subject: [4.4-stable] Security fixes
From:   Ben Hutchings <ben.hutchings@codethink.co.uk>
To:     Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
        Sasha Levin <Alexander.Levin@microsoft.com>
Cc:     stable <stable@vger.kernel.org>
Date:   Tue, 12 May 2020 22:59:36 +0100
Organization: Codethink Ltd.
Content-Type: multipart/mixed; boundary="=-sm3amSSQ2Cx2K8vGyMQj"
User-Agent: Evolution 3.30.5-1.1 
MIME-Version: 1.0
Sender: stable-owner@vger.kernel.org
Precedence: bulk
List-ID: <stable.vger.kernel.org>
X-Mailing-List: stable@vger.kernel.org


--=-sm3amSSQ2Cx2K8vGyMQj
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: 7bit

Here are some fixes that required backporting for 4.4.  All of them
are already present in (or queued for) later stable branches.

Ben.

-- 
Ben Hutchings, Software Developer                         Codethink Ltd
https://www.codethink.co.uk/                 Dale House, 35 Dale Street
                                     Manchester, M1 2HF, United Kingdom

--=-sm3amSSQ2Cx2K8vGyMQj
Content-Type: application/mbox; name="security-4.4.mbox"
Content-Disposition: attachment; filename="security-4.4.mbox"
Content-Transfer-Encoding: base64

RnJvbSBmYTdiYWJhODZjZGQ1MjNiY2QzNmQxNDM0OGE5ZjE3ZDY2NTg4YTJhIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBTaGlqaWUgTHVvIDxsdW9zaGlqaWUxQGh1YXdlaS5jb20+CkRh
dGU6IE1vbiwgMTAgRmViIDIwMjAgMjA6MTc6NTIgLTA1MDAKU3ViamVjdDogZXh0NDogYWRkIGNv
bmRfcmVzY2hlZCgpIHRvIGV4dDRfcHJvdGVjdF9yZXNlcnZlZF9pbm9kZQoKY29tbWl0IGFmMTMz
YWRlOWE0MDc5NGEzNzEwNGVjYmNjMjgyN2MwZWEzNzNhM2MgdXBzdHJlYW0uCgpXaGVuIGpvdXJu
YWwgc2l6ZSBpcyBzZXQgdG9vIGJpZyBieSAibWtmcy5leHQ0IC1KIHNpemU9Iiwgb3Igd2hlbgp3
ZSBtb3VudCBhIGNyYWZ0ZWQgaW1hZ2UgdG8gbWFrZSBqb3VybmFsIGlub2RlLT5pX3NpemUgdG9v
IGJpZywKdGhlIGxvb3AsICJ3aGlsZSAoaSA8IG51bSkiLCBob2xkcyBjcHUgdG9vIGxvbmcuIFRo
aXMgY291bGQgY2F1c2UKc29mdCBsb2NrdXAuCgpbICA1MjkuMzU3NTQxXSBDYWxsIHRyYWNlOgpb
ICA1MjkuMzU3NTUxXSAgZHVtcF9iYWNrdHJhY2UrMHgwLzB4MTk4ClsgIDUyOS4zNTc1NTVdICBz
aG93X3N0YWNrKzB4MjQvMHgzMApbICA1MjkuMzU3NTYyXSAgZHVtcF9zdGFjaysweGE0LzB4Y2MK
WyAgNTI5LjM1NzU2OF0gIHdhdGNoZG9nX3RpbWVyX2ZuKzB4MzAwLzB4M2U4ClsgIDUyOS4zNTc1
NzRdICBfX2hydGltZXJfcnVuX3F1ZXVlcysweDExNC8weDM1OApbICA1MjkuMzU3NTc2XSAgaHJ0
aW1lcl9pbnRlcnJ1cHQrMHgxMDQvMHgyZDgKWyAgNTI5LjM1NzU4MF0gIGFyY2hfdGltZXJfaGFu
ZGxlcl92aXJ0KzB4MzgvMHg1OApbICA1MjkuMzU3NTg0XSAgaGFuZGxlX3BlcmNwdV9kZXZpZF9p
cnErMHg5MC8weDI0OApbICA1MjkuMzU3NTg4XSAgZ2VuZXJpY19oYW5kbGVfaXJxKzB4MzQvMHg1
MApbICA1MjkuMzU3NTkwXSAgX19oYW5kbGVfZG9tYWluX2lycSsweDY4LzB4YzAKWyAgNTI5LjM1
NzU5M10gIGdpY19oYW5kbGVfaXJxKzB4NmMvMHgxNTAKWyAgNTI5LjM1NzU5NV0gIGVsMV9pcnEr
MHhiOC8weDE0MApbICA1MjkuMzU3NTk5XSAgX19sbF9zY19hdG9taWNfYWRkX3JldHVybl9hY3F1
aXJlKzB4MTQvMHgyMApbICA1MjkuMzU3NjY4XSAgZXh0NF9tYXBfYmxvY2tzKzB4NjQvMHg1YzAg
W2V4dDRdClsgIDUyOS4zNTc2OTNdICBleHQ0X3NldHVwX3N5c3RlbV96b25lKzB4MzMwLzB4NDU4
IFtleHQ0XQpbICA1MjkuMzU3NzE3XSAgZXh0NF9maWxsX3N1cGVyKzB4MjE3MC8weDJiYTggW2V4
dDRdClsgIDUyOS4zNTc3MjJdICBtb3VudF9iZGV2KzB4MWE4LzB4MWU4ClsgIDUyOS4zNTc3NDZd
ICBleHQ0X21vdW50KzB4NDQvMHg1OCBbZXh0NF0KWyAgNTI5LjM1Nzc0OF0gIG1vdW50X2ZzKzB4
NTAvMHgxNzAKWyAgNTI5LjM1Nzc1Ml0gIHZmc19rZXJuX21vdW50LnBhcnQuOSsweDU0LzB4MTg4
ClsgIDUyOS4zNTc3NTVdICBkb19tb3VudCsweDVhYy8weGQ3OApbICA1MjkuMzU3NzU4XSAga3N5
c19tb3VudCsweDljLzB4MTE4ClsgIDUyOS4zNTc3NjBdICBfX2FybTY0X3N5c19tb3VudCsweDI4
LzB4MzgKWyAgNTI5LjM1Nzc2NF0gIGVsMF9zdmNfY29tbW9uKzB4NzgvMHgxMzAKWyAgNTI5LjM1
Nzc2Nl0gIGVsMF9zdmNfaGFuZGxlcisweDM4LzB4NzgKWyAgNTI5LjM1Nzc2OV0gIGVsMF9zdmMr
MHg4LzB4YwpbICA1NDEuMzU2NTE2XSB3YXRjaGRvZzogQlVHOiBzb2Z0IGxvY2t1cCAtIENQVSMw
IHN0dWNrIGZvciAyM3MhIFttb3VudDoxODY3NF0KCkxpbms6IGh0dHBzOi8vbG9yZS5rZXJuZWwu
b3JnL3IvMjAyMDAyMTEwMTE3NTIuMjkyNDItMS1sdW9zaGlqaWUxQGh1YXdlaS5jb20KUmV2aWV3
ZWQtYnk6IEphbiBLYXJhIDxqYWNrQHN1c2UuY3o+ClNpZ25lZC1vZmYtYnk6IFNoaWppZSBMdW8g
PGx1b3NoaWppZTFAaHVhd2VpLmNvbT4KU2lnbmVkLW9mZi1ieTogVGhlb2RvcmUgVHMnbyA8dHl0
c29AbWl0LmVkdT4KQ2M6IHN0YWJsZUBrZXJuZWwub3JnClNpZ25lZC1vZmYtYnk6IEJlbiBIdXRj
aGluZ3MgPGJlbi5odXRjaGluZ3NAY29kZXRoaW5rLmNvLnVrPgotLS0KIGZzL2V4dDQvYmxvY2tf
dmFsaWRpdHkuYyB8IDEgKwogMSBmaWxlIGNoYW5nZWQsIDEgaW5zZXJ0aW9uKCspCgpkaWZmIC0t
Z2l0IGEvZnMvZXh0NC9ibG9ja192YWxpZGl0eS5jIGIvZnMvZXh0NC9ibG9ja192YWxpZGl0eS5j
CmluZGV4IGNjZDgwZjJiM2IxOS4uZDUwNTViM2FkY2NjIDEwMDY0NAotLS0gYS9mcy9leHQ0L2Js
b2NrX3ZhbGlkaXR5LmMKKysrIGIvZnMvZXh0NC9ibG9ja192YWxpZGl0eS5jCkBAIC0xNTIsNiAr
MTUyLDcgQEAgc3RhdGljIGludCBleHQ0X3Byb3RlY3RfcmVzZXJ2ZWRfaW5vZGUoc3RydWN0IHN1
cGVyX2Jsb2NrICpzYiwgdTMyIGlubykKIAkJcmV0dXJuIFBUUl9FUlIoaW5vZGUpOwogCW51bSA9
IChpbm9kZS0+aV9zaXplICsgc2ItPnNfYmxvY2tzaXplIC0gMSkgPj4gc2ItPnNfYmxvY2tzaXpl
X2JpdHM7CiAJd2hpbGUgKGkgPCBudW0pIHsKKwkJY29uZF9yZXNjaGVkKCk7CiAJCW1hcC5tX2xi
bGsgPSBpOwogCQltYXAubV9sZW4gPSBudW0gLSBpOwogCQluID0gZXh0NF9tYXBfYmxvY2tzKE5V
TEwsIGlub2RlLCAmbWFwLCAwKTsKCkZyb20gNTdiZDU3MzRjZTQyNGMxMzhhMGQ0OGJlMzBiMTc1
NzRkMjJmMDhmMSBNb24gU2VwIDE3IDAwOjAwOjAwIDIwMDEKRnJvbTogU2FicmluYSBEdWJyb2Nh
IDxzZEBxdWVhc3lzbmFpbC5uZXQ+CkRhdGU6IFdlZCwgNCBEZWMgMjAxOSAxNTozNTo1MiArMDEw
MApTdWJqZWN0OiBuZXQ6IGlwdjY6IGFkZCBuZXQgYXJndW1lbnQgdG8gaXA2X2RzdF9sb29rdXBf
ZmxvdwoKY29tbWl0IGM0ZTg1ZjczYWZiNjM4NDEyM2U1ZWYxYmJhMzMxNWIyZTNhZDAzMWUgdXBz
dHJlYW0uCgpUaGlzIHdpbGwgYmUgdXNlZCBpbiB0aGUgY29udmVyc2lvbiBvZiBpcHY2X3N0dWIg
dG8gaXA2X2RzdF9sb29rdXBfZmxvdywKYXMgc29tZSBtb2R1bGVzIGN1cnJlbnRseSBwYXNzIGEg
bmV0IGFyZ3VtZW50IHdpdGhvdXQgYSBzb2NrZXQgdG8KaXA2X2RzdF9sb29rdXAuIFRoaXMgaXMg
ZXF1aXZhbGVudCB0byBjb21taXQgMzQzZDYwYWFkYTVhICgiaXB2NjogY2hhbmdlCmlwdjZfc3R1
Yl9pbXBsLmlwdjZfZHN0X2xvb2t1cCB0byB0YWtlIG5ldCBhcmd1bWVudCIpLgoKU2lnbmVkLW9m
Zi1ieTogU2FicmluYSBEdWJyb2NhIDxzZEBxdWVhc3lzbmFpbC5uZXQ+ClNpZ25lZC1vZmYtYnk6
IERhdmlkIFMuIE1pbGxlciA8ZGF2ZW1AZGF2ZW1sb2Z0Lm5ldD4KW2J3aDogQmFja3BvcnRlZCB0
byA0LjQ6IGFkanVzdCBjb250ZXh0XQpTaWduZWQtb2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxiZW4u
aHV0Y2hpbmdzQGNvZGV0aGluay5jby51az4KLS0tCiBpbmNsdWRlL25ldC9pcHY2LmggICAgICAg
ICAgICAgICB8IDIgKy0KIG5ldC9kY2NwL2lwdjYuYyAgICAgICAgICAgICAgICAgIHwgNiArKyst
LS0KIG5ldC9pcHY2L2FmX2luZXQ2LmMgICAgICAgICAgICAgIHwgMiArLQogbmV0L2lwdjYvZGF0
YWdyYW0uYyAgICAgICAgICAgICAgfCAyICstCiBuZXQvaXB2Ni9pbmV0Nl9jb25uZWN0aW9uX3Nv
Y2suYyB8IDQgKystLQogbmV0L2lwdjYvaXA2X291dHB1dC5jICAgICAgICAgICAgfCA4ICsrKyst
LS0tCiBuZXQvaXB2Ni9yYXcuYyAgICAgICAgICAgICAgICAgICB8IDIgKy0KIG5ldC9pcHY2L3N5
bmNvb2tpZXMuYyAgICAgICAgICAgIHwgMiArLQogbmV0L2lwdjYvdGNwX2lwdjYuYyAgICAgICAg
ICAgICAgfCA0ICsrLS0KIG5ldC9sMnRwL2wydHBfaXA2LmMgICAgICAgICAgICAgIHwgMiArLQog
bmV0L3NjdHAvaXB2Ni5jICAgICAgICAgICAgICAgICAgfCA0ICsrLS0KIDExIGZpbGVzIGNoYW5n
ZWQsIDE5IGluc2VydGlvbnMoKyksIDE5IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2luY2x1
ZGUvbmV0L2lwdjYuaCBiL2luY2x1ZGUvbmV0L2lwdjYuaAppbmRleCBjMDdjZjk1OTZiNmYuLjYy
NTgyNjRhMGJmNyAxMDA2NDQKLS0tIGEvaW5jbHVkZS9uZXQvaXB2Ni5oCisrKyBiL2luY2x1ZGUv
bmV0L2lwdjYuaApAQCAtODUzLDcgKzg1Myw3IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IHNrX2J1
ZmYgKmlwNl9maW5pc2hfc2tiKHN0cnVjdCBzb2NrICpzaykKIAogaW50IGlwNl9kc3RfbG9va3Vw
KHN0cnVjdCBuZXQgKm5ldCwgc3RydWN0IHNvY2sgKnNrLCBzdHJ1Y3QgZHN0X2VudHJ5ICoqZHN0
LAogCQkgICBzdHJ1Y3QgZmxvd2k2ICpmbDYpOwotc3RydWN0IGRzdF9lbnRyeSAqaXA2X2RzdF9s
b29rdXBfZmxvdyhjb25zdCBzdHJ1Y3Qgc29jayAqc2ssIHN0cnVjdCBmbG93aTYgKmZsNiwKK3N0
cnVjdCBkc3RfZW50cnkgKmlwNl9kc3RfbG9va3VwX2Zsb3coc3RydWN0IG5ldCAqbmV0LCBjb25z
dCBzdHJ1Y3Qgc29jayAqc2ssIHN0cnVjdCBmbG93aTYgKmZsNiwKIAkJCQkgICAgICBjb25zdCBz
dHJ1Y3QgaW42X2FkZHIgKmZpbmFsX2RzdCk7CiBzdHJ1Y3QgZHN0X2VudHJ5ICppcDZfc2tfZHN0
X2xvb2t1cF9mbG93KHN0cnVjdCBzb2NrICpzaywgc3RydWN0IGZsb3dpNiAqZmw2LAogCQkJCQkg
Y29uc3Qgc3RydWN0IGluNl9hZGRyICpmaW5hbF9kc3QpOwpkaWZmIC0tZ2l0IGEvbmV0L2RjY3Av
aXB2Ni5jIGIvbmV0L2RjY3AvaXB2Ni5jCmluZGV4IDEwZWFiZDFhNjBhYS4uNzM2Y2M5NWI1MjAx
IDEwMDY0NAotLS0gYS9uZXQvZGNjcC9pcHY2LmMKKysrIGIvbmV0L2RjY3AvaXB2Ni5jCkBAIC0y
MDksNyArMjA5LDcgQEAgc3RhdGljIGludCBkY2NwX3Y2X3NlbmRfcmVzcG9uc2UoY29uc3Qgc3Ry
dWN0IHNvY2sgKnNrLCBzdHJ1Y3QgcmVxdWVzdF9zb2NrICpyZXEKIAlmaW5hbF9wID0gZmw2X3Vw
ZGF0ZV9kc3QoJmZsNiwgcmN1X2RlcmVmZXJlbmNlKG5wLT5vcHQpLCAmZmluYWwpOwogCXJjdV9y
ZWFkX3VubG9jaygpOwogCi0JZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxvdyhzaywgJmZsNiwgZmlu
YWxfcCk7CisJZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxvdyhzb2NrX25ldChzayksIHNrLCAmZmw2
LCBmaW5hbF9wKTsKIAlpZiAoSVNfRVJSKGRzdCkpIHsKIAkJZXJyID0gUFRSX0VSUihkc3QpOwog
CQlkc3QgPSBOVUxMOwpAQCAtMjc2LDcgKzI3Niw3IEBAIHN0YXRpYyB2b2lkIGRjY3BfdjZfY3Rs
X3NlbmRfcmVzZXQoY29uc3Qgc3RydWN0IHNvY2sgKnNrLCBzdHJ1Y3Qgc2tfYnVmZiAqcnhza2Ip
CiAJc2VjdXJpdHlfc2tiX2NsYXNzaWZ5X2Zsb3cocnhza2IsIGZsb3dpNl90b19mbG93aSgmZmw2
KSk7CiAKIAkvKiBzayA9IE5VTEwsIGJ1dCBpdCBpcyBzYWZlIGZvciBub3cuIFJTVCBzb2NrZXQg
cmVxdWlyZWQuICovCi0JZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxvdyhjdGxfc2ssICZmbDYsIE5V
TEwpOworCWRzdCA9IGlwNl9kc3RfbG9va3VwX2Zsb3coc29ja19uZXQoY3RsX3NrKSwgY3RsX3Nr
LCAmZmw2LCBOVUxMKTsKIAlpZiAoIUlTX0VSUihkc3QpKSB7CiAJCXNrYl9kc3Rfc2V0KHNrYiwg
ZHN0KTsKIAkJaXA2X3htaXQoY3RsX3NrLCBza2IsICZmbDYsIE5VTEwsIDApOwpAQCAtODc5LDcg
Kzg3OSw3IEBAIHN0YXRpYyBpbnQgZGNjcF92Nl9jb25uZWN0KHN0cnVjdCBzb2NrICpzaywgc3Ry
dWN0IHNvY2thZGRyICp1YWRkciwKIAlvcHQgPSByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKG5w
LT5vcHQsIHNvY2tfb3duZWRfYnlfdXNlcihzaykpOwogCWZpbmFsX3AgPSBmbDZfdXBkYXRlX2Rz
dCgmZmw2LCBvcHQsICZmaW5hbCk7CiAKLQlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNrLCAm
Zmw2LCBmaW5hbF9wKTsKKwlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNvY2tfbmV0KHNrKSwg
c2ssICZmbDYsIGZpbmFsX3ApOwogCWlmIChJU19FUlIoZHN0KSkgewogCQllcnIgPSBQVFJfRVJS
KGRzdCk7CiAJCWdvdG8gZmFpbHVyZTsKZGlmZiAtLWdpdCBhL25ldC9pcHY2L2FmX2luZXQ2LmMg
Yi9uZXQvaXB2Ni9hZl9pbmV0Ni5jCmluZGV4IGY5YTQ0NDdjYTAwMi4uMjBjY2I1NjI3NDkwIDEw
MDY0NAotLS0gYS9uZXQvaXB2Ni9hZl9pbmV0Ni5jCisrKyBiL25ldC9pcHY2L2FmX2luZXQ2LmMK
QEAgLTY4Myw3ICs2ODMsNyBAQCBpbnQgaW5ldDZfc2tfcmVidWlsZF9oZWFkZXIoc3RydWN0IHNv
Y2sgKnNrKQogCQkJCQkgJmZpbmFsKTsKIAkJcmN1X3JlYWRfdW5sb2NrKCk7CiAKLQkJZHN0ID0g
aXA2X2RzdF9sb29rdXBfZmxvdyhzaywgJmZsNiwgZmluYWxfcCk7CisJCWRzdCA9IGlwNl9kc3Rf
bG9va3VwX2Zsb3coc29ja19uZXQoc2spLCBzaywgJmZsNiwgZmluYWxfcCk7CiAJCWlmIChJU19F
UlIoZHN0KSkgewogCQkJc2stPnNrX3JvdXRlX2NhcHMgPSAwOwogCQkJc2stPnNrX2Vycl9zb2Z0
ID0gLVBUUl9FUlIoZHN0KTsKZGlmZiAtLWdpdCBhL25ldC9pcHY2L2RhdGFncmFtLmMgYi9uZXQv
aXB2Ni9kYXRhZ3JhbS5jCmluZGV4IDI3Y2RmNTQzYzUzOS4uZjMzMTU0MzY1YjY0IDEwMDY0NAot
LS0gYS9uZXQvaXB2Ni9kYXRhZ3JhbS5jCisrKyBiL25ldC9pcHY2L2RhdGFncmFtLmMKQEAgLTE3
OSw3ICsxNzksNyBAQCBpcHY0X2Nvbm5lY3RlZDoKIAlmaW5hbF9wID0gZmw2X3VwZGF0ZV9kc3Qo
JmZsNiwgb3B0LCAmZmluYWwpOwogCXJjdV9yZWFkX3VubG9jaygpOwogCi0JZHN0ID0gaXA2X2Rz
dF9sb29rdXBfZmxvdyhzaywgJmZsNiwgZmluYWxfcCk7CisJZHN0ID0gaXA2X2RzdF9sb29rdXBf
Zmxvdyhzb2NrX25ldChzayksIHNrLCAmZmw2LCBmaW5hbF9wKTsKIAllcnIgPSAwOwogCWlmIChJ
U19FUlIoZHN0KSkgewogCQllcnIgPSBQVFJfRVJSKGRzdCk7CmRpZmYgLS1naXQgYS9uZXQvaXB2
Ni9pbmV0Nl9jb25uZWN0aW9uX3NvY2suYyBiL25ldC9pcHY2L2luZXQ2X2Nvbm5lY3Rpb25fc29j
ay5jCmluZGV4IGE3Y2EyY2RlMmVjYi4uYjMxYWI1MTFjNzY3IDEwMDY0NAotLS0gYS9uZXQvaXB2
Ni9pbmV0Nl9jb25uZWN0aW9uX3NvY2suYworKysgYi9uZXQvaXB2Ni9pbmV0Nl9jb25uZWN0aW9u
X3NvY2suYwpAQCAtODgsNyArODgsNyBAQCBzdHJ1Y3QgZHN0X2VudHJ5ICppbmV0Nl9jc2tfcm91
dGVfcmVxKGNvbnN0IHN0cnVjdCBzb2NrICpzaywKIAlmbDYtPmZsNl9zcG9ydCA9IGh0b25zKGly
ZXEtPmlyX251bSk7CiAJc2VjdXJpdHlfcmVxX2NsYXNzaWZ5X2Zsb3cocmVxLCBmbG93aTZfdG9f
Zmxvd2koZmw2KSk7CiAKLQlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNrLCBmbDYsIGZpbmFs
X3ApOworCWRzdCA9IGlwNl9kc3RfbG9va3VwX2Zsb3coc29ja19uZXQoc2spLCBzaywgZmw2LCBm
aW5hbF9wKTsKIAlpZiAoSVNfRVJSKGRzdCkpCiAJCXJldHVybiBOVUxMOwogCkBAIC0xNDIsNyAr
MTQyLDcgQEAgc3RhdGljIHN0cnVjdCBkc3RfZW50cnkgKmluZXQ2X2Nza19yb3V0ZV9zb2NrZXQo
c3RydWN0IHNvY2sgKnNrLAogCiAJZHN0ID0gX19pbmV0Nl9jc2tfZHN0X2NoZWNrKHNrLCBucC0+
ZHN0X2Nvb2tpZSk7CiAJaWYgKCFkc3QpIHsKLQkJZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxvdyhz
aywgZmw2LCBmaW5hbF9wKTsKKwkJZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxvdyhzb2NrX25ldChz
ayksIHNrLCBmbDYsIGZpbmFsX3ApOwogCiAJCWlmICghSVNfRVJSKGRzdCkpCiAJCQlpcDZfZHN0
X3N0b3JlKHNrLCBkc3QsIE5VTEwsIE5VTEwpOwpkaWZmIC0tZ2l0IGEvbmV0L2lwdjYvaXA2X291
dHB1dC5jIGIvbmV0L2lwdjYvaXA2X291dHB1dC5jCmluZGV4IGUzOWRjOTQ0ODZiMi4uMWUyYjhk
MzNkMzAzIDEwMDY0NAotLS0gYS9uZXQvaXB2Ni9pcDZfb3V0cHV0LmMKKysrIGIvbmV0L2lwdjYv
aXA2X291dHB1dC5jCkBAIC0xMDU3LDEzICsxMDU3LDEzIEBAIEVYUE9SVF9TWU1CT0xfR1BMKGlw
Nl9kc3RfbG9va3VwKTsKICAqCUl0IHJldHVybnMgYSB2YWxpZCBkc3QgcG9pbnRlciBvbiBzdWNj
ZXNzLCBvciBhIHBvaW50ZXIgZW5jb2RlZAogICoJZXJyb3IgY29kZS4KICAqLwotc3RydWN0IGRz
dF9lbnRyeSAqaXA2X2RzdF9sb29rdXBfZmxvdyhjb25zdCBzdHJ1Y3Qgc29jayAqc2ssIHN0cnVj
dCBmbG93aTYgKmZsNiwKK3N0cnVjdCBkc3RfZW50cnkgKmlwNl9kc3RfbG9va3VwX2Zsb3coc3Ry
dWN0IG5ldCAqbmV0LCBjb25zdCBzdHJ1Y3Qgc29jayAqc2ssIHN0cnVjdCBmbG93aTYgKmZsNiwK
IAkJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW42X2FkZHIgKmZpbmFsX2RzdCkKIHsKIAlzdHJ1Y3Qg
ZHN0X2VudHJ5ICpkc3QgPSBOVUxMOwogCWludCBlcnI7CiAKLQllcnIgPSBpcDZfZHN0X2xvb2t1
cF90YWlsKHNvY2tfbmV0KHNrKSwgc2ssICZkc3QsIGZsNik7CisJZXJyID0gaXA2X2RzdF9sb29r
dXBfdGFpbChuZXQsIHNrLCAmZHN0LCBmbDYpOwogCWlmIChlcnIpCiAJCXJldHVybiBFUlJfUFRS
KGVycik7CiAJaWYgKGZpbmFsX2RzdCkKQEAgLTEwNzEsNyArMTA3MSw3IEBAIHN0cnVjdCBkc3Rf
ZW50cnkgKmlwNl9kc3RfbG9va3VwX2Zsb3coY29uc3Qgc3RydWN0IHNvY2sgKnNrLCBzdHJ1Y3Qg
Zmxvd2k2ICpmbDYsCiAJaWYgKCFmbDYtPmZsb3dpNl9vaWYpCiAJCWZsNi0+Zmxvd2k2X29pZiA9
IGwzbWRldl9maWJfb2lmKGRzdC0+ZGV2KTsKIAotCXJldHVybiB4ZnJtX2xvb2t1cF9yb3V0ZShz
b2NrX25ldChzayksIGRzdCwgZmxvd2k2X3RvX2Zsb3dpKGZsNiksIHNrLCAwKTsKKwlyZXR1cm4g
eGZybV9sb29rdXBfcm91dGUobmV0LCBkc3QsIGZsb3dpNl90b19mbG93aShmbDYpLCBzaywgMCk7
CiB9CiBFWFBPUlRfU1lNQk9MX0dQTChpcDZfZHN0X2xvb2t1cF9mbG93KTsKIApAQCAtMTA5Niw3
ICsxMDk2LDcgQEAgc3RydWN0IGRzdF9lbnRyeSAqaXA2X3NrX2RzdF9sb29rdXBfZmxvdyhzdHJ1
Y3Qgc29jayAqc2ssIHN0cnVjdCBmbG93aTYgKmZsNiwKIAogCWRzdCA9IGlwNl9za19kc3RfY2hl
Y2soc2ssIGRzdCwgZmw2KTsKIAlpZiAoIWRzdCkKLQkJZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxv
dyhzaywgZmw2LCBmaW5hbF9kc3QpOworCQlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNvY2tf
bmV0KHNrKSwgc2ssIGZsNiwgZmluYWxfZHN0KTsKIAogCXJldHVybiBkc3Q7CiB9CmRpZmYgLS1n
aXQgYS9uZXQvaXB2Ni9yYXcuYyBiL25ldC9pcHY2L3Jhdy5jCmluZGV4IDg2Yzc1ZTk3Y2ZlYy4u
NjdjZGNkM2Q2NDRmIDEwMDY0NAotLS0gYS9uZXQvaXB2Ni9yYXcuYworKysgYi9uZXQvaXB2Ni9y
YXcuYwpAQCAtODg5LDcgKzg4OSw3IEBAIHN0YXRpYyBpbnQgcmF3djZfc2VuZG1zZyhzdHJ1Y3Qg
c29jayAqc2ssIHN0cnVjdCBtc2doZHIgKm1zZywgc2l6ZV90IGxlbikKIAlpZiAoaGRyaW5jbCkK
IAkJZmw2LmZsb3dpNl9mbGFncyB8PSBGTE9XSV9GTEFHX0tOT1dOX05IOwogCi0JZHN0ID0gaXA2
X2RzdF9sb29rdXBfZmxvdyhzaywgJmZsNiwgZmluYWxfcCk7CisJZHN0ID0gaXA2X2RzdF9sb29r
dXBfZmxvdyhzb2NrX25ldChzayksIHNrLCAmZmw2LCBmaW5hbF9wKTsKIAlpZiAoSVNfRVJSKGRz
dCkpIHsKIAkJZXJyID0gUFRSX0VSUihkc3QpOwogCQlnb3RvIG91dDsKZGlmZiAtLWdpdCBhL25l
dC9pcHY2L3N5bmNvb2tpZXMuYyBiL25ldC9pcHY2L3N5bmNvb2tpZXMuYwppbmRleCBhZWU4NzI4
MmQzNTIuLmZiM2JhMmE1MTExOSAxMDA2NDQKLS0tIGEvbmV0L2lwdjYvc3luY29va2llcy5jCisr
KyBiL25ldC9pcHY2L3N5bmNvb2tpZXMuYwpAQCAtMjMxLDcgKzIzMSw3IEBAIHN0cnVjdCBzb2Nr
ICpjb29raWVfdjZfY2hlY2soc3RydWN0IHNvY2sgKnNrLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQog
CQlmbDYuZmw2X3Nwb3J0ID0gaW5ldF9zayhzayktPmluZXRfc3BvcnQ7CiAJCXNlY3VyaXR5X3Jl
cV9jbGFzc2lmeV9mbG93KHJlcSwgZmxvd2k2X3RvX2Zsb3dpKCZmbDYpKTsKIAotCQlkc3QgPSBp
cDZfZHN0X2xvb2t1cF9mbG93KHNrLCAmZmw2LCBmaW5hbF9wKTsKKwkJZHN0ID0gaXA2X2RzdF9s
b29rdXBfZmxvdyhzb2NrX25ldChzayksIHNrLCAmZmw2LCBmaW5hbF9wKTsKIAkJaWYgKElTX0VS
Uihkc3QpKQogCQkJZ290byBvdXRfZnJlZTsKIAl9CmRpZmYgLS1naXQgYS9uZXQvaXB2Ni90Y3Bf
aXB2Ni5jIGIvbmV0L2lwdjYvdGNwX2lwdjYuYwppbmRleCA2YTM2ZmNjNWM0ZTEuLmI0ZmZjZWM3
MzJiNCAxMDA2NDQKLS0tIGEvbmV0L2lwdjYvdGNwX2lwdjYuYworKysgYi9uZXQvaXB2Ni90Y3Bf
aXB2Ni5jCkBAIC0yNDUsNyArMjQ1LDcgQEAgc3RhdGljIGludCB0Y3BfdjZfY29ubmVjdChzdHJ1
Y3Qgc29jayAqc2ssIHN0cnVjdCBzb2NrYWRkciAqdWFkZHIsCiAKIAlzZWN1cml0eV9za19jbGFz
c2lmeV9mbG93KHNrLCBmbG93aTZfdG9fZmxvd2koJmZsNikpOwogCi0JZHN0ID0gaXA2X2RzdF9s
b29rdXBfZmxvdyhzaywgJmZsNiwgZmluYWxfcCk7CisJZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxv
dyhzb2NrX25ldChzayksIHNrLCAmZmw2LCBmaW5hbF9wKTsKIAlpZiAoSVNfRVJSKGRzdCkpIHsK
IAkJZXJyID0gUFRSX0VSUihkc3QpOwogCQlnb3RvIGZhaWx1cmU7CkBAIC04MzEsNyArODMxLDcg
QEAgc3RhdGljIHZvaWQgdGNwX3Y2X3NlbmRfcmVzcG9uc2UoY29uc3Qgc3RydWN0IHNvY2sgKnNr
LCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCB1MzIKIAkgKiBVbmRlcmx5aW5nIGZ1bmN0aW9uIHdpbGwg
dXNlIHRoaXMgdG8gcmV0cmlldmUgdGhlIG5ldHdvcmsKIAkgKiBuYW1lc3BhY2UKIAkgKi8KLQlk
c3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KGN0bF9zaywgJmZsNiwgTlVMTCk7CisJZHN0ID0gaXA2
X2RzdF9sb29rdXBfZmxvdyhzb2NrX25ldChjdGxfc2spLCBjdGxfc2ssICZmbDYsIE5VTEwpOwog
CWlmICghSVNfRVJSKGRzdCkpIHsKIAkJc2tiX2RzdF9zZXQoYnVmZiwgZHN0KTsKIAkJaXA2X3ht
aXQoY3RsX3NrLCBidWZmLCAmZmw2LCBOVUxMLCB0Y2xhc3MpOwpkaWZmIC0tZ2l0IGEvbmV0L2wy
dHAvbDJ0cF9pcDYuYyBiL25ldC9sMnRwL2wydHBfaXA2LmMKaW5kZXggYWYwNGE4YTY4MjY5Li4y
YjUyMzBlZjg1MzYgMTAwNjQ0Ci0tLSBhL25ldC9sMnRwL2wydHBfaXA2LmMKKysrIGIvbmV0L2wy
dHAvbDJ0cF9pcDYuYwpAQCAtNjE5LDcgKzYxOSw3IEBAIHN0YXRpYyBpbnQgbDJ0cF9pcDZfc2Vu
ZG1zZyhzdHJ1Y3Qgc29jayAqc2ssIHN0cnVjdCBtc2doZHIgKm1zZywgc2l6ZV90IGxlbikKIAog
CXNlY3VyaXR5X3NrX2NsYXNzaWZ5X2Zsb3coc2ssIGZsb3dpNl90b19mbG93aSgmZmw2KSk7CiAK
LQlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNrLCAmZmw2LCBmaW5hbF9wKTsKKwlkc3QgPSBp
cDZfZHN0X2xvb2t1cF9mbG93KHNvY2tfbmV0KHNrKSwgc2ssICZmbDYsIGZpbmFsX3ApOwogCWlm
IChJU19FUlIoZHN0KSkgewogCQllcnIgPSBQVFJfRVJSKGRzdCk7CiAJCWdvdG8gb3V0OwpkaWZm
IC0tZ2l0IGEvbmV0L3NjdHAvaXB2Ni5jIGIvbmV0L3NjdHAvaXB2Ni5jCmluZGV4IGRkMDk3ZTA2
NWYzOS4uMWE2ODQ5YWRkMGUzIDEwMDY0NAotLS0gYS9uZXQvc2N0cC9pcHY2LmMKKysrIGIvbmV0
L3NjdHAvaXB2Ni5jCkBAIC0yNjgsNyArMjY4LDcgQEAgc3RhdGljIHZvaWQgc2N0cF92Nl9nZXRf
ZHN0KHN0cnVjdCBzY3RwX3RyYW5zcG9ydCAqdCwgdW5pb24gc2N0cF9hZGRyICpzYWRkciwKIAlm
aW5hbF9wID0gZmw2X3VwZGF0ZV9kc3QoZmw2LCByY3VfZGVyZWZlcmVuY2UobnAtPm9wdCksICZm
aW5hbCk7CiAJcmN1X3JlYWRfdW5sb2NrKCk7CiAKLQlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93
KHNrLCBmbDYsIGZpbmFsX3ApOworCWRzdCA9IGlwNl9kc3RfbG9va3VwX2Zsb3coc29ja19uZXQo
c2spLCBzaywgZmw2LCBmaW5hbF9wKTsKIAlpZiAoIWFzb2MgfHwgc2FkZHIpIHsKIAkJdC0+ZHN0
ID0gZHN0OwogCQltZW1jcHkoZmwsICZfZmwsIHNpemVvZihfZmwpKTsKQEAgLTMyNiw3ICszMjYs
NyBAQCBzdGF0aWMgdm9pZCBzY3RwX3Y2X2dldF9kc3Qoc3RydWN0IHNjdHBfdHJhbnNwb3J0ICp0
LCB1bmlvbiBzY3RwX2FkZHIgKnNhZGRyLAogCQlmbDYtPnNhZGRyID0gbGFkZHItPmEudjYuc2lu
Nl9hZGRyOwogCQlmbDYtPmZsNl9zcG9ydCA9IGxhZGRyLT5hLnY2LnNpbjZfcG9ydDsKIAkJZmlu
YWxfcCA9IGZsNl91cGRhdGVfZHN0KGZsNiwgcmN1X2RlcmVmZXJlbmNlKG5wLT5vcHQpLCAmZmlu
YWwpOwotCQliZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxvdyhzaywgZmw2LCBmaW5hbF9wKTsKKwkJ
YmRzdCA9IGlwNl9kc3RfbG9va3VwX2Zsb3coc29ja19uZXQoc2spLCBzaywgZmw2LCBmaW5hbF9w
KTsKIAogCQlpZiAoSVNfRVJSKGJkc3QpKQogCQkJY29udGludWU7CgpGcm9tIDg4YTU4ZDAzYjFj
YTg0ZDg2NjY1MGQ3ZjdhYTk0YmUxMTBkYTQ3M2MgTW9uIFNlcCAxNyAwMDowMDowMCAyMDAxCkZy
b206IFNhYnJpbmEgRHVicm9jYSA8c2RAcXVlYXN5c25haWwubmV0PgpEYXRlOiBXZWQsIDQgRGVj
IDIwMTkgMTU6MzU6NTMgKzAxMDAKU3ViamVjdDogbmV0OiBpcHY2X3N0dWI6IHVzZSBpcDZfZHN0
X2xvb2t1cF9mbG93IGluc3RlYWQgb2YgaXA2X2RzdF9sb29rdXAKCmNvbW1pdCA2Yzg5OTFmNDE1
NDZjM2M0NzI1MDNkZmYxZWE5ZGFhZGRmOTMzMWMyIHVwc3RyZWFtLgoKaXB2Nl9zdHViIHVzZXMg
dGhlIGlwNl9kc3RfbG9va3VwIGZ1bmN0aW9uIHRvIGFsbG93IG90aGVyIG1vZHVsZXMgdG8KcGVy
Zm9ybSBJUHY2IGxvb2t1cHMuIEhvd2V2ZXIsIHRoaXMgZnVuY3Rpb24gc2tpcHMgdGhlIFhGUk0g
bGF5ZXIKZW50aXJlbHkuCgpBbGwgdXNlcnMgb2YgaXB2Nl9zdHViLT5pcDZfZHN0X2xvb2t1cCB1
c2UgaXBfcm91dGVfb3V0cHV0X2Zsb3cgKHZpYSB0aGUKaXBfcm91dGVfb3V0cHV0X2tleSBhbmQg
aXBfcm91dGVfb3V0cHV0IGhlbHBlcnMpIGZvciB0aGVpciBJUHY0IGxvb2t1cHMsCndoaWNoIGNh
bGxzIHhmcm1fbG9va3VwX3JvdXRlKCkuIFRoaXMgcGF0Y2ggZml4ZXMgdGhpcyBpbmNvbnNpc3Rl
bnQKYmVoYXZpb3IgYnkgc3dpdGNoaW5nIHRoZSBzdHViIHRvIGlwNl9kc3RfbG9va3VwX2Zsb3cs
IHdoaWNoIGFsc28gY2FsbHMKeGZybV9sb29rdXBfcm91dGUoKS4KClRoaXMgcmVxdWlyZXMgc29t
ZSBjaGFuZ2VzIGluIGFsbCB0aGUgY2FsbGVycywgYXMgdGhlc2UgdHdvIGZ1bmN0aW9ucwp0YWtl
IGRpZmZlcmVudCBhcmd1bWVudHMgYW5kIGhhdmUgZGlmZmVyZW50IHJldHVybiB0eXBlcy4KCkZp
eGVzOiA1ZjgxYmQyZTVkODAgKCJpcHY2OiBleHBvcnQgYSBzdHViIGZvciBJUHY2IHN5bWJvbHMg
dXNlZCBieSB2eGxhbiIpClJlcG9ydGVkLWJ5OiBYaXVtZWkgTXUgPHhtdUByZWRoYXQuY29tPgpT
aWduZWQtb2ZmLWJ5OiBTYWJyaW5hIER1YnJvY2EgPHNkQHF1ZWFzeXNuYWlsLm5ldD4KU2lnbmVk
LW9mZi1ieTogRGF2aWQgUy4gTWlsbGVyIDxkYXZlbUBkYXZlbWxvZnQubmV0PgpbYndoOiBCYWNr
cG9ydGVkIHRvIDQuNDoKIC0gRHJvcCBjaGFuZ2VzIGluIGx3dF9icGYuYywgbWx4NSwgYW5kIHJ4
ZQogLSBBZGp1c3QgZmlsZW5hbWUsIGNvbnRleHQsIGluZGVudGF0aW9uXQpTaWduZWQtb2ZmLWJ5
OiBCZW4gSHV0Y2hpbmdzIDxiZW4uaHV0Y2hpbmdzQGNvZGV0aGluay5jby51az4KLS0tCiBkcml2
ZXJzL2luZmluaWJhbmQvY29yZS9hZGRyLmMgfCAgNiArKystLS0KIGRyaXZlcnMvbmV0L2dlbmV2
ZS5jICAgICAgICAgICB8ICA0ICsrKy0KIGRyaXZlcnMvbmV0L3Z4bGFuLmMgICAgICAgICAgICB8
IDEwICsrKystLS0tLS0KIGluY2x1ZGUvbmV0L2FkZHJjb25mLmggICAgICAgICB8ICA2ICsrKyst
LQogbmV0L2lwdjYvYWRkcmNvbmZfY29yZS5jICAgICAgIHwgMTEgKysrKysrLS0tLS0KIG5ldC9p
cHY2L2FmX2luZXQ2LmMgICAgICAgICAgICB8ICAyICstCiBuZXQvbXBscy9hZl9tcGxzLmMgICAg
ICAgICAgICAgfCAgNyArKystLS0tCiBuZXQvdGlwYy91ZHBfbWVkaWEuYyAgICAgICAgICAgfCAg
OSArKysrKystLS0KIDggZmlsZXMgY2hhbmdlZCwgMzAgaW5zZXJ0aW9ucygrKSwgMjUgZGVsZXRp
b25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9pbmZpbmliYW5kL2NvcmUvYWRkci5jIGIvZHJp
dmVycy9pbmZpbmliYW5kL2NvcmUvYWRkci5jCmluZGV4IDY4ODM1ZGUwN2UwNy4uYTgzNDkxMDA4
NTRlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2luZmluaWJhbmQvY29yZS9hZGRyLmMKKysrIGIvZHJp
dmVycy9pbmZpbmliYW5kL2NvcmUvYWRkci5jCkBAIC0yOTMsOSArMjkzLDkgQEAgc3RhdGljIGlu
dCBhZGRyNl9yZXNvbHZlKHN0cnVjdCBzb2NrYWRkcl9pbjYgKnNyY19pbiwKIAlmbDYuc2FkZHIg
PSBzcmNfaW4tPnNpbjZfYWRkcjsKIAlmbDYuZmxvd2k2X29pZiA9IGFkZHItPmJvdW5kX2Rldl9p
ZjsKIAotCXJldCA9IGlwdjZfc3R1Yi0+aXB2Nl9kc3RfbG9va3VwKGFkZHItPm5ldCwgTlVMTCwg
JmRzdCwgJmZsNik7Ci0JaWYgKHJldCA8IDApCi0JCWdvdG8gcHV0OworCWRzdCA9IGlwdjZfc3R1
Yi0+aXB2Nl9kc3RfbG9va3VwX2Zsb3coYWRkci0+bmV0LCBOVUxMLCAmZmw2LCBOVUxMKTsKKwlp
ZiAoSVNfRVJSKGRzdCkpCisJCXJldHVybiBQVFJfRVJSKGRzdCk7CiAKIAlpZiAoaXB2Nl9hZGRy
X2FueSgmZmw2LnNhZGRyKSkgewogCQlyZXQgPSBpcHY2X2Rldl9nZXRfc2FkZHIoYWRkci0+bmV0
LCBpcDZfZHN0X2lkZXYoZHN0KS0+ZGV2LApkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZ2VuZXZl
LmMgYi9kcml2ZXJzL25ldC9nZW5ldmUuYwppbmRleCAxOTg4YmMwMGRlM2MuLmVjMTNlMmFlNmQx
NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQvZ2VuZXZlLmMKKysrIGIvZHJpdmVycy9uZXQvZ2Vu
ZXZlLmMKQEAgLTc4MSw3ICs3ODEsOSBAQCBzdGF0aWMgc3RydWN0IGRzdF9lbnRyeSAqZ2VuZXZl
X2dldF92Nl9kc3Qoc3RydWN0IHNrX2J1ZmYgKnNrYiwKIAkJZmw2LT5kYWRkciA9IGdlbmV2ZS0+
cmVtb3RlLnNpbjYuc2luNl9hZGRyOwogCX0KIAotCWlmIChpcHY2X3N0dWItPmlwdjZfZHN0X2xv
b2t1cChnZW5ldmUtPm5ldCwgZ3M2LT5zb2NrLT5zaywgJmRzdCwgZmw2KSkgeworCWRzdCA9IGlw
djZfc3R1Yi0+aXB2Nl9kc3RfbG9va3VwX2Zsb3coZ2VuZXZlLT5uZXQsIGdzNi0+c29jay0+c2ss
IGZsNiwKKwkJCQkJICAgICAgTlVMTCk7CisJaWYgKElTX0VSUihkc3QpKSB7CiAJCW5ldGRldl9k
YmcoZGV2LCAibm8gcm91dGUgdG8gJXBJNlxuIiwgJmZsNi0+ZGFkZHIpOwogCQlyZXR1cm4gRVJS
X1BUUigtRU5FVFVOUkVBQ0gpOwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L3Z4bGFuLmMg
Yi9kcml2ZXJzL25ldC92eGxhbi5jCmluZGV4IDc1MmY0NGEwZTNhZi4uZDZhZTZkM2M5OGVkIDEw
MDY0NAotLS0gYS9kcml2ZXJzL25ldC92eGxhbi5jCisrKyBiL2RyaXZlcnMvbmV0L3Z4bGFuLmMK
QEAgLTE4NjQsNyArMTg2NCw2IEBAIHN0YXRpYyBzdHJ1Y3QgZHN0X2VudHJ5ICp2eGxhbjZfZ2V0
X3JvdXRlKHN0cnVjdCB2eGxhbl9kZXYgKnZ4bGFuLAogewogCXN0cnVjdCBkc3RfZW50cnkgKm5k
c3Q7CiAJc3RydWN0IGZsb3dpNiBmbDY7Ci0JaW50IGVycjsKIAogCW1lbXNldCgmZmw2LCAwLCBz
aXplb2YoZmw2KSk7CiAJZmw2LmZsb3dpNl9vaWYgPSBvaWY7CkBAIC0xODczLDExICsxODcyLDEw
IEBAIHN0YXRpYyBzdHJ1Y3QgZHN0X2VudHJ5ICp2eGxhbjZfZ2V0X3JvdXRlKHN0cnVjdCB2eGxh
bl9kZXYgKnZ4bGFuLAogCWZsNi5mbG93aTZfbWFyayA9IHNrYi0+bWFyazsKIAlmbDYuZmxvd2k2
X3Byb3RvID0gSVBQUk9UT19VRFA7CiAKLQllcnIgPSBpcHY2X3N0dWItPmlwdjZfZHN0X2xvb2t1
cCh2eGxhbi0+bmV0LAotCQkJCQkgdnhsYW4tPnZuNl9zb2NrLT5zb2NrLT5zaywKLQkJCQkJICZu
ZHN0LCAmZmw2KTsKLQlpZiAoZXJyIDwgMCkKLQkJcmV0dXJuIEVSUl9QVFIoZXJyKTsKKwluZHN0
ID0gaXB2Nl9zdHViLT5pcHY2X2RzdF9sb29rdXBfZmxvdyh2eGxhbi0+bmV0LCB2eGxhbi0+dm42
X3NvY2stPnNvY2stPnNrLAorCQkJCQkgICAgICAgJmZsNiwgTlVMTCk7CisJaWYgKHVubGlrZWx5
KElTX0VSUihuZHN0KSkpCisJCXJldHVybiBFUlJfUFRSKC1FTkVUVU5SRUFDSCk7CiAKIAkqc2Fk
ZHIgPSBmbDYuc2FkZHI7CiAJcmV0dXJuIG5kc3Q7CmRpZmYgLS1naXQgYS9pbmNsdWRlL25ldC9h
ZGRyY29uZi5oIGIvaW5jbHVkZS9uZXQvYWRkcmNvbmYuaAppbmRleCBhZjAzMmU1NDA1ZjYuLjI3
YTE4MzNjN2IwMCAxMDA2NDQKLS0tIGEvaW5jbHVkZS9uZXQvYWRkcmNvbmYuaAorKysgYi9pbmNs
dWRlL25ldC9hZGRyY29uZi5oCkBAIC0xOTIsOCArMTkyLDEwIEBAIHN0cnVjdCBpcHY2X3N0dWIg
ewogCQkJCSBjb25zdCBzdHJ1Y3QgaW42X2FkZHIgKmFkZHIpOwogCWludCAoKmlwdjZfc29ja19t
Y19kcm9wKShzdHJ1Y3Qgc29jayAqc2ssIGludCBpZmluZGV4LAogCQkJCSBjb25zdCBzdHJ1Y3Qg
aW42X2FkZHIgKmFkZHIpOwotCWludCAoKmlwdjZfZHN0X2xvb2t1cCkoc3RydWN0IG5ldCAqbmV0
LCBzdHJ1Y3Qgc29jayAqc2ssCi0JCQkgICAgICAgc3RydWN0IGRzdF9lbnRyeSAqKmRzdCwgc3Ry
dWN0IGZsb3dpNiAqZmw2KTsKKwlzdHJ1Y3QgZHN0X2VudHJ5ICooKmlwdjZfZHN0X2xvb2t1cF9m
bG93KShzdHJ1Y3QgbmV0ICpuZXQsCisJCQkJCQkgIGNvbnN0IHN0cnVjdCBzb2NrICpzaywKKwkJ
CQkJCSAgc3RydWN0IGZsb3dpNiAqZmw2LAorCQkJCQkJICBjb25zdCBzdHJ1Y3QgaW42X2FkZHIg
KmZpbmFsX2RzdCk7CiAJdm9pZCAoKnVkcHY2X2VuY2FwX2VuYWJsZSkodm9pZCk7CiAJdm9pZCAo
Km5kaXNjX3NlbmRfbmEpKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIGNvbnN0IHN0cnVjdCBpbjZf
YWRkciAqZGFkZHIsCiAJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW42X2FkZHIgKnNvbGljaXRlZF9h
ZGRyLApkaWZmIC0tZ2l0IGEvbmV0L2lwdjYvYWRkcmNvbmZfY29yZS5jIGIvbmV0L2lwdjYvYWRk
cmNvbmZfY29yZS5jCmluZGV4IGJmYTk0MWZjMTE2NS4uMTI5MzI0YjM2ZmI2IDEwMDY0NAotLS0g
YS9uZXQvaXB2Ni9hZGRyY29uZl9jb3JlLmMKKysrIGIvbmV0L2lwdjYvYWRkcmNvbmZfY29yZS5j
CkBAIC0xMDcsMTUgKzEwNywxNiBAQCBpbnQgaW5ldDZhZGRyX25vdGlmaWVyX2NhbGxfY2hhaW4o
dW5zaWduZWQgbG9uZyB2YWwsIHZvaWQgKnYpCiB9CiBFWFBPUlRfU1lNQk9MKGluZXQ2YWRkcl9u
b3RpZmllcl9jYWxsX2NoYWluKTsKIAotc3RhdGljIGludCBlYWZub3N1cHBvcnRfaXB2Nl9kc3Rf
bG9va3VwKHN0cnVjdCBuZXQgKm5ldCwgc3RydWN0IHNvY2sgKnUxLAotCQkJCQlzdHJ1Y3QgZHN0
X2VudHJ5ICoqdTIsCi0JCQkJCXN0cnVjdCBmbG93aTYgKnUzKQorc3RhdGljIHN0cnVjdCBkc3Rf
ZW50cnkgKmVhZm5vc3VwcG9ydF9pcHY2X2RzdF9sb29rdXBfZmxvdyhzdHJ1Y3QgbmV0ICpuZXQs
CisJCQkJCQkJICAgY29uc3Qgc3RydWN0IHNvY2sgKnNrLAorCQkJCQkJCSAgIHN0cnVjdCBmbG93
aTYgKmZsNiwKKwkJCQkJCQkgICBjb25zdCBzdHJ1Y3QgaW42X2FkZHIgKmZpbmFsX2RzdCkKIHsK
LQlyZXR1cm4gLUVBRk5PU1VQUE9SVDsKKwlyZXR1cm4gRVJSX1BUUigtRUFGTk9TVVBQT1JUKTsK
IH0KIAogY29uc3Qgc3RydWN0IGlwdjZfc3R1YiAqaXB2Nl9zdHViIF9fcmVhZF9tb3N0bHkgPSAm
KHN0cnVjdCBpcHY2X3N0dWIpIHsKLQkuaXB2Nl9kc3RfbG9va3VwID0gZWFmbm9zdXBwb3J0X2lw
djZfZHN0X2xvb2t1cCwKKwkuaXB2Nl9kc3RfbG9va3VwX2Zsb3cgPSBlYWZub3N1cHBvcnRfaXB2
Nl9kc3RfbG9va3VwX2Zsb3csCiB9OwogRVhQT1JUX1NZTUJPTF9HUEwoaXB2Nl9zdHViKTsKIApk
aWZmIC0tZ2l0IGEvbmV0L2lwdjYvYWZfaW5ldDYuYyBiL25ldC9pcHY2L2FmX2luZXQ2LmMKaW5k
ZXggMjBjY2I1NjI3NDkwLi4zMmRiNDAxMGI1NjQgMTAwNjQ0Ci0tLSBhL25ldC9pcHY2L2FmX2lu
ZXQ2LmMKKysrIGIvbmV0L2lwdjYvYWZfaW5ldDYuYwpAQCAtODQxLDcgKzg0MSw3IEBAIHN0YXRp
YyBzdHJ1Y3QgcGVybmV0X29wZXJhdGlvbnMgaW5ldDZfbmV0X29wcyA9IHsKIHN0YXRpYyBjb25z
dCBzdHJ1Y3QgaXB2Nl9zdHViIGlwdjZfc3R1Yl9pbXBsID0gewogCS5pcHY2X3NvY2tfbWNfam9p
biA9IGlwdjZfc29ja19tY19qb2luLAogCS5pcHY2X3NvY2tfbWNfZHJvcCA9IGlwdjZfc29ja19t
Y19kcm9wLAotCS5pcHY2X2RzdF9sb29rdXAgPSBpcDZfZHN0X2xvb2t1cCwKKwkuaXB2Nl9kc3Rf
bG9va3VwX2Zsb3cgPSBpcDZfZHN0X2xvb2t1cF9mbG93LAogCS51ZHB2Nl9lbmNhcF9lbmFibGUg
PSB1ZHB2Nl9lbmNhcF9lbmFibGUsCiAJLm5kaXNjX3NlbmRfbmEgPSBuZGlzY19zZW5kX25hLAog
CS5uZF90YmwJPSAmbmRfdGJsLApkaWZmIC0tZ2l0IGEvbmV0L21wbHMvYWZfbXBscy5jIGIvbmV0
L21wbHMvYWZfbXBscy5jCmluZGV4IGMyY2U3ZGVjNTE5OC4uNTBkOTEzOGIyYTFjIDEwMDY0NAot
LS0gYS9uZXQvbXBscy9hZl9tcGxzLmMKKysrIGIvbmV0L21wbHMvYWZfbXBscy5jCkBAIC00NzAs
MTYgKzQ3MCwxNSBAQCBzdGF0aWMgc3RydWN0IG5ldF9kZXZpY2UgKmluZXQ2X2ZpYl9sb29rdXBf
ZGV2KHN0cnVjdCBuZXQgKm5ldCwKIAlzdHJ1Y3QgbmV0X2RldmljZSAqZGV2OwogCXN0cnVjdCBk
c3RfZW50cnkgKmRzdDsKIAlzdHJ1Y3QgZmxvd2k2IGZsNjsKLQlpbnQgZXJyOwogCiAJaWYgKCFp
cHY2X3N0dWIpCiAJCXJldHVybiBFUlJfUFRSKC1FQUZOT1NVUFBPUlQpOwogCiAJbWVtc2V0KCZm
bDYsIDAsIHNpemVvZihmbDYpKTsKIAltZW1jcHkoJmZsNi5kYWRkciwgYWRkciwgc2l6ZW9mKHN0
cnVjdCBpbjZfYWRkcikpOwotCWVyciA9IGlwdjZfc3R1Yi0+aXB2Nl9kc3RfbG9va3VwKG5ldCwg
TlVMTCwgJmRzdCwgJmZsNik7Ci0JaWYgKGVycikKLQkJcmV0dXJuIEVSUl9QVFIoZXJyKTsKKwlk
c3QgPSBpcHY2X3N0dWItPmlwdjZfZHN0X2xvb2t1cF9mbG93KG5ldCwgTlVMTCwgJmZsNiwgTlVM
TCk7CisJaWYgKElTX0VSUihkc3QpKQorCQlyZXR1cm4gRVJSX0NBU1QoZHN0KTsKIAogCWRldiA9
IGRzdC0+ZGV2OwogCWRldl9ob2xkKGRldik7CmRpZmYgLS1naXQgYS9uZXQvdGlwYy91ZHBfbWVk
aWEuYyBiL25ldC90aXBjL3VkcF9tZWRpYS5jCmluZGV4IGNiMzlmMWM0MjUxZS4uYWMyMDc5NDM5
MjQyIDEwMDY0NAotLS0gYS9uZXQvdGlwYy91ZHBfbWVkaWEuYworKysgYi9uZXQvdGlwYy91ZHBf
bWVkaWEuYwpAQCAtMjAwLDEwICsyMDAsMTMgQEAgc3RhdGljIGludCB0aXBjX3VkcF9zZW5kX21z
ZyhzdHJ1Y3QgbmV0ICpuZXQsIHN0cnVjdCBza19idWZmICpza2IsCiAJCQkuc2FkZHIgPSBzcmMt
PmlwdjYsCiAJCQkuZmxvd2k2X3Byb3RvID0gSVBQUk9UT19VRFAKIAkJfTsKLQkJZXJyID0gaXB2
Nl9zdHViLT5pcHY2X2RzdF9sb29rdXAobmV0LCB1Yi0+dWJzb2NrLT5zaywgJm5kc3QsCi0JCQkJ
CQkgJmZsNik7Ci0JCWlmIChlcnIpCisJCW5kc3QgPSBpcHY2X3N0dWItPmlwdjZfZHN0X2xvb2t1
cF9mbG93KG5ldCwKKwkJCQkJCSAgICAgICB1Yi0+dWJzb2NrLT5zaywKKwkJCQkJCSAgICAgICAm
Zmw2LCBOVUxMKTsKKwkJaWYgKElTX0VSUihuZHN0KSkgeworCQkJZXJyID0gUFRSX0VSUihuZHN0
KTsKIAkJCWdvdG8gdHhfZXJyb3I7CisJCX0KIAkJdHRsID0gaXA2X2RzdF9ob3BsaW1pdChuZHN0
KTsKIAkJZXJyID0gdWRwX3R1bm5lbDZfeG1pdF9za2IobmRzdCwgdWItPnVic29jay0+c2ssIHNr
YiwKIAkJCQkJICAgbmRzdC0+ZGV2LCAmc3JjLT5pcHY2LAoKRnJvbSBlMTIzODA3MGI3MzU5ZjMy
MzYwMWRhODdlMWRjYmY3YThhNTE4YzdiIE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBX
YWltYW4gTG9uZyA8bG9uZ21hbkByZWRoYXQuY29tPgpEYXRlOiBXZWQsIDIwIFNlcCAyMDE3IDEz
OjEyOjIwIC0wNjAwClN1YmplY3Q6IGJsa3RyYWNlOiBGaXggcG90ZW50aWFsIGRlYWRsb2NrIGJl
dHdlZW4gZGVsZXRlICYgc3lzZnMgb3BzCgpjb21taXQgNWFjYjNjYzJjMmU5ZDMwMjBhNGZlZTQz
NzYzYzY0NjM3NjdmMTU3MiB1cHN0cmVhbS4KClRoZSBsb2NrZGVwIGNvZGUgaGFkIHJlcG9ydGVk
IHRoZSBmb2xsb3dpbmcgdW5zYWZlIGxvY2tpbmcgc2NlbmFyaW86CgogICAgICAgQ1BVMCAgICAg
ICAgICAgICAgICAgICAgQ1BVMQogICAgICAgLS0tLSAgICAgICAgICAgICAgICAgICAgLS0tLQog
IGxvY2soc19hY3RpdmUjMjI4KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2so
JmJkZXYtPmJkX211dGV4LzEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jayhz
X2FjdGl2ZSMyMjgpOwogIGxvY2soJmJkZXYtPmJkX211dGV4KTsKCiAqKiogREVBRExPQ0sgKioq
CgpUaGUgZGVhZGxvY2sgbWF5IGhhcHBlbiB3aGVuIG9uZSB0YXNrIChDUFUxKSBpcyB0cnlpbmcg
dG8gZGVsZXRlIGEKcGFydGl0aW9uIGluIGEgYmxvY2sgZGV2aWNlIGFuZCBhbm90aGVyIHRhc2sg
KENQVTApIGlzIGFjY2Vzc2luZwp0cmFjaW5nIHN5c2ZzIGZpbGUgKGUuZy4gL3N5cy9ibG9jay9k
bS0xL3RyYWNlL2FjdF9tYXNrKSBpbiB0aGF0CnBhcnRpdGlvbi4KClRoZSBzX2FjdGl2ZSBpc24n
dCBhbiBhY3R1YWwgbG9jay4gSXQgaXMgYSByZWZlcmVuY2UgY291bnQgKGtuLT5jb3VudCkKb24g
dGhlIHN5c2ZzIChrZXJuZnMpIGZpbGUuIFJlbW92YWwgb2YgYSBzeXNmcyBmaWxlLCBob3dldmVy
LCByZXF1aXJlCmEgd2FpdCB1bnRpbCBhbGwgdGhlIHJlZmVyZW5jZXMgYXJlIGdvbmUuIFRoZSBy
ZWZlcmVuY2UgY291bnQgaXMKdHJlYXRlZCBsaWtlIGEgcndzZW0gdXNpbmcgbG9ja2RlcCBpbnN0
cnVtZW50YXRpb24gY29kZS4KClRoZSBmYWN0IHRoYXQgYSB0aHJlYWQgaXMgaW4gdGhlIHN5c2Zz
IGNhbGxiYWNrIG1ldGhvZCBvciBpbiB0aGUKaW9jdGwgY2FsbCBtZWFucyB0aGVyZSBpcyBhIHJl
ZmVyZW5jZSB0byB0aGUgb3BlbmRlZCBzeXNmcyBvciBkZXZpY2UKZmlsZS4gVGhhdCBzaG91bGQg
cHJldmVudCB0aGUgdW5kZXJseWluZyBibG9jayBzdHJ1Y3R1cmUgZnJvbSBiZWluZwpyZW1vdmVk
LgoKSW5zdGVhZCBvZiB1c2luZyBiZF9tdXRleCBpbiB0aGUgYmxvY2tfZGV2aWNlIHN0cnVjdHVy
ZSwgYSBuZXcKYmxrX3RyYWNlX211dGV4IGlzIG5vdyBhZGRlZCB0byB0aGUgcmVxdWVzdF9xdWV1
ZSBzdHJ1Y3R1cmUgdG8gcHJvdGVjdAphY2Nlc3MgdG8gdGhlIGJsa190cmFjZSBzdHJ1Y3R1cmUu
CgpTdWdnZXN0ZWQtYnk6IENocmlzdG9waCBIZWxsd2lnIDxoY2hAaW5mcmFkZWFkLm9yZz4KU2ln
bmVkLW9mZi1ieTogV2FpbWFuIExvbmcgPGxvbmdtYW5AcmVkaGF0LmNvbT4KQWNrZWQtYnk6IFN0
ZXZlbiBSb3N0ZWR0IChWTXdhcmUpIDxyb3N0ZWR0QGdvb2RtaXMub3JnPgoKRml4IHR5cG8gaW4g
cGF0Y2ggc3ViamVjdCBsaW5lLCBhbmQgcHJ1bmUgYSBjb21tZW50IGRldGFpbGluZyBob3cKdGhl
IGNvZGUgdXNlZCB0byB3b3JrLgoKU2lnbmVkLW9mZi1ieTogSmVucyBBeGJvZSA8YXhib2VAa2Vy
bmVsLmRrPgpTaWduZWQtb2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxiZW4uaHV0Y2hpbmdzQGNvZGV0
aGluay5jby51az4KLS0tCiBibG9jay9ibGstY29yZS5jICAgICAgICB8ICAzICsrKwogaW5jbHVk
ZS9saW51eC9ibGtkZXYuaCAgfCAgMSArCiBrZXJuZWwvdHJhY2UvYmxrdHJhY2UuYyB8IDE4ICsr
KysrKysrKysrKy0tLS0tLQogMyBmaWxlcyBjaGFuZ2VkLCAxNiBpbnNlcnRpb25zKCspLCA2IGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2Jsb2NrL2Jsay1jb3JlLmMgYi9ibG9jay9ibGstY29y
ZS5jCmluZGV4IDc2NjJmOTdkZGVkNi4uZGM0MTE5YTFlMTIyIDEwMDY0NAotLS0gYS9ibG9jay9i
bGstY29yZS5jCisrKyBiL2Jsb2NrL2Jsay1jb3JlLmMKQEAgLTcxOSw2ICs3MTksOSBAQCBzdHJ1
Y3QgcmVxdWVzdF9xdWV1ZSAqYmxrX2FsbG9jX3F1ZXVlX25vZGUoZ2ZwX3QgZ2ZwX21hc2ssIGlu
dCBub2RlX2lkKQogCiAJa29iamVjdF9pbml0KCZxLT5rb2JqLCAmYmxrX3F1ZXVlX2t0eXBlKTsK
IAorI2lmZGVmIENPTkZJR19CTEtfREVWX0lPX1RSQUNFCisJbXV0ZXhfaW5pdCgmcS0+YmxrX3Ry
YWNlX211dGV4KTsKKyNlbmRpZgogCW11dGV4X2luaXQoJnEtPnN5c2ZzX2xvY2spOwogCXNwaW5f
bG9ja19pbml0KCZxLT5fX3F1ZXVlX2xvY2spOwogCmRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4
L2Jsa2Rldi5oIGIvaW5jbHVkZS9saW51eC9ibGtkZXYuaAppbmRleCA0YWU1ZDZlY2Q3MjcuLmFi
ODE5MjEwZTAxMSAxMDA2NDQKLS0tIGEvaW5jbHVkZS9saW51eC9ibGtkZXYuaAorKysgYi9pbmNs
dWRlL2xpbnV4L2Jsa2Rldi5oCkBAIC00MzIsNiArNDMyLDcgQEAgc3RydWN0IHJlcXVlc3RfcXVl
dWUgewogCWludAkJCW5vZGU7CiAjaWZkZWYgQ09ORklHX0JMS19ERVZfSU9fVFJBQ0UKIAlzdHJ1
Y3QgYmxrX3RyYWNlCSpibGtfdHJhY2U7CisJc3RydWN0IG11dGV4CQlibGtfdHJhY2VfbXV0ZXg7
CiAjZW5kaWYKIAkvKgogCSAqIGZvciBmbHVzaCBvcGVyYXRpb25zCmRpZmYgLS1naXQgYS9rZXJu
ZWwvdHJhY2UvYmxrdHJhY2UuYyBiL2tlcm5lbC90cmFjZS9ibGt0cmFjZS5jCmluZGV4IDIxMGI4
ZTcyNmE5Ny4uNWU2ZmMyODQxNDAyIDEwMDY0NAotLS0gYS9rZXJuZWwvdHJhY2UvYmxrdHJhY2Uu
YworKysgYi9rZXJuZWwvdHJhY2UvYmxrdHJhY2UuYwpAQCAtNjQ0LDYgKzY0NCwxMiBAQCBpbnQg
YmxrX3RyYWNlX3N0YXJ0c3RvcChzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSwgaW50IHN0YXJ0KQog
fQogRVhQT1JUX1NZTUJPTF9HUEwoYmxrX3RyYWNlX3N0YXJ0c3RvcCk7CiAKKy8qCisgKiBXaGVu
IHJlYWRpbmcgb3Igd3JpdGluZyB0aGUgYmxrdHJhY2Ugc3lzZnMgZmlsZXMsIHRoZSByZWZlcmVu
Y2VzIHRvIHRoZQorICogb3BlbmVkIHN5c2ZzIG9yIGRldmljZSBmaWxlcyBzaG91bGQgcHJldmVu
dCB0aGUgdW5kZXJseWluZyBibG9jayBkZXZpY2UKKyAqIGZyb20gYmVpbmcgcmVtb3ZlZC4gU28g
bm8gZnVydGhlciBkZWxldGUgcHJvdGVjdGlvbiBpcyByZWFsbHkgbmVlZGVkLgorICovCisKIC8q
KgogICogYmxrX3RyYWNlX2lvY3RsOiAtIGhhbmRsZSB0aGUgaW9jdGxzIGFzc29jaWF0ZWQgd2l0
aCB0cmFjaW5nCiAgKiBAYmRldjoJdGhlIGJsb2NrIGRldmljZQpAQCAtNjYxLDcgKzY2Nyw3IEBA
IGludCBibGtfdHJhY2VfaW9jdGwoc3RydWN0IGJsb2NrX2RldmljZSAqYmRldiwgdW5zaWduZWQg
Y21kLCBjaGFyIF9fdXNlciAqYXJnKQogCWlmICghcSkKIAkJcmV0dXJuIC1FTlhJTzsKIAotCW11
dGV4X2xvY2soJmJkZXYtPmJkX211dGV4KTsKKwltdXRleF9sb2NrKCZxLT5ibGtfdHJhY2VfbXV0
ZXgpOwogCiAJc3dpdGNoIChjbWQpIHsKIAljYXNlIEJMS1RSQUNFU0VUVVA6CkBAIC02ODcsNyAr
NjkzLDcgQEAgaW50IGJsa190cmFjZV9pb2N0bChzdHJ1Y3QgYmxvY2tfZGV2aWNlICpiZGV2LCB1
bnNpZ25lZCBjbWQsIGNoYXIgX191c2VyICphcmcpCiAJCWJyZWFrOwogCX0KIAotCW11dGV4X3Vu
bG9jaygmYmRldi0+YmRfbXV0ZXgpOworCW11dGV4X3VubG9jaygmcS0+YmxrX3RyYWNlX211dGV4
KTsKIAlyZXR1cm4gcmV0OwogfQogCkBAIC0xNjUyLDcgKzE2NTgsNyBAQCBzdGF0aWMgc3NpemVf
dCBzeXNmc19ibGtfdHJhY2VfYXR0cl9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKIAlpZiAocSA9
PSBOVUxMKQogCQlnb3RvIG91dF9iZHB1dDsKIAotCW11dGV4X2xvY2soJmJkZXYtPmJkX211dGV4
KTsKKwltdXRleF9sb2NrKCZxLT5ibGtfdHJhY2VfbXV0ZXgpOwogCiAJaWYgKGF0dHIgPT0gJmRl
dl9hdHRyX2VuYWJsZSkgewogCQlyZXQgPSBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCAhIXEtPmJsa190
cmFjZSk7CkBAIC0xNjcxLDcgKzE2NzcsNyBAQCBzdGF0aWMgc3NpemVfdCBzeXNmc19ibGtfdHJh
Y2VfYXR0cl9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKIAkJcmV0ID0gc3ByaW50ZihidWYsICIl
bGx1XG4iLCBxLT5ibGtfdHJhY2UtPmVuZF9sYmEpOwogCiBvdXRfdW5sb2NrX2JkZXY6Ci0JbXV0
ZXhfdW5sb2NrKCZiZGV2LT5iZF9tdXRleCk7CisJbXV0ZXhfdW5sb2NrKCZxLT5ibGtfdHJhY2Vf
bXV0ZXgpOwogb3V0X2JkcHV0OgogCWJkcHV0KGJkZXYpOwogb3V0OgpAQCAtMTcxMyw3ICsxNzE5
LDcgQEAgc3RhdGljIHNzaXplX3Qgc3lzZnNfYmxrX3RyYWNlX2F0dHJfc3RvcmUoc3RydWN0IGRl
dmljZSAqZGV2LAogCWlmIChxID09IE5VTEwpCiAJCWdvdG8gb3V0X2JkcHV0OwogCi0JbXV0ZXhf
bG9jaygmYmRldi0+YmRfbXV0ZXgpOworCW11dGV4X2xvY2soJnEtPmJsa190cmFjZV9tdXRleCk7
CiAKIAlpZiAoYXR0ciA9PSAmZGV2X2F0dHJfZW5hYmxlKSB7CiAJCWlmICghIXZhbHVlID09ICEh
cS0+YmxrX3RyYWNlKSB7CkBAIC0xNzQzLDcgKzE3NDksNyBAQCBzdGF0aWMgc3NpemVfdCBzeXNm
c19ibGtfdHJhY2VfYXR0cl9zdG9yZShzdHJ1Y3QgZGV2aWNlICpkZXYsCiAJfQogCiBvdXRfdW5s
b2NrX2JkZXY6Ci0JbXV0ZXhfdW5sb2NrKCZiZGV2LT5iZF9tdXRleCk7CisJbXV0ZXhfdW5sb2Nr
KCZxLT5ibGtfdHJhY2VfbXV0ZXgpOwogb3V0X2JkcHV0OgogCWJkcHV0KGJkZXYpOwogb3V0OgoK
RnJvbSA5NGEyNGY1YmI2NGJkZTY5YWYzMWNkY2IxNmM1ODU3ZDFiMjA3OWU1IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBKZW5zIEF4Ym9lIDxheGJvZUBrZXJuZWwuZGs+CkRhdGU6IFN1
biwgNSBOb3YgMjAxNyAwOToxMzo0OCAtMDcwMApTdWJqZWN0OiBibGt0cmFjZTogZml4IHVubG9j
a2VkIGFjY2VzcyB0byBpbml0L3N0YXJ0LXN0b3AvdGVhcmRvd24KCmNvbW1pdCAxZjJjYWMxMDdj
NTkxYzI0YjYwYjExNWQ2MDUwYWRjMjEzZDEwZmMwIHVwc3RyZWFtLgoKc2cuYyBjYWxscyBpbnRv
IHRoZSBibGt0cmFjZSBmdW5jdGlvbnMgd2l0aG91dCBob2xkaW5nIHRoZSBwcm9wZXIgcXVldWUK
bXV0ZXggZm9yIGRvaW5nIHNldHVwLCBzdGFydC9zdG9wLCBvciB0ZWFyZG93bi4KCkFkZCBpbnRl
cm5hbCB1bmxvY2tlZCB2YXJpYW50cywgYW5kIGV4cG9ydCB0aGUgb25lcyB0aGF0IGRvIHRoZSBw
cm9wZXIKbG9ja2luZy4KCkZpeGVzOiA2ZGExMjdhZDA5MTggKCJibGt0cmFjZTogQWRkIGJsa3Ry
YWNlIGlvY3RscyB0byBTQ1NJIGdlbmVyaWMgZGV2aWNlcyIpClRlc3RlZC1ieTogRG1pdHJ5IFZ5
dWtvdiA8ZHZ5dWtvdkBnb29nbGUuY29tPgpTaWduZWQtb2ZmLWJ5OiBKZW5zIEF4Ym9lIDxheGJv
ZUBrZXJuZWwuZGs+ClNpZ25lZC1vZmYtYnk6IEJlbiBIdXRjaGluZ3MgPGJlbi5odXRjaGluZ3NA
Y29kZXRoaW5rLmNvLnVrPgotLS0KIGtlcm5lbC90cmFjZS9ibGt0cmFjZS5jIHwgNTggKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA0OCBp
bnNlcnRpb25zKCspLCAxMCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9rZXJuZWwvdHJhY2Uv
YmxrdHJhY2UuYyBiL2tlcm5lbC90cmFjZS9ibGt0cmFjZS5jCmluZGV4IDVlNmZjMjg0MTQwMi4u
ZGM1ZmQyMDQyOWQ4IDEwMDY0NAotLS0gYS9rZXJuZWwvdHJhY2UvYmxrdHJhY2UuYworKysgYi9r
ZXJuZWwvdHJhY2UvYmxrdHJhY2UuYwpAQCAtMzIzLDcgKzMyMyw3IEBAIHN0YXRpYyB2b2lkIGJs
a190cmFjZV9jbGVhbnVwKHN0cnVjdCBibGtfdHJhY2UgKmJ0KQogCXB1dF9wcm9iZV9yZWYoKTsK
IH0KIAotaW50IGJsa190cmFjZV9yZW1vdmUoc3RydWN0IHJlcXVlc3RfcXVldWUgKnEpCitzdGF0
aWMgaW50IF9fYmxrX3RyYWNlX3JlbW92ZShzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSkKIHsKIAlz
dHJ1Y3QgYmxrX3RyYWNlICpidDsKIApAQCAtMzM2LDYgKzMzNiwxNyBAQCBpbnQgYmxrX3RyYWNl
X3JlbW92ZShzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSkKIAogCXJldHVybiAwOwogfQorCitpbnQg
YmxrX3RyYWNlX3JlbW92ZShzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSkKK3sKKwlpbnQgcmV0Owor
CisJbXV0ZXhfbG9jaygmcS0+YmxrX3RyYWNlX211dGV4KTsKKwlyZXQgPSBfX2Jsa190cmFjZV9y
ZW1vdmUocSk7CisJbXV0ZXhfdW5sb2NrKCZxLT5ibGtfdHJhY2VfbXV0ZXgpOworCisJcmV0dXJu
IHJldDsKK30KIEVYUE9SVF9TWU1CT0xfR1BMKGJsa190cmFjZV9yZW1vdmUpOwogCiBzdGF0aWMg
c3NpemVfdCBibGtfZHJvcHBlZF9yZWFkKHN0cnVjdCBmaWxlICpmaWxwLCBjaGFyIF9fdXNlciAq
YnVmZmVyLApAQCAtNTQ2LDkgKzU1Nyw4IEBAIGVycjoKIAlyZXR1cm4gcmV0OwogfQogCi1pbnQg
YmxrX3RyYWNlX3NldHVwKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLCBjaGFyICpuYW1lLCBkZXZf
dCBkZXYsCi0JCSAgICBzdHJ1Y3QgYmxvY2tfZGV2aWNlICpiZGV2LAotCQkgICAgY2hhciBfX3Vz
ZXIgKmFyZykKK3N0YXRpYyBpbnQgX19ibGtfdHJhY2Vfc2V0dXAoc3RydWN0IHJlcXVlc3RfcXVl
dWUgKnEsIGNoYXIgKm5hbWUsIGRldl90IGRldiwKKwkJCSAgICAgc3RydWN0IGJsb2NrX2Rldmlj
ZSAqYmRldiwgY2hhciBfX3VzZXIgKmFyZykKIHsKIAlzdHJ1Y3QgYmxrX3VzZXJfdHJhY2Vfc2V0
dXAgYnV0czsKIAlpbnQgcmV0OwpAQCAtNTY3LDYgKzU3NywxOSBAQCBpbnQgYmxrX3RyYWNlX3Nl
dHVwKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLCBjaGFyICpuYW1lLCBkZXZfdCBkZXYsCiAJfQog
CXJldHVybiAwOwogfQorCitpbnQgYmxrX3RyYWNlX3NldHVwKHN0cnVjdCByZXF1ZXN0X3F1ZXVl
ICpxLCBjaGFyICpuYW1lLCBkZXZfdCBkZXYsCisJCSAgICBzdHJ1Y3QgYmxvY2tfZGV2aWNlICpi
ZGV2LAorCQkgICAgY2hhciBfX3VzZXIgKmFyZykKK3sKKwlpbnQgcmV0OworCisJbXV0ZXhfbG9j
aygmcS0+YmxrX3RyYWNlX211dGV4KTsKKwlyZXQgPSBfX2Jsa190cmFjZV9zZXR1cChxLCBuYW1l
LCBkZXYsIGJkZXYsIGFyZyk7CisJbXV0ZXhfdW5sb2NrKCZxLT5ibGtfdHJhY2VfbXV0ZXgpOwor
CisJcmV0dXJuIHJldDsKK30KIEVYUE9SVF9TWU1CT0xfR1BMKGJsa190cmFjZV9zZXR1cCk7CiAK
ICNpZiBkZWZpbmVkKENPTkZJR19DT01QQVQpICYmIGRlZmluZWQoQ09ORklHX1g4Nl82NCkKQEAg
LTYwMyw3ICs2MjYsNyBAQCBzdGF0aWMgaW50IGNvbXBhdF9ibGtfdHJhY2Vfc2V0dXAoc3RydWN0
IHJlcXVlc3RfcXVldWUgKnEsIGNoYXIgKm5hbWUsCiB9CiAjZW5kaWYKIAotaW50IGJsa190cmFj
ZV9zdGFydHN0b3Aoc3RydWN0IHJlcXVlc3RfcXVldWUgKnEsIGludCBzdGFydCkKK3N0YXRpYyBp
bnQgX19ibGtfdHJhY2Vfc3RhcnRzdG9wKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLCBpbnQgc3Rh
cnQpCiB7CiAJaW50IHJldDsKIAlzdHJ1Y3QgYmxrX3RyYWNlICpidCA9IHEtPmJsa190cmFjZTsK
QEAgLTY0Miw2ICs2NjUsMTcgQEAgaW50IGJsa190cmFjZV9zdGFydHN0b3Aoc3RydWN0IHJlcXVl
c3RfcXVldWUgKnEsIGludCBzdGFydCkKIAogCXJldHVybiByZXQ7CiB9CisKK2ludCBibGtfdHJh
Y2Vfc3RhcnRzdG9wKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLCBpbnQgc3RhcnQpCit7CisJaW50
IHJldDsKKworCW11dGV4X2xvY2soJnEtPmJsa190cmFjZV9tdXRleCk7CisJcmV0ID0gX19ibGtf
dHJhY2Vfc3RhcnRzdG9wKHEsIHN0YXJ0KTsKKwltdXRleF91bmxvY2soJnEtPmJsa190cmFjZV9t
dXRleCk7CisKKwlyZXR1cm4gcmV0OworfQogRVhQT1JUX1NZTUJPTF9HUEwoYmxrX3RyYWNlX3N0
YXJ0c3RvcCk7CiAKIC8qCkBAIC02NzIsNyArNzA2LDcgQEAgaW50IGJsa190cmFjZV9pb2N0bChz
dHJ1Y3QgYmxvY2tfZGV2aWNlICpiZGV2LCB1bnNpZ25lZCBjbWQsIGNoYXIgX191c2VyICphcmcp
CiAJc3dpdGNoIChjbWQpIHsKIAljYXNlIEJMS1RSQUNFU0VUVVA6CiAJCWJkZXZuYW1lKGJkZXYs
IGIpOwotCQlyZXQgPSBibGtfdHJhY2Vfc2V0dXAocSwgYiwgYmRldi0+YmRfZGV2LCBiZGV2LCBh
cmcpOworCQlyZXQgPSBfX2Jsa190cmFjZV9zZXR1cChxLCBiLCBiZGV2LT5iZF9kZXYsIGJkZXYs
IGFyZyk7CiAJCWJyZWFrOwogI2lmIGRlZmluZWQoQ09ORklHX0NPTVBBVCkgJiYgZGVmaW5lZChD
T05GSUdfWDg2XzY0KQogCWNhc2UgQkxLVFJBQ0VTRVRVUDMyOgpAQCAtNjgzLDEwICs3MTcsMTAg
QEAgaW50IGJsa190cmFjZV9pb2N0bChzdHJ1Y3QgYmxvY2tfZGV2aWNlICpiZGV2LCB1bnNpZ25l
ZCBjbWQsIGNoYXIgX191c2VyICphcmcpCiAJY2FzZSBCTEtUUkFDRVNUQVJUOgogCQlzdGFydCA9
IDE7CiAJY2FzZSBCTEtUUkFDRVNUT1A6Ci0JCXJldCA9IGJsa190cmFjZV9zdGFydHN0b3AocSwg
c3RhcnQpOworCQlyZXQgPSBfX2Jsa190cmFjZV9zdGFydHN0b3AocSwgc3RhcnQpOwogCQlicmVh
azsKIAljYXNlIEJMS1RSQUNFVEVBUkRPV046Ci0JCXJldCA9IGJsa190cmFjZV9yZW1vdmUocSk7
CisJCXJldCA9IF9fYmxrX3RyYWNlX3JlbW92ZShxKTsKIAkJYnJlYWs7CiAJZGVmYXVsdDoKIAkJ
cmV0ID0gLUVOT1RUWTsKQEAgLTcwNCwxMCArNzM4LDE0IEBAIGludCBibGtfdHJhY2VfaW9jdGwo
c3RydWN0IGJsb2NrX2RldmljZSAqYmRldiwgdW5zaWduZWQgY21kLCBjaGFyIF9fdXNlciAqYXJn
KQogICoqLwogdm9pZCBibGtfdHJhY2Vfc2h1dGRvd24oc3RydWN0IHJlcXVlc3RfcXVldWUgKnEp
CiB7CisJbXV0ZXhfbG9jaygmcS0+YmxrX3RyYWNlX211dGV4KTsKKwogCWlmIChxLT5ibGtfdHJh
Y2UpIHsKLQkJYmxrX3RyYWNlX3N0YXJ0c3RvcChxLCAwKTsKLQkJYmxrX3RyYWNlX3JlbW92ZShx
KTsKKwkJX19ibGtfdHJhY2Vfc3RhcnRzdG9wKHEsIDApOworCQlfX2Jsa190cmFjZV9yZW1vdmUo
cSk7CiAJfQorCisJbXV0ZXhfdW5sb2NrKCZxLT5ibGtfdHJhY2VfbXV0ZXgpOwogfQogCiAvKgoK
RnJvbSAwMmRhZjFiZTU4NGJiYzAxZGQzZjA2ZDAyNzk3NWI4MWE5OWQ0NzA5IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBKZW5zIEF4Ym9lIDxheGJvZUBrZXJuZWwuZGs+CkRhdGU6IFN1
biwgMTkgTm92IDIwMTcgMTE6NTI6NTUgLTA3MDAKU3ViamVjdDogYmxrdHJhY2U6IGZpeCB0cmFj
ZSBtdXRleCBkZWFkbG9jawoKY29tbWl0IDI5NjdhY2JiMjU3YTZhOWJmOTEyZjQ3NzhiNzI3ZTAw
OTcyZWFjOWIgdXBzdHJlYW0uCgpBIHByZXZpb3VzIGNvbW1pdCBjaGFuZ2VkIHRoZSBsb2NraW5n
IGFyb3VuZCByZWdpc3RyYXRpb24vY2xlYW51cCwKYnV0IGRpcmVjdCBjYWxsZXJzIG9mIGJsa190
cmFjZV9yZW1vdmUoKSB3ZXJlIG1pc3NlZC4gVGhpcyBtZWFucwp0aGF0IGlmIHdlIGhpdCB0aGUg
ZXJyb3IgcGF0aCBpbiBzZXR1cCwgd2Ugd2lsbCBkZWFkbG9jayBvbgphdHRlbXB0aW5nIHRvIHJl
LWFjcXVpcmUgdGhlIHF1ZXVlIHRyYWNlIG11dGV4LgoKRml4ZXM6IDFmMmNhYzEwN2M1OSAoImJs
a3RyYWNlOiBmaXggdW5sb2NrZWQgYWNjZXNzIHRvIGluaXQvc3RhcnQtc3RvcC90ZWFyZG93biIp
ClNpZ25lZC1vZmYtYnk6IEplbnMgQXhib2UgPGF4Ym9lQGtlcm5lbC5kaz4KU2lnbmVkLW9mZi1i
eTogQmVuIEh1dGNoaW5ncyA8YmVuLmh1dGNoaW5nc0Bjb2RldGhpbmsuY28udWs+Ci0tLQoga2Vy
bmVsL3RyYWNlL2Jsa3RyYWNlLmMgfCA0ICsrLS0KIDEgZmlsZSBjaGFuZ2VkLCAyIGluc2VydGlv
bnMoKyksIDIgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEva2VybmVsL3RyYWNlL2Jsa3RyYWNl
LmMgYi9rZXJuZWwvdHJhY2UvYmxrdHJhY2UuYwppbmRleCBkYzVmZDIwNDI5ZDguLmVhMThjNjk5
N2ViMiAxMDA2NDQKLS0tIGEva2VybmVsL3RyYWNlL2Jsa3RyYWNlLmMKKysrIGIva2VybmVsL3Ry
YWNlL2Jsa3RyYWNlLmMKQEAgLTU3Miw3ICs1NzIsNyBAQCBzdGF0aWMgaW50IF9fYmxrX3RyYWNl
X3NldHVwKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLCBjaGFyICpuYW1lLCBkZXZfdCBkZXYsCiAJ
CXJldHVybiByZXQ7CiAKIAlpZiAoY29weV90b191c2VyKGFyZywgJmJ1dHMsIHNpemVvZihidXRz
KSkpIHsKLQkJYmxrX3RyYWNlX3JlbW92ZShxKTsKKwkJX19ibGtfdHJhY2VfcmVtb3ZlKHEpOwog
CQlyZXR1cm4gLUVGQVVMVDsKIAl9CiAJcmV0dXJuIDA7CkBAIC02MTgsNyArNjE4LDcgQEAgc3Rh
dGljIGludCBjb21wYXRfYmxrX3RyYWNlX3NldHVwKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLCBj
aGFyICpuYW1lLAogCQlyZXR1cm4gcmV0OwogCiAJaWYgKGNvcHlfdG9fdXNlcihhcmcsICZidXRz
Lm5hbWUsIEFSUkFZX1NJWkUoYnV0cy5uYW1lKSkpIHsKLQkJYmxrX3RyYWNlX3JlbW92ZShxKTsK
KwkJX19ibGtfdHJhY2VfcmVtb3ZlKHEpOwogCQlyZXR1cm4gLUVGQVVMVDsKIAl9CiAKCkZyb20g
MjJhMDM1OWE4NDlkZTM1MmNkYzk2YjhkZWRkOTQ2ZDRkMGE4NDNiYSBNb24gU2VwIDE3IDAwOjAw
OjAwIDIwMDEKRnJvbTogSmFuIEthcmEgPGphY2tAc3VzZS5jej4KRGF0ZTogVGh1LCA2IEZlYiAy
MDIwIDE1OjI4OjEyICswMTAwClN1YmplY3Q6IGJsa3RyYWNlOiBQcm90ZWN0IHEtPmJsa190cmFj
ZSB3aXRoIFJDVQoKY29tbWl0IGM3ODBlODZkZDQ4ZWY2NDY3YTExNDZjZjdkMGZlMWUwNWE2MzUw
MzkgdXBzdHJlYW0uCgpLQVNBTiBpcyByZXBvcnRpbmcgdGhhdCBfX2Jsa19hZGRfdHJhY2UoKSBo
YXMgYSB1c2UtYWZ0ZXItZnJlZSBpc3N1ZQp3aGVuIGFjY2Vzc2luZyBxLT5ibGtfdHJhY2UuIElu
ZGVlZCB0aGUgc3dpdGNoaW5nIG9mIGJsb2NrIHRyYWNpbmcgKGFuZAp0aHVzIGV2ZW50dWFsIGZy
ZWVpbmcgb2YgcS0+YmxrX3RyYWNlKSBpcyBjb21wbGV0ZWx5IHVuc3luY2hyb25pemVkIHdpdGgK
dGhlIGN1cnJlbnRseSBydW5uaW5nIHRyYWNpbmcgYW5kIHRodXMgaXQgY2FuIGhhcHBlbiB0aGF0
IHRoZSBibGtfdHJhY2UKc3RydWN0dXJlIGlzIGJlaW5nIGZyZWVkIGp1c3Qgd2hpbGUgX19ibGtf
YWRkX3RyYWNlKCkgd29ya3Mgb24gaXQuClByb3RlY3QgYWNjZXNzZXMgdG8gcS0+YmxrX3RyYWNl
IGJ5IFJDVSBkdXJpbmcgdHJhY2luZyBhbmQgbWFrZSBzdXJlIHdlCndhaXQgZm9yIHRoZSBlbmQg
b2YgUkNVIGdyYWNlIHBlcmlvZCB3aGVuIHNodXR0aW5nIGRvd24gdHJhY2luZy4gTHVja2lseQp0
aGF0IGlzIHJhcmUgZW5vdWdoIGV2ZW50IHRoYXQgd2UgY2FuIGFmZm9yZCB0aGF0LiBOb3RlIHRo
YXQgcG9zdHBvbmluZwp0aGUgZnJlZWluZyBvZiBibGtfdHJhY2UgdG8gYW4gUkNVIGNhbGxiYWNr
IHNob3VsZCBiZXR0ZXIgYmUgYXZvaWRlZCBhcwppdCBjb3VsZCBoYXZlIHVuZXhwZWN0ZWQgdXNl
ciB2aXNpYmxlIHNpZGUtZWZmZWN0cyBhcyBkZWJ1Z2ZzIGZpbGVzCndvdWxkIGJlIHN0aWxsIGV4
aXN0aW5nIGZvciBhIHNob3J0IHdoaWxlIGJsb2NrIHRyYWNpbmcgaGFzIGJlZW4gc2h1dApkb3du
LgoKTGluazogaHR0cHM6Ly9idWd6aWxsYS5rZXJuZWwub3JnL3Nob3dfYnVnLmNnaT9pZD0yMDU3
MTEKQ0M6IHN0YWJsZUB2Z2VyLmtlcm5lbC5vcmcKUmV2aWV3ZWQtYnk6IENoYWl0YW55YSBLdWxr
YXJuaSA8Y2hhaXRhbnlhLmt1bGthcm5pQHdkYy5jb20+ClJldmlld2VkLWJ5OiBNaW5nIExlaSA8
bWluZy5sZWlAcmVkaGF0LmNvbT4KVGVzdGVkLWJ5OiBNaW5nIExlaSA8bWluZy5sZWlAcmVkaGF0
LmNvbT4KUmV2aWV3ZWQtYnk6IEJhcnQgVmFuIEFzc2NoZSA8YnZhbmFzc2NoZUBhY20ub3JnPgpS
ZXBvcnRlZC1ieTogVHJpc3RhbiBNYWRhbmkgPHRyaXN0bWRAZ21haWwuY29tPgpTaWduZWQtb2Zm
LWJ5OiBKYW4gS2FyYSA8amFja0BzdXNlLmN6PgpTaWduZWQtb2ZmLWJ5OiBKZW5zIEF4Ym9lIDxh
eGJvZUBrZXJuZWwuZGs+Cltid2g6IEJhY2twb3J0ZWQgdG8gNC40OgogLSBEcm9wIGNoYW5nZXMg
aW4gYmxrX3RyYWNlX25vdGVfbWVzc2FnZV9lbmFibGVkKCksIGJsa190cmFjZV9iaW9fZ2V0X2Nn
aWQoKQogLSBBZGp1c3QgY29udGV4dF0KU2lnbmVkLW9mZi1ieTogQmVuIEh1dGNoaW5ncyA8YmVu
Lmh1dGNoaW5nc0Bjb2RldGhpbmsuY28udWs+Ci0tLQogaW5jbHVkZS9saW51eC9ibGtkZXYuaCAg
ICAgICB8ICAgMiArLQogaW5jbHVkZS9saW51eC9ibGt0cmFjZV9hcGkuaCB8ICAgNiArLQoga2Vy
bmVsL3RyYWNlL2Jsa3RyYWNlLmMgICAgICB8IDExMCArKysrKysrKysrKysrKysrKysrKysrKysr
LS0tLS0tLS0tLQogMyBmaWxlcyBjaGFuZ2VkLCA4NiBpbnNlcnRpb25zKCspLCAzMiBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2Jsa2Rldi5oIGIvaW5jbHVkZS9saW51
eC9ibGtkZXYuaAppbmRleCBhYjgxOTIxMGUwMTEuLjZlODNlYTYxNDM2YSAxMDA2NDQKLS0tIGEv
aW5jbHVkZS9saW51eC9ibGtkZXYuaAorKysgYi9pbmNsdWRlL2xpbnV4L2Jsa2Rldi5oCkBAIC00
MzEsNyArNDMxLDcgQEAgc3RydWN0IHJlcXVlc3RfcXVldWUgewogCXVuc2lnbmVkIGludAkJc2df
cmVzZXJ2ZWRfc2l6ZTsKIAlpbnQJCQlub2RlOwogI2lmZGVmIENPTkZJR19CTEtfREVWX0lPX1RS
QUNFCi0Jc3RydWN0IGJsa190cmFjZQkqYmxrX3RyYWNlOworCXN0cnVjdCBibGtfdHJhY2UgX19y
Y3UJKmJsa190cmFjZTsKIAlzdHJ1Y3QgbXV0ZXgJCWJsa190cmFjZV9tdXRleDsKICNlbmRpZgog
CS8qCmRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2Jsa3RyYWNlX2FwaS5oIGIvaW5jbHVkZS9s
aW51eC9ibGt0cmFjZV9hcGkuaAppbmRleCBhZmMxMzQzZGYzYzcuLmU2NDRiZmU1MDAxOSAxMDA2
NDQKLS0tIGEvaW5jbHVkZS9saW51eC9ibGt0cmFjZV9hcGkuaAorKysgYi9pbmNsdWRlL2xpbnV4
L2Jsa3RyYWNlX2FwaS5oCkBAIC01MSw5ICs1MSwxMyBAQCB2b2lkIF9fdHJhY2Vfbm90ZV9tZXNz
YWdlKHN0cnVjdCBibGtfdHJhY2UgKiwgY29uc3QgY2hhciAqZm10LCAuLi4pOwogICoqLwogI2Rl
ZmluZSBibGtfYWRkX3RyYWNlX21zZyhxLCBmbXQsIC4uLikJCQkJCVwKIAlkbyB7CQkJCQkJCQlc
Ci0JCXN0cnVjdCBibGtfdHJhY2UgKmJ0ID0gKHEpLT5ibGtfdHJhY2U7CQkJXAorCQlzdHJ1Y3Qg
YmxrX3RyYWNlICpidDsJCQkJCVwKKwkJCQkJCQkJCVwKKwkJcmN1X3JlYWRfbG9jaygpOwkJCQkJ
XAorCQlidCA9IHJjdV9kZXJlZmVyZW5jZSgocSktPmJsa190cmFjZSk7CQkJXAogCQlpZiAodW5s
aWtlbHkoYnQpKQkJCQkJXAogCQkJX190cmFjZV9ub3RlX21lc3NhZ2UoYnQsIGZtdCwgIyNfX1ZB
X0FSR1NfXyk7CVwKKwkJcmN1X3JlYWRfdW5sb2NrKCk7CQkJCQlcCiAJfSB3aGlsZSAoMCkKICNk
ZWZpbmUgQkxLX1ROX01BWF9NU0cJCTEyOAogCmRpZmYgLS1naXQgYS9rZXJuZWwvdHJhY2UvYmxr
dHJhY2UuYyBiL2tlcm5lbC90cmFjZS9ibGt0cmFjZS5jCmluZGV4IGVhMThjNjk5N2ViMi4uYmY5
YmYzZjIyZWRiIDEwMDY0NAotLS0gYS9rZXJuZWwvdHJhY2UvYmxrdHJhY2UuYworKysgYi9rZXJu
ZWwvdHJhY2UvYmxrdHJhY2UuYwpAQCAtMzE5LDYgKzMxOSw3IEBAIHN0YXRpYyB2b2lkIHB1dF9w
cm9iZV9yZWYodm9pZCkKIAogc3RhdGljIHZvaWQgYmxrX3RyYWNlX2NsZWFudXAoc3RydWN0IGJs
a190cmFjZSAqYnQpCiB7CisJc3luY2hyb25pemVfcmN1KCk7CiAJYmxrX3RyYWNlX2ZyZWUoYnQp
OwogCXB1dF9wcm9iZV9yZWYoKTsKIH0KQEAgLTYyOSw4ICs2MzAsMTAgQEAgc3RhdGljIGludCBj
b21wYXRfYmxrX3RyYWNlX3NldHVwKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLCBjaGFyICpuYW1l
LAogc3RhdGljIGludCBfX2Jsa190cmFjZV9zdGFydHN0b3Aoc3RydWN0IHJlcXVlc3RfcXVldWUg
KnEsIGludCBzdGFydCkKIHsKIAlpbnQgcmV0OwotCXN0cnVjdCBibGtfdHJhY2UgKmJ0ID0gcS0+
YmxrX3RyYWNlOworCXN0cnVjdCBibGtfdHJhY2UgKmJ0OwogCisJYnQgPSByY3VfZGVyZWZlcmVu
Y2VfcHJvdGVjdGVkKHEtPmJsa190cmFjZSwKKwkJCQkgICAgICAgbG9ja2RlcF9pc19oZWxkKCZx
LT5ibGtfdHJhY2VfbXV0ZXgpKTsKIAlpZiAoYnQgPT0gTlVMTCkKIAkJcmV0dXJuIC1FSU5WQUw7
CiAKQEAgLTczOSw4ICs3NDIsOCBAQCBpbnQgYmxrX3RyYWNlX2lvY3RsKHN0cnVjdCBibG9ja19k
ZXZpY2UgKmJkZXYsIHVuc2lnbmVkIGNtZCwgY2hhciBfX3VzZXIgKmFyZykKIHZvaWQgYmxrX3Ry
YWNlX3NodXRkb3duKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxKQogewogCW11dGV4X2xvY2soJnEt
PmJsa190cmFjZV9tdXRleCk7Ci0KLQlpZiAocS0+YmxrX3RyYWNlKSB7CisJaWYgKHJjdV9kZXJl
ZmVyZW5jZV9wcm90ZWN0ZWQocS0+YmxrX3RyYWNlLAorCQkJCSAgICAgIGxvY2tkZXBfaXNfaGVs
ZCgmcS0+YmxrX3RyYWNlX211dGV4KSkpIHsKIAkJX19ibGtfdHJhY2Vfc3RhcnRzdG9wKHEsIDAp
OwogCQlfX2Jsa190cmFjZV9yZW1vdmUocSk7CiAJfQpAQCAtNzY2LDEwICs3NjksMTQgQEAgdm9p
ZCBibGtfdHJhY2Vfc2h1dGRvd24oc3RydWN0IHJlcXVlc3RfcXVldWUgKnEpCiBzdGF0aWMgdm9p
ZCBibGtfYWRkX3RyYWNlX3JxKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLCBzdHJ1Y3QgcmVxdWVz
dCAqcnEsCiAJCQkgICAgIHVuc2lnbmVkIGludCBucl9ieXRlcywgdTMyIHdoYXQpCiB7Ci0Jc3Ry
dWN0IGJsa190cmFjZSAqYnQgPSBxLT5ibGtfdHJhY2U7CisJc3RydWN0IGJsa190cmFjZSAqYnQ7
CiAKLQlpZiAobGlrZWx5KCFidCkpCisJcmN1X3JlYWRfbG9jaygpOworCWJ0ID0gcmN1X2RlcmVm
ZXJlbmNlKHEtPmJsa190cmFjZSk7CisJaWYgKGxpa2VseSghYnQpKSB7CisJCXJjdV9yZWFkX3Vu
bG9jaygpOwogCQlyZXR1cm47CisJfQogCiAJaWYgKHJxLT5jbWRfdHlwZSA9PSBSRVFfVFlQRV9C
TE9DS19QQykgewogCQl3aGF0IHw9IEJMS19UQ19BQ1QoQkxLX1RDX1BDKTsKQEAgLTc4MCw2ICs3
ODcsNyBAQCBzdGF0aWMgdm9pZCBibGtfYWRkX3RyYWNlX3JxKHN0cnVjdCByZXF1ZXN0X3F1ZXVl
ICpxLCBzdHJ1Y3QgcmVxdWVzdCAqcnEsCiAJCV9fYmxrX2FkZF90cmFjZShidCwgYmxrX3JxX3Bv
cyhycSksIG5yX2J5dGVzLAogCQkJCXJxLT5jbWRfZmxhZ3MsIHdoYXQsIHJxLT5lcnJvcnMsIDAs
IE5VTEwpOwogCX0KKwlyY3VfcmVhZF91bmxvY2soKTsKIH0KIAogc3RhdGljIHZvaWQgYmxrX2Fk
ZF90cmFjZV9ycV9hYm9ydCh2b2lkICppZ25vcmUsCkBAIC04MjksMTMgKzgzNywxOCBAQCBzdGF0
aWMgdm9pZCBibGtfYWRkX3RyYWNlX3JxX2NvbXBsZXRlKHZvaWQgKmlnbm9yZSwKIHN0YXRpYyB2
b2lkIGJsa19hZGRfdHJhY2VfYmlvKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLCBzdHJ1Y3QgYmlv
ICpiaW8sCiAJCQkgICAgICB1MzIgd2hhdCwgaW50IGVycm9yKQogewotCXN0cnVjdCBibGtfdHJh
Y2UgKmJ0ID0gcS0+YmxrX3RyYWNlOworCXN0cnVjdCBibGtfdHJhY2UgKmJ0OwogCi0JaWYgKGxp
a2VseSghYnQpKQorCXJjdV9yZWFkX2xvY2soKTsKKwlidCA9IHJjdV9kZXJlZmVyZW5jZShxLT5i
bGtfdHJhY2UpOworCWlmIChsaWtlbHkoIWJ0KSkgeworCQlyY3VfcmVhZF91bmxvY2soKTsKIAkJ
cmV0dXJuOworCX0KIAogCV9fYmxrX2FkZF90cmFjZShidCwgYmlvLT5iaV9pdGVyLmJpX3NlY3Rv
ciwgYmlvLT5iaV9pdGVyLmJpX3NpemUsCiAJCQliaW8tPmJpX3J3LCB3aGF0LCBlcnJvciwgMCwg
TlVMTCk7CisJcmN1X3JlYWRfdW5sb2NrKCk7CiB9CiAKIHN0YXRpYyB2b2lkIGJsa19hZGRfdHJh
Y2VfYmlvX2JvdW5jZSh2b2lkICppZ25vcmUsCkBAIC04ODAsMTAgKzg5MywxMyBAQCBzdGF0aWMg
dm9pZCBibGtfYWRkX3RyYWNlX2dldHJxKHZvaWQgKmlnbm9yZSwKIAlpZiAoYmlvKQogCQlibGtf
YWRkX3RyYWNlX2JpbyhxLCBiaW8sIEJMS19UQV9HRVRSUSwgMCk7CiAJZWxzZSB7Ci0JCXN0cnVj
dCBibGtfdHJhY2UgKmJ0ID0gcS0+YmxrX3RyYWNlOworCQlzdHJ1Y3QgYmxrX3RyYWNlICpidDsK
IAorCQlyY3VfcmVhZF9sb2NrKCk7CisJCWJ0ID0gcmN1X2RlcmVmZXJlbmNlKHEtPmJsa190cmFj
ZSk7CiAJCWlmIChidCkKIAkJCV9fYmxrX2FkZF90cmFjZShidCwgMCwgMCwgcncsIEJMS19UQV9H
RVRSUSwgMCwgMCwgTlVMTCk7CisJCXJjdV9yZWFkX3VubG9jaygpOwogCX0KIH0KIApAQCAtODk1
LDI3ICs5MTEsMzUgQEAgc3RhdGljIHZvaWQgYmxrX2FkZF90cmFjZV9zbGVlcHJxKHZvaWQgKmln
bm9yZSwKIAlpZiAoYmlvKQogCQlibGtfYWRkX3RyYWNlX2JpbyhxLCBiaW8sIEJMS19UQV9TTEVF
UFJRLCAwKTsKIAllbHNlIHsKLQkJc3RydWN0IGJsa190cmFjZSAqYnQgPSBxLT5ibGtfdHJhY2U7
CisJCXN0cnVjdCBibGtfdHJhY2UgKmJ0OwogCisJCXJjdV9yZWFkX2xvY2soKTsKKwkJYnQgPSBy
Y3VfZGVyZWZlcmVuY2UocS0+YmxrX3RyYWNlKTsKIAkJaWYgKGJ0KQogCQkJX19ibGtfYWRkX3Ry
YWNlKGJ0LCAwLCAwLCBydywgQkxLX1RBX1NMRUVQUlEsCiAJCQkJCTAsIDAsIE5VTEwpOworCQly
Y3VfcmVhZF91bmxvY2soKTsKIAl9CiB9CiAKIHN0YXRpYyB2b2lkIGJsa19hZGRfdHJhY2VfcGx1
Zyh2b2lkICppZ25vcmUsIHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxKQogewotCXN0cnVjdCBibGtf
dHJhY2UgKmJ0ID0gcS0+YmxrX3RyYWNlOworCXN0cnVjdCBibGtfdHJhY2UgKmJ0OwogCisJcmN1
X3JlYWRfbG9jaygpOworCWJ0ID0gcmN1X2RlcmVmZXJlbmNlKHEtPmJsa190cmFjZSk7CiAJaWYg
KGJ0KQogCQlfX2Jsa19hZGRfdHJhY2UoYnQsIDAsIDAsIDAsIEJMS19UQV9QTFVHLCAwLCAwLCBO
VUxMKTsKKwlyY3VfcmVhZF91bmxvY2soKTsKIH0KIAogc3RhdGljIHZvaWQgYmxrX2FkZF90cmFj
ZV91bnBsdWcodm9pZCAqaWdub3JlLCBzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSwKIAkJCQkgICAg
dW5zaWduZWQgaW50IGRlcHRoLCBib29sIGV4cGxpY2l0KQogewotCXN0cnVjdCBibGtfdHJhY2Ug
KmJ0ID0gcS0+YmxrX3RyYWNlOworCXN0cnVjdCBibGtfdHJhY2UgKmJ0OwogCisJcmN1X3JlYWRf
bG9jaygpOworCWJ0ID0gcmN1X2RlcmVmZXJlbmNlKHEtPmJsa190cmFjZSk7CiAJaWYgKGJ0KSB7
CiAJCV9fYmU2NCBycGR1ID0gY3B1X3RvX2JlNjQoZGVwdGgpOwogCQl1MzIgd2hhdDsKQEAgLTky
NywxNCArOTUxLDE3IEBAIHN0YXRpYyB2b2lkIGJsa19hZGRfdHJhY2VfdW5wbHVnKHZvaWQgKmln
bm9yZSwgc3RydWN0IHJlcXVlc3RfcXVldWUgKnEsCiAKIAkJX19ibGtfYWRkX3RyYWNlKGJ0LCAw
LCAwLCAwLCB3aGF0LCAwLCBzaXplb2YocnBkdSksICZycGR1KTsKIAl9CisJcmN1X3JlYWRfdW5s
b2NrKCk7CiB9CiAKIHN0YXRpYyB2b2lkIGJsa19hZGRfdHJhY2Vfc3BsaXQodm9pZCAqaWdub3Jl
LAogCQkJCXN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLCBzdHJ1Y3QgYmlvICpiaW8sCiAJCQkJdW5z
aWduZWQgaW50IHBkdSkKIHsKLQlzdHJ1Y3QgYmxrX3RyYWNlICpidCA9IHEtPmJsa190cmFjZTsK
KwlzdHJ1Y3QgYmxrX3RyYWNlICpidDsKIAorCXJjdV9yZWFkX2xvY2soKTsKKwlidCA9IHJjdV9k
ZXJlZmVyZW5jZShxLT5ibGtfdHJhY2UpOwogCWlmIChidCkgewogCQlfX2JlNjQgcnBkdSA9IGNw
dV90b19iZTY0KHBkdSk7CiAKQEAgLTk0Miw2ICs5NjksNyBAQCBzdGF0aWMgdm9pZCBibGtfYWRk
X3RyYWNlX3NwbGl0KHZvaWQgKmlnbm9yZSwKIAkJCQliaW8tPmJpX2l0ZXIuYmlfc2l6ZSwgYmlv
LT5iaV9ydywgQkxLX1RBX1NQTElULAogCQkJCWJpby0+YmlfZXJyb3IsIHNpemVvZihycGR1KSwg
JnJwZHUpOwogCX0KKwlyY3VfcmVhZF91bmxvY2soKTsKIH0KIAogLyoqCkBAIC05NjEsMTEgKzk4
OSwxNSBAQCBzdGF0aWMgdm9pZCBibGtfYWRkX3RyYWNlX2Jpb19yZW1hcCh2b2lkICppZ25vcmUs
CiAJCQkJICAgIHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLCBzdHJ1Y3QgYmlvICpiaW8sCiAJCQkJ
ICAgIGRldl90IGRldiwgc2VjdG9yX3QgZnJvbSkKIHsKLQlzdHJ1Y3QgYmxrX3RyYWNlICpidCA9
IHEtPmJsa190cmFjZTsKKwlzdHJ1Y3QgYmxrX3RyYWNlICpidDsKIAlzdHJ1Y3QgYmxrX2lvX3Ry
YWNlX3JlbWFwIHI7CiAKLQlpZiAobGlrZWx5KCFidCkpCisJcmN1X3JlYWRfbG9jaygpOworCWJ0
ID0gcmN1X2RlcmVmZXJlbmNlKHEtPmJsa190cmFjZSk7CisJaWYgKGxpa2VseSghYnQpKSB7CisJ
CXJjdV9yZWFkX3VubG9jaygpOwogCQlyZXR1cm47CisJfQogCiAJci5kZXZpY2VfZnJvbSA9IGNw
dV90b19iZTMyKGRldik7CiAJci5kZXZpY2VfdG8gICA9IGNwdV90b19iZTMyKGJpby0+YmlfYmRl
di0+YmRfZGV2KTsKQEAgLTk3NCw2ICsxMDA2LDcgQEAgc3RhdGljIHZvaWQgYmxrX2FkZF90cmFj
ZV9iaW9fcmVtYXAodm9pZCAqaWdub3JlLAogCV9fYmxrX2FkZF90cmFjZShidCwgYmlvLT5iaV9p
dGVyLmJpX3NlY3RvciwgYmlvLT5iaV9pdGVyLmJpX3NpemUsCiAJCQliaW8tPmJpX3J3LCBCTEtf
VEFfUkVNQVAsIGJpby0+YmlfZXJyb3IsCiAJCQlzaXplb2YociksICZyKTsKKwlyY3VfcmVhZF91
bmxvY2soKTsKIH0KIAogLyoqCkBAIC05OTQsMTEgKzEwMjcsMTUgQEAgc3RhdGljIHZvaWQgYmxr
X2FkZF90cmFjZV9ycV9yZW1hcCh2b2lkICppZ25vcmUsCiAJCQkJICAgc3RydWN0IHJlcXVlc3Qg
KnJxLCBkZXZfdCBkZXYsCiAJCQkJICAgc2VjdG9yX3QgZnJvbSkKIHsKLQlzdHJ1Y3QgYmxrX3Ry
YWNlICpidCA9IHEtPmJsa190cmFjZTsKKwlzdHJ1Y3QgYmxrX3RyYWNlICpidDsKIAlzdHJ1Y3Qg
YmxrX2lvX3RyYWNlX3JlbWFwIHI7CiAKLQlpZiAobGlrZWx5KCFidCkpCisJcmN1X3JlYWRfbG9j
aygpOworCWJ0ID0gcmN1X2RlcmVmZXJlbmNlKHEtPmJsa190cmFjZSk7CisJaWYgKGxpa2VseSgh
YnQpKSB7CisJCXJjdV9yZWFkX3VubG9jaygpOwogCQlyZXR1cm47CisJfQogCiAJci5kZXZpY2Vf
ZnJvbSA9IGNwdV90b19iZTMyKGRldik7CiAJci5kZXZpY2VfdG8gICA9IGNwdV90b19iZTMyKGRp
c2tfZGV2dChycS0+cnFfZGlzaykpOwpAQCAtMTAwNyw2ICsxMDQ0LDcgQEAgc3RhdGljIHZvaWQg
YmxrX2FkZF90cmFjZV9ycV9yZW1hcCh2b2lkICppZ25vcmUsCiAJX19ibGtfYWRkX3RyYWNlKGJ0
LCBibGtfcnFfcG9zKHJxKSwgYmxrX3JxX2J5dGVzKHJxKSwKIAkJCXJxX2RhdGFfZGlyKHJxKSwg
QkxLX1RBX1JFTUFQLCAhIXJxLT5lcnJvcnMsCiAJCQlzaXplb2YociksICZyKTsKKwlyY3VfcmVh
ZF91bmxvY2soKTsKIH0KIAogLyoqCkBAIC0xMDI0LDEwICsxMDYyLDE0IEBAIHZvaWQgYmxrX2Fk
ZF9kcml2ZXJfZGF0YShzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSwKIAkJCSBzdHJ1Y3QgcmVxdWVz
dCAqcnEsCiAJCQkgdm9pZCAqZGF0YSwgc2l6ZV90IGxlbikKIHsKLQlzdHJ1Y3QgYmxrX3RyYWNl
ICpidCA9IHEtPmJsa190cmFjZTsKKwlzdHJ1Y3QgYmxrX3RyYWNlICpidDsKIAotCWlmIChsaWtl
bHkoIWJ0KSkKKwlyY3VfcmVhZF9sb2NrKCk7CisJYnQgPSByY3VfZGVyZWZlcmVuY2UocS0+Ymxr
X3RyYWNlKTsKKwlpZiAobGlrZWx5KCFidCkpIHsKKwkJcmN1X3JlYWRfdW5sb2NrKCk7CiAJCXJl
dHVybjsKKwl9CiAKIAlpZiAocnEtPmNtZF90eXBlID09IFJFUV9UWVBFX0JMT0NLX1BDKQogCQlf
X2Jsa19hZGRfdHJhY2UoYnQsIDAsIGJsa19ycV9ieXRlcyhycSksIDAsCkBAIC0xMDM1LDYgKzEw
NzcsNyBAQCB2b2lkIGJsa19hZGRfZHJpdmVyX2RhdGEoc3RydWN0IHJlcXVlc3RfcXVldWUgKnEs
CiAJZWxzZQogCQlfX2Jsa19hZGRfdHJhY2UoYnQsIGJsa19ycV9wb3MocnEpLCBibGtfcnFfYnl0
ZXMocnEpLCAwLAogCQkJCUJMS19UQV9EUlZfREFUQSwgcnEtPmVycm9ycywgbGVuLCBkYXRhKTsK
KwlyY3VfcmVhZF91bmxvY2soKTsKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKGJsa19hZGRfZHJpdmVy
X2RhdGEpOwogCkBAIC0xNTI2LDYgKzE1NjksNyBAQCBzdGF0aWMgaW50IGJsa190cmFjZV9yZW1v
dmVfcXVldWUoc3RydWN0IHJlcXVlc3RfcXVldWUgKnEpCiAJCXJldHVybiAtRUlOVkFMOwogCiAJ
cHV0X3Byb2JlX3JlZigpOworCXN5bmNocm9uaXplX3JjdSgpOwogCWJsa190cmFjZV9mcmVlKGJ0
KTsKIAlyZXR1cm4gMDsKIH0KQEAgLTE2ODYsNiArMTczMCw3IEBAIHN0YXRpYyBzc2l6ZV90IHN5
c2ZzX2Jsa190cmFjZV9hdHRyX3Nob3coc3RydWN0IGRldmljZSAqZGV2LAogCXN0cnVjdCBoZF9z
dHJ1Y3QgKnAgPSBkZXZfdG9fcGFydChkZXYpOwogCXN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxOwog
CXN0cnVjdCBibG9ja19kZXZpY2UgKmJkZXY7CisJc3RydWN0IGJsa190cmFjZSAqYnQ7CiAJc3Np
emVfdCByZXQgPSAtRU5YSU87CiAKIAliZGV2ID0gYmRnZXQocGFydF9kZXZ0KHApKTsKQEAgLTE2
OTgsMjEgKzE3NDMsMjMgQEAgc3RhdGljIHNzaXplX3Qgc3lzZnNfYmxrX3RyYWNlX2F0dHJfc2hv
dyhzdHJ1Y3QgZGV2aWNlICpkZXYsCiAKIAltdXRleF9sb2NrKCZxLT5ibGtfdHJhY2VfbXV0ZXgp
OwogCisJYnQgPSByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKHEtPmJsa190cmFjZSwKKwkJCQkg
ICAgICAgbG9ja2RlcF9pc19oZWxkKCZxLT5ibGtfdHJhY2VfbXV0ZXgpKTsKIAlpZiAoYXR0ciA9
PSAmZGV2X2F0dHJfZW5hYmxlKSB7Ci0JCXJldCA9IHNwcmludGYoYnVmLCAiJXVcbiIsICEhcS0+
YmxrX3RyYWNlKTsKKwkJcmV0ID0gc3ByaW50ZihidWYsICIldVxuIiwgISFidCk7CiAJCWdvdG8g
b3V0X3VubG9ja19iZGV2OwogCX0KIAotCWlmIChxLT5ibGtfdHJhY2UgPT0gTlVMTCkKKwlpZiAo
YnQgPT0gTlVMTCkKIAkJcmV0ID0gc3ByaW50ZihidWYsICJkaXNhYmxlZFxuIik7CiAJZWxzZSBp
ZiAoYXR0ciA9PSAmZGV2X2F0dHJfYWN0X21hc2spCi0JCXJldCA9IGJsa190cmFjZV9tYXNrMnN0
cihidWYsIHEtPmJsa190cmFjZS0+YWN0X21hc2spOworCQlyZXQgPSBibGtfdHJhY2VfbWFzazJz
dHIoYnVmLCBidC0+YWN0X21hc2spOwogCWVsc2UgaWYgKGF0dHIgPT0gJmRldl9hdHRyX3BpZCkK
LQkJcmV0ID0gc3ByaW50ZihidWYsICIldVxuIiwgcS0+YmxrX3RyYWNlLT5waWQpOworCQlyZXQg
PSBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCBidC0+cGlkKTsKIAllbHNlIGlmIChhdHRyID09ICZkZXZf
YXR0cl9zdGFydF9sYmEpCi0JCXJldCA9IHNwcmludGYoYnVmLCAiJWxsdVxuIiwgcS0+YmxrX3Ry
YWNlLT5zdGFydF9sYmEpOworCQlyZXQgPSBzcHJpbnRmKGJ1ZiwgIiVsbHVcbiIsIGJ0LT5zdGFy
dF9sYmEpOwogCWVsc2UgaWYgKGF0dHIgPT0gJmRldl9hdHRyX2VuZF9sYmEpCi0JCXJldCA9IHNw
cmludGYoYnVmLCAiJWxsdVxuIiwgcS0+YmxrX3RyYWNlLT5lbmRfbGJhKTsKKwkJcmV0ID0gc3By
aW50ZihidWYsICIlbGx1XG4iLCBidC0+ZW5kX2xiYSk7CiAKIG91dF91bmxvY2tfYmRldjoKIAlt
dXRleF91bmxvY2soJnEtPmJsa190cmFjZV9tdXRleCk7CkBAIC0xNzI5LDYgKzE3NzYsNyBAQCBz
dGF0aWMgc3NpemVfdCBzeXNmc19ibGtfdHJhY2VfYXR0cl9zdG9yZShzdHJ1Y3QgZGV2aWNlICpk
ZXYsCiAJc3RydWN0IGJsb2NrX2RldmljZSAqYmRldjsKIAlzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAq
cTsKIAlzdHJ1Y3QgaGRfc3RydWN0ICpwOworCXN0cnVjdCBibGtfdHJhY2UgKmJ0OwogCXU2NCB2
YWx1ZTsKIAlzc2l6ZV90IHJldCA9IC1FSU5WQUw7CiAKQEAgLTE3NTksOCArMTgwNywxMCBAQCBz
dGF0aWMgc3NpemVfdCBzeXNmc19ibGtfdHJhY2VfYXR0cl9zdG9yZShzdHJ1Y3QgZGV2aWNlICpk
ZXYsCiAKIAltdXRleF9sb2NrKCZxLT5ibGtfdHJhY2VfbXV0ZXgpOwogCisJYnQgPSByY3VfZGVy
ZWZlcmVuY2VfcHJvdGVjdGVkKHEtPmJsa190cmFjZSwKKwkJCQkgICAgICAgbG9ja2RlcF9pc19o
ZWxkKCZxLT5ibGtfdHJhY2VfbXV0ZXgpKTsKIAlpZiAoYXR0ciA9PSAmZGV2X2F0dHJfZW5hYmxl
KSB7Ci0JCWlmICghIXZhbHVlID09ICEhcS0+YmxrX3RyYWNlKSB7CisJCWlmICghIXZhbHVlID09
ICEhYnQpIHsKIAkJCXJldCA9IDA7CiAJCQlnb3RvIG91dF91bmxvY2tfYmRldjsKIAkJfQpAQCAt
MTc3MiwxOCArMTgyMiwxOCBAQCBzdGF0aWMgc3NpemVfdCBzeXNmc19ibGtfdHJhY2VfYXR0cl9z
dG9yZShzdHJ1Y3QgZGV2aWNlICpkZXYsCiAJfQogCiAJcmV0ID0gMDsKLQlpZiAocS0+YmxrX3Ry
YWNlID09IE5VTEwpCisJaWYgKGJ0ID09IE5VTEwpCiAJCXJldCA9IGJsa190cmFjZV9zZXR1cF9x
dWV1ZShxLCBiZGV2KTsKIAogCWlmIChyZXQgPT0gMCkgewogCQlpZiAoYXR0ciA9PSAmZGV2X2F0
dHJfYWN0X21hc2spCi0JCQlxLT5ibGtfdHJhY2UtPmFjdF9tYXNrID0gdmFsdWU7CisJCQlidC0+
YWN0X21hc2sgPSB2YWx1ZTsKIAkJZWxzZSBpZiAoYXR0ciA9PSAmZGV2X2F0dHJfcGlkKQotCQkJ
cS0+YmxrX3RyYWNlLT5waWQgPSB2YWx1ZTsKKwkJCWJ0LT5waWQgPSB2YWx1ZTsKIAkJZWxzZSBp
ZiAoYXR0ciA9PSAmZGV2X2F0dHJfc3RhcnRfbGJhKQotCQkJcS0+YmxrX3RyYWNlLT5zdGFydF9s
YmEgPSB2YWx1ZTsKKwkJCWJ0LT5zdGFydF9sYmEgPSB2YWx1ZTsKIAkJZWxzZSBpZiAoYXR0ciA9
PSAmZGV2X2F0dHJfZW5kX2xiYSkKLQkJCXEtPmJsa190cmFjZS0+ZW5kX2xiYSA9IHZhbHVlOwor
CQkJYnQtPmVuZF9sYmEgPSB2YWx1ZTsKIAl9CiAKIG91dF91bmxvY2tfYmRldjoKCkZyb20gNWY3
M2I0MTEwNTM1MmEwNTYyZGFjY2ZkM2YzNDliYzdjMGM2NDkwMCBNb24gU2VwIDE3IDAwOjAwOjAw
IDIwMDEKRnJvbTogQ2VuZ2l6IENhbiA8Y2VuZ2l6QGtlcm5lbC53dGY+CkRhdGU6IFdlZCwgNCBN
YXIgMjAyMCAxMzo1ODoxOSArMDMwMApTdWJqZWN0OiBibGt0cmFjZTogZml4IGRlcmVmZXJlbmNl
IGFmdGVyIG51bGwgY2hlY2sKCmNvbW1pdCAxNTMwMzFhMzAxYmIwNzE5NGU5YzM3NDY2Y2ZjZThl
YWNiOTc3NjIxIHVwc3RyZWFtLgoKVGhlcmUgd2FzIGEgcmVjZW50IGNoYW5nZSBpbiBibGt0cmFj
ZS5jIHRoYXQgYWRkZWQgYSBSQ1UgcHJvdGVjdGlvbiB0bwpgcS0+YmxrX3RyYWNlYCBpbiBvcmRl
ciB0byBmaXggYSB1c2UtYWZ0ZXItZnJlZSBpc3N1ZSBkdXJpbmcgYWNjZXNzLgoKSG93ZXZlciB0
aGUgY2hhbmdlIG1pc3NlZCBhbiBlZGdlIGNhc2UgdGhhdCBjYW4gbGVhZCB0byBkZXJlZmVyZW5j
aW5nIG9mCmBidGAgcG9pbnRlciBldmVuIHdoZW4gaXQncyBOVUxMOgoKQ292ZXJpdHkgc3RhdGlj
IGFuYWx5emVyIG1hcmtlZCB0aGlzIGFzIGEgRk9SV0FSRF9OVUxMIGlzc3VlIHdpdGggQ0lECjE0
NjA0NTguCgpgYGAKL2tlcm5lbC90cmFjZS9ibGt0cmFjZS5jOiAxOTA0IGluIHN5c2ZzX2Jsa190
cmFjZV9hdHRyX3N0b3JlKCkKMTg5OCAgICAgICAgICAgIHJldCA9IDA7CjE4OTkgICAgICAgICAg
ICBpZiAoYnQgPT0gTlVMTCkKMTkwMCAgICAgICAgICAgICAgICAgICAgcmV0ID0gYmxrX3RyYWNl
X3NldHVwX3F1ZXVlKHEsIGJkZXYpOwoxOTAxCjE5MDIgICAgICAgICAgICBpZiAocmV0ID09IDAp
IHsKMTkwMyAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHIgPT0gJmRldl9hdHRyX2FjdF9tYXNr
KQo+Pj4gICAgIENJRCAxNDYwNDU4OiAgTnVsbCBwb2ludGVyIGRlcmVmZXJlbmNlcyAgKEZPUldB
UkRfTlVMTCkKPj4+ICAgICBEZXJlZmVyZW5jaW5nIG51bGwgcG9pbnRlciAiYnQiLgoxOTA0ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LT5hY3RfbWFzayA9IHZhbHVlOwoxOTA1ICAgICAg
ICAgICAgICAgICAgICBlbHNlIGlmIChhdHRyID09ICZkZXZfYXR0cl9waWQpCjE5MDYgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgYnQtPnBpZCA9IHZhbHVlOwoxOTA3ICAgICAgICAgICAgICAg
ICAgICBlbHNlIGlmIChhdHRyID09ICZkZXZfYXR0cl9zdGFydF9sYmEpCjE5MDggICAgICAgICAg
ICAgICAgICAgICAgICAgICAgYnQtPnN0YXJ0X2xiYSA9IHZhbHVlOwoxOTA5ICAgICAgICAgICAg
ICAgICAgICBlbHNlIGlmIChhdHRyID09ICZkZXZfYXR0cl9lbmRfbGJhKQpgYGAKCkFkZGVkIGEg
cmVhc3NpZ25tZW50IHdpdGggUkNVIGFubm90YXRpb24gdG8gZml4IHRoZSBpc3N1ZS4KCkZpeGVz
OiBjNzgwZTg2ZGQ0OCAoImJsa3RyYWNlOiBQcm90ZWN0IHEtPmJsa190cmFjZSB3aXRoIFJDVSIp
ClJldmlld2VkLWJ5OiBNaW5nIExlaSA8bWluZy5sZWlAcmVkaGF0LmNvbT4KUmV2aWV3ZWQtYnk6
IEJvYiBMaXUgPGJvYi5saXVAb3JhY2xlLmNvbT4KUmV2aWV3ZWQtYnk6IFN0ZXZlbiBSb3N0ZWR0
IChWTXdhcmUpIDxyb3N0ZWR0QGdvb2RtaXMub3JnPgpTaWduZWQtb2ZmLWJ5OiBDZW5naXogQ2Fu
IDxjZW5naXpAa2VybmVsLnd0Zj4KU2lnbmVkLW9mZi1ieTogSmVucyBBeGJvZSA8YXhib2VAa2Vy
bmVsLmRrPgpTaWduZWQtb2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxiZW4uaHV0Y2hpbmdzQGNvZGV0
aGluay5jby51az4KLS0tCiBrZXJuZWwvdHJhY2UvYmxrdHJhY2UuYyB8IDUgKysrKy0KIDEgZmls
ZSBjaGFuZ2VkLCA0IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKCmRpZmYgLS1naXQgYS9r
ZXJuZWwvdHJhY2UvYmxrdHJhY2UuYyBiL2tlcm5lbC90cmFjZS9ibGt0cmFjZS5jCmluZGV4IGJm
OWJmM2YyMmVkYi4uNjczNzU2NDY4MDE5IDEwMDY0NAotLS0gYS9rZXJuZWwvdHJhY2UvYmxrdHJh
Y2UuYworKysgYi9rZXJuZWwvdHJhY2UvYmxrdHJhY2UuYwpAQCAtMTgyMiw4ICsxODIyLDExIEBA
IHN0YXRpYyBzc2l6ZV90IHN5c2ZzX2Jsa190cmFjZV9hdHRyX3N0b3JlKHN0cnVjdCBkZXZpY2Ug
KmRldiwKIAl9CiAKIAlyZXQgPSAwOwotCWlmIChidCA9PSBOVUxMKQorCWlmIChidCA9PSBOVUxM
KSB7CiAJCXJldCA9IGJsa190cmFjZV9zZXR1cF9xdWV1ZShxLCBiZGV2KTsKKwkJYnQgPSByY3Vf
ZGVyZWZlcmVuY2VfcHJvdGVjdGVkKHEtPmJsa190cmFjZSwKKwkJCQlsb2NrZGVwX2lzX2hlbGQo
JnEtPmJsa190cmFjZV9tdXRleCkpOworCX0KIAogCWlmIChyZXQgPT0gMCkgewogCQlpZiAoYXR0
ciA9PSAmZGV2X2F0dHJfYWN0X21hc2spCgpGcm9tIDdkNjc1NjcwZjBlYjk1ZGIxNTVhMTY1ZTBl
YzIwZGYxNTAxYTBiM2QgTW9uIFNlcCAxNyAwMDowMDowMCAyMDAxCkZyb206IERtaXRyeSBUb3Jv
a2hvdiA8ZG1pdHJ5LnRvcm9raG92QGdtYWlsLmNvbT4KRGF0ZTogVHVlLCAxNCBGZWIgMjAxNyAx
MDoyMzozMSAtMDgwMApTdWJqZWN0OiBwdHA6IGRvIG5vdCBleHBsaWNpdGx5IHNldCBkcnZkYXRh
IGluIHB0cF9jbG9ja19yZWdpc3RlcigpCgpjb21taXQgODgyZjMxMmRjMDc1MWM5NzNkYjI2NDc4
ZjA3ZjA4MmM1ODRkMTZhYSB1cHN0cmVhbS4KCldlIGRvIG5vdCBuZWVkIGV4cGxpY2l0bHkgY2Fs
bCBkZXZfc2V0X2RydmRhdGEoKSwgYXMgaXQgaXMgZG9uZSBmb3IgdXMgYnkKZGV2aWNlX2NyZWF0
ZSgpLgoKQWNrZWQtYnk6IFJpY2hhcmQgQ29jaHJhbiA8cmljaGFyZGNvY2hyYW5AZ21haWwuY29t
PgpTaWduZWQtb2ZmLWJ5OiBEbWl0cnkgVG9yb2tob3YgPGRtaXRyeS50b3Jva2hvdkBnbWFpbC5j
b20+ClNpZ25lZC1vZmYtYnk6IERhdmlkIFMuIE1pbGxlciA8ZGF2ZW1AZGF2ZW1sb2Z0Lm5ldD4K
U2lnbmVkLW9mZi1ieTogQmVuIEh1dGNoaW5ncyA8YmVuLmh1dGNoaW5nc0Bjb2RldGhpbmsuY28u
dWs+Ci0tLQogZHJpdmVycy9wdHAvcHRwX2Nsb2NrLmMgfCAyIC0tCiAxIGZpbGUgY2hhbmdlZCwg
MiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL3B0cC9wdHBfY2xvY2suYyBiL2Ry
aXZlcnMvcHRwL3B0cF9jbG9jay5jCmluZGV4IDYwYTVlMGM2M2ExMy4uMTEzYjY2ZjFmYzllIDEw
MDY0NAotLS0gYS9kcml2ZXJzL3B0cC9wdHBfY2xvY2suYworKysgYi9kcml2ZXJzL3B0cC9wdHBf
Y2xvY2suYwpAQCAtMjIwLDggKzIyMCw2IEBAIHN0cnVjdCBwdHBfY2xvY2sgKnB0cF9jbG9ja19y
ZWdpc3RlcihzdHJ1Y3QgcHRwX2Nsb2NrX2luZm8gKmluZm8sCiAJaWYgKElTX0VSUihwdHAtPmRl
dikpCiAJCWdvdG8gbm9fZGV2aWNlOwogCi0JZGV2X3NldF9kcnZkYXRhKHB0cC0+ZGV2LCBwdHAp
OwotCiAJZXJyID0gcHRwX3BvcHVsYXRlX3N5c2ZzKHB0cCk7CiAJaWYgKGVycikKIAkJZ290byBu
b19zeXNmczsKCkZyb20gNjU3NDY4M2QzMzlhNzdmMTc3YzhjMTFjMzMxNjdiNDc2OTNkMjA3OSBN
b24gU2VwIDE3IDAwOjAwOjAwIDIwMDEKRnJvbTogRG1pdHJ5IFRvcm9raG92IDxkbWl0cnkudG9y
b2tob3ZAZ21haWwuY29tPgpEYXRlOiBUdWUsIDE0IEZlYiAyMDE3IDEwOjIzOjMzIC0wODAwClN1
YmplY3Q6IHB0cDogdXNlIGlzX3Zpc2libGUgbWV0aG9kIHRvIGhpZGUgdW51c2VkIGF0dHJpYnV0
ZXMKCmNvbW1pdCBhZjU5ZTcxN2Q1ZmY5YzhkYmY5YmNjNTgxYzBkZmIzYjJhOWM5MDMwIHVwc3Ry
ZWFtLgoKSW5zdGVhZCBvZiBjcmVhdGluZyBzZWxlY3RlZCBhdHRyaWJ1dGVzIGFmdGVyIHRoZSBk
ZXZpY2UgaXMgY3JlYXRlZCAoYW5kCmFmdGVyIHVzZXJzcGFjZSBwb3RlbnRpYWxseSBzZWVuIHVl
dmVudCksIGxldHMgdXNlIGF0dHJpYnV0ZSBncm91cAppc192aXNpYmxlKCkgbWV0aG9kIHRvIGNv
bnRyb2wgd2hpY2ggYXR0cmlidXRlcyBhcmUgc2hvd24uIFRoaXMgd2lsbCBhbGxvdwp1cyB0byBj
cmVhdGUgYWxsIGF0dHJpYnV0ZXMgKGV4Y2VwdCAicGlucyIgZ3JvdXAsIHdoaWNoIHdpbGwgYmUg
dGFrZW4gY2FyZQpvZiBsYXRlcikgYmVmb3JlIHVzZXJzcGFjZSBnZXRzIG5vdGlmaWVkIGFib3V0
IG5ldyBwdHAgY2xhc3MgZGV2aWNlLgoKU2lnbmVkLW9mZi1ieTogRG1pdHJ5IFRvcm9raG92IDxk
bWl0cnkudG9yb2tob3ZAZ21haWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBEYXZpZCBTLiBNaWxsZXIg
PGRhdmVtQGRhdmVtbG9mdC5uZXQ+ClNpZ25lZC1vZmYtYnk6IEJlbiBIdXRjaGluZ3MgPGJlbi5o
dXRjaGluZ3NAY29kZXRoaW5rLmNvLnVrPgotLS0KIGRyaXZlcnMvcHRwL3B0cF9zeXNmcy5jIHwg
MTI1ICsrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIDEgZmlsZSBjaGFu
Z2VkLCA1NSBpbnNlcnRpb25zKCspLCA3MCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2
ZXJzL3B0cC9wdHBfc3lzZnMuYyBiL2RyaXZlcnMvcHRwL3B0cF9zeXNmcy5jCmluZGV4IDMwMmU2
MjZmZTZiMC4uYTU1YTZlYjRkZmRlIDEwMDY0NAotLS0gYS9kcml2ZXJzL3B0cC9wdHBfc3lzZnMu
YworKysgYi9kcml2ZXJzL3B0cC9wdHBfc3lzZnMuYwpAQCAtNDYsMjcgKzQ2LDYgQEAgUFRQX1NI
T1dfSU5UKG5fcGVyaW9kaWNfb3V0cHV0cywgbl9wZXJfb3V0KTsKIFBUUF9TSE9XX0lOVChuX3By
b2dyYW1tYWJsZV9waW5zLCBuX3BpbnMpOwogUFRQX1NIT1dfSU5UKHBwc19hdmFpbGFibGUsIHBw
cyk7CiAKLXN0YXRpYyBzdHJ1Y3QgYXR0cmlidXRlICpwdHBfYXR0cnNbXSA9IHsKLQkmZGV2X2F0
dHJfY2xvY2tfbmFtZS5hdHRyLAotCSZkZXZfYXR0cl9tYXhfYWRqdXN0bWVudC5hdHRyLAotCSZk
ZXZfYXR0cl9uX2FsYXJtcy5hdHRyLAotCSZkZXZfYXR0cl9uX2V4dGVybmFsX3RpbWVzdGFtcHMu
YXR0ciwKLQkmZGV2X2F0dHJfbl9wZXJpb2RpY19vdXRwdXRzLmF0dHIsCi0JJmRldl9hdHRyX25f
cHJvZ3JhbW1hYmxlX3BpbnMuYXR0ciwKLQkmZGV2X2F0dHJfcHBzX2F2YWlsYWJsZS5hdHRyLAot
CU5VTEwsCi19OwotCi1zdGF0aWMgY29uc3Qgc3RydWN0IGF0dHJpYnV0ZV9ncm91cCBwdHBfZ3Jv
dXAgPSB7Ci0JLmF0dHJzID0gcHRwX2F0dHJzLAotfTsKLQotY29uc3Qgc3RydWN0IGF0dHJpYnV0
ZV9ncm91cCAqcHRwX2dyb3Vwc1tdID0gewotCSZwdHBfZ3JvdXAsCi0JTlVMTCwKLX07Ci0KLQog
c3RhdGljIHNzaXplX3QgZXh0dHNfZW5hYmxlX3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKIAkJ
CQkgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAogCQkJCSAgY29uc3QgY2hhciAqYnVm
LCBzaXplX3QgY291bnQpCkBAIC05MSw2ICs3MCw3IEBAIHN0YXRpYyBzc2l6ZV90IGV4dHRzX2Vu
YWJsZV9zdG9yZShzdHJ1Y3QgZGV2aWNlICpkZXYsCiBvdXQ6CiAJcmV0dXJuIGVycjsKIH0KK3N0
YXRpYyBERVZJQ0VfQVRUUihleHR0c19lbmFibGUsIDAyMjAsIE5VTEwsIGV4dHRzX2VuYWJsZV9z
dG9yZSk7CiAKIHN0YXRpYyBzc2l6ZV90IGV4dHRzX2ZpZm9fc2hvdyhzdHJ1Y3QgZGV2aWNlICpk
ZXYsCiAJCQkgICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKnBhZ2Up
CkBAIC0xMjQsNiArMTA0LDcgQEAgb3V0OgogCW11dGV4X3VubG9jaygmcHRwLT50c2V2cV9tdXgp
OwogCXJldHVybiBjbnQ7CiB9CitzdGF0aWMgREVWSUNFX0FUVFIoZmlmbywgMDQ0NCwgZXh0dHNf
Zmlmb19zaG93LCBOVUxMKTsKIAogc3RhdGljIHNzaXplX3QgcGVyaW9kX3N0b3JlKHN0cnVjdCBk
ZXZpY2UgKmRldiwKIAkJCSAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKQEAgLTE1
MSw2ICsxMzIsNyBAQCBzdGF0aWMgc3NpemVfdCBwZXJpb2Rfc3RvcmUoc3RydWN0IGRldmljZSAq
ZGV2LAogb3V0OgogCXJldHVybiBlcnI7CiB9CitzdGF0aWMgREVWSUNFX0FUVFIocGVyaW9kLCAw
MjIwLCBOVUxMLCBwZXJpb2Rfc3RvcmUpOwogCiBzdGF0aWMgc3NpemVfdCBwcHNfZW5hYmxlX3N0
b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKIAkJCQlzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0
ciwKQEAgLTE3Nyw2ICsxNTksNTcgQEAgc3RhdGljIHNzaXplX3QgcHBzX2VuYWJsZV9zdG9yZShz
dHJ1Y3QgZGV2aWNlICpkZXYsCiBvdXQ6CiAJcmV0dXJuIGVycjsKIH0KK3N0YXRpYyBERVZJQ0Vf
QVRUUihwcHNfZW5hYmxlLCAwMjIwLCBOVUxMLCBwcHNfZW5hYmxlX3N0b3JlKTsKKworc3RhdGlj
IHN0cnVjdCBhdHRyaWJ1dGUgKnB0cF9hdHRyc1tdID0geworCSZkZXZfYXR0cl9jbG9ja19uYW1l
LmF0dHIsCisKKwkmZGV2X2F0dHJfbWF4X2FkanVzdG1lbnQuYXR0ciwKKwkmZGV2X2F0dHJfbl9h
bGFybXMuYXR0ciwKKwkmZGV2X2F0dHJfbl9leHRlcm5hbF90aW1lc3RhbXBzLmF0dHIsCisJJmRl
dl9hdHRyX25fcGVyaW9kaWNfb3V0cHV0cy5hdHRyLAorCSZkZXZfYXR0cl9uX3Byb2dyYW1tYWJs
ZV9waW5zLmF0dHIsCisJJmRldl9hdHRyX3Bwc19hdmFpbGFibGUuYXR0ciwKKworCSZkZXZfYXR0
cl9leHR0c19lbmFibGUuYXR0ciwKKwkmZGV2X2F0dHJfZmlmby5hdHRyLAorCSZkZXZfYXR0cl9w
ZXJpb2QuYXR0ciwKKwkmZGV2X2F0dHJfcHBzX2VuYWJsZS5hdHRyLAorCU5VTEwKK307CisKK3N0
YXRpYyB1bW9kZV90IHB0cF9pc19hdHRyaWJ1dGVfdmlzaWJsZShzdHJ1Y3Qga29iamVjdCAqa29i
aiwKKwkJCQkJc3RydWN0IGF0dHJpYnV0ZSAqYXR0ciwgaW50IG4pCit7CisJc3RydWN0IGRldmlj
ZSAqZGV2ID0ga29ial90b19kZXYoa29iaik7CisJc3RydWN0IHB0cF9jbG9jayAqcHRwID0gZGV2
X2dldF9kcnZkYXRhKGRldik7CisJc3RydWN0IHB0cF9jbG9ja19pbmZvICppbmZvID0gcHRwLT5p
bmZvOworCXVtb2RlX3QgbW9kZSA9IGF0dHItPm1vZGU7CisKKwlpZiAoYXR0ciA9PSAmZGV2X2F0
dHJfZXh0dHNfZW5hYmxlLmF0dHIgfHwKKwkgICAgYXR0ciA9PSAmZGV2X2F0dHJfZmlmby5hdHRy
KSB7CisJCWlmICghaW5mby0+bl9leHRfdHMpCisJCQltb2RlID0gMDsKKwl9IGVsc2UgaWYgKGF0
dHIgPT0gJmRldl9hdHRyX3BlcmlvZC5hdHRyKSB7CisJCWlmICghaW5mby0+bl9wZXJfb3V0KQor
CQkJbW9kZSA9IDA7CisJfSBlbHNlIGlmIChhdHRyID09ICZkZXZfYXR0cl9wcHNfZW5hYmxlLmF0
dHIpIHsKKwkJaWYgKCFpbmZvLT5wcHMpCisJCQltb2RlID0gMDsKKwl9CisKKwlyZXR1cm4gbW9k
ZTsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgcHRwX2dyb3VwID0g
eworCS5pc192aXNpYmxlCT0gcHRwX2lzX2F0dHJpYnV0ZV92aXNpYmxlLAorCS5hdHRycwkJPSBw
dHBfYXR0cnMsCit9OworCitjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwICpwdHBfZ3JvdXBz
W10gPSB7CisJJnB0cF9ncm91cCwKKwlOVUxMCit9OwogCiBzdGF0aWMgaW50IHB0cF9waW5fbmFt
ZTJpbmRleChzdHJ1Y3QgcHRwX2Nsb2NrICpwdHAsIGNvbnN0IGNoYXIgKm5hbWUpCiB7CkBAIC0y
MzUsMjYgKzI2OCwxMSBAQCBzdGF0aWMgc3NpemVfdCBwdHBfcGluX3N0b3JlKHN0cnVjdCBkZXZp
Y2UgKmRldiwgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCiAJcmV0dXJuIGNvdW50Owog
fQogCi1zdGF0aWMgREVWSUNFX0FUVFIoZXh0dHNfZW5hYmxlLCAwMjIwLCBOVUxMLCBleHR0c19l
bmFibGVfc3RvcmUpOwotc3RhdGljIERFVklDRV9BVFRSKGZpZm8sICAgICAgICAgMDQ0NCwgZXh0
dHNfZmlmb19zaG93LCBOVUxMKTsKLXN0YXRpYyBERVZJQ0VfQVRUUihwZXJpb2QsICAgICAgIDAy
MjAsIE5VTEwsIHBlcmlvZF9zdG9yZSk7Ci1zdGF0aWMgREVWSUNFX0FUVFIocHBzX2VuYWJsZSwg
ICAwMjIwLCBOVUxMLCBwcHNfZW5hYmxlX3N0b3JlKTsKLQogaW50IHB0cF9jbGVhbnVwX3N5c2Zz
KHN0cnVjdCBwdHBfY2xvY2sgKnB0cCkKIHsKIAlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBwdHAtPmRl
djsKIAlzdHJ1Y3QgcHRwX2Nsb2NrX2luZm8gKmluZm8gPSBwdHAtPmluZm87CiAKLQlpZiAoaW5m
by0+bl9leHRfdHMpIHsKLQkJZGV2aWNlX3JlbW92ZV9maWxlKGRldiwgJmRldl9hdHRyX2V4dHRz
X2VuYWJsZSk7Ci0JCWRldmljZV9yZW1vdmVfZmlsZShkZXYsICZkZXZfYXR0cl9maWZvKTsKLQl9
Ci0JaWYgKGluZm8tPm5fcGVyX291dCkKLQkJZGV2aWNlX3JlbW92ZV9maWxlKGRldiwgJmRldl9h
dHRyX3BlcmlvZCk7Ci0KLQlpZiAoaW5mby0+cHBzKQotCQlkZXZpY2VfcmVtb3ZlX2ZpbGUoZGV2
LCAmZGV2X2F0dHJfcHBzX2VuYWJsZSk7Ci0KIAlpZiAoaW5mby0+bl9waW5zKSB7CiAJCXN5c2Zz
X3JlbW92ZV9ncm91cCgmZGV2LT5rb2JqLCAmcHRwLT5waW5fYXR0cl9ncm91cCk7CiAJCWtmcmVl
KHB0cC0+cGluX2F0dHIpOwpAQCAtMzA3LDQ2ICszMjUsMTMgQEAgbm9fZGV2X2F0dHI6CiAKIGlu
dCBwdHBfcG9wdWxhdGVfc3lzZnMoc3RydWN0IHB0cF9jbG9jayAqcHRwKQogewotCXN0cnVjdCBk
ZXZpY2UgKmRldiA9IHB0cC0+ZGV2OwogCXN0cnVjdCBwdHBfY2xvY2tfaW5mbyAqaW5mbyA9IHB0
cC0+aW5mbzsKIAlpbnQgZXJyOwogCi0JaWYgKGluZm8tPm5fZXh0X3RzKSB7Ci0JCWVyciA9IGRl
dmljZV9jcmVhdGVfZmlsZShkZXYsICZkZXZfYXR0cl9leHR0c19lbmFibGUpOwotCQlpZiAoZXJy
KQotCQkJZ290byBvdXQxOwotCQllcnIgPSBkZXZpY2VfY3JlYXRlX2ZpbGUoZGV2LCAmZGV2X2F0
dHJfZmlmbyk7Ci0JCWlmIChlcnIpCi0JCQlnb3RvIG91dDI7Ci0JfQotCWlmIChpbmZvLT5uX3Bl
cl9vdXQpIHsKLQkJZXJyID0gZGV2aWNlX2NyZWF0ZV9maWxlKGRldiwgJmRldl9hdHRyX3Blcmlv
ZCk7Ci0JCWlmIChlcnIpCi0JCQlnb3RvIG91dDM7Ci0JfQotCWlmIChpbmZvLT5wcHMpIHsKLQkJ
ZXJyID0gZGV2aWNlX2NyZWF0ZV9maWxlKGRldiwgJmRldl9hdHRyX3Bwc19lbmFibGUpOwotCQlp
ZiAoZXJyKQotCQkJZ290byBvdXQ0OwotCX0KIAlpZiAoaW5mby0+bl9waW5zKSB7CiAJCWVyciA9
IHB0cF9wb3B1bGF0ZV9waW5zKHB0cCk7CiAJCWlmIChlcnIpCi0JCQlnb3RvIG91dDU7CisJCQly
ZXR1cm4gZXJyOwogCX0KIAlyZXR1cm4gMDsKLW91dDU6Ci0JaWYgKGluZm8tPnBwcykKLQkJZGV2
aWNlX3JlbW92ZV9maWxlKGRldiwgJmRldl9hdHRyX3Bwc19lbmFibGUpOwotb3V0NDoKLQlpZiAo
aW5mby0+bl9wZXJfb3V0KQotCQlkZXZpY2VfcmVtb3ZlX2ZpbGUoZGV2LCAmZGV2X2F0dHJfcGVy
aW9kKTsKLW91dDM6Ci0JaWYgKGluZm8tPm5fZXh0X3RzKQotCQlkZXZpY2VfcmVtb3ZlX2ZpbGUo
ZGV2LCAmZGV2X2F0dHJfZmlmbyk7Ci1vdXQyOgotCWlmIChpbmZvLT5uX2V4dF90cykKLQkJZGV2
aWNlX3JlbW92ZV9maWxlKGRldiwgJmRldl9hdHRyX2V4dHRzX2VuYWJsZSk7Ci1vdXQxOgotCXJl
dHVybiBlcnI7CiB9CgpGcm9tIDMzM2FhYWZkYTk5Y2RkNmMyNzI4MGM5YTExODE0NTgwYTIzMTVm
YTYgTW9uIFNlcCAxNyAwMDowMDowMCAyMDAxCkZyb206IERtaXRyeSBUb3Jva2hvdiA8ZG1pdHJ5
LnRvcm9raG92QGdtYWlsLmNvbT4KRGF0ZTogVHVlLCAxNCBGZWIgMjAxNyAxMDoyMzozNCAtMDgw
MApTdWJqZWN0OiBwdHA6IGNyZWF0ZSAicGlucyIgdG9nZXRoZXIgd2l0aCB0aGUgcmVzdCBvZiBh
dHRyaWJ1dGVzCgpjb21taXQgODVhNjZlNTUwMTk1ODNkYTFlMGYxODcwNmI3YTgyODFjOWY2ZGU1
YiB1cHN0cmVhbS4KCkxldCdzIHN3aXRjaCB0byB1c2luZyBkZXZpY2VfY3JlYXRlX3dpdGhfZ3Jv
dXBzKCksIHdoaWNoIHdpbGwgYWxsb3cgdXMgdG8KY3JlYXRlICJwaW5zIiBhdHRyaWJ1dGUgZ3Jv
dXAgdG9nZXRoZXIgd2l0aCB0aGUgcmVzdCBvZiBwdHAgZGV2aWNlCmF0dHJpYnV0ZXMsIGFuZCBi
ZWZvcmUgdXNlcnNwYWNlIGdldHMgbm90aWZpZWQgYWJvdXQgcHRwIGRldmljZSBjcmVhdGlvbi4K
ClNpZ25lZC1vZmYtYnk6IERtaXRyeSBUb3Jva2hvdiA8ZG1pdHJ5LnRvcm9raG92QGdtYWlsLmNv
bT4KU2lnbmVkLW9mZi1ieTogRGF2aWQgUy4gTWlsbGVyIDxkYXZlbUBkYXZlbWxvZnQubmV0Pgpb
YndoOiBCYWNrcG9ydGVkIHRvIDQuOTogYWRqdXN0IGNvbnRleHRdClNpZ25lZC1vZmYtYnk6IEJl
biBIdXRjaGluZ3MgPGJlbi5odXRjaGluZ3NAY29kZXRoaW5rLmNvLnVrPgotLS0KIGRyaXZlcnMv
cHRwL3B0cF9jbG9jay5jICAgfCAyMCArKysrKysrKysrKy0tLS0tLS0tLQogZHJpdmVycy9wdHAv
cHRwX3ByaXZhdGUuaCB8ICA3ICsrKystLS0KIGRyaXZlcnMvcHRwL3B0cF9zeXNmcy5jICAgfCAz
OSArKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIDMgZmlsZXMgY2hhbmdl
ZCwgMjQgaW5zZXJ0aW9ucygrKSwgNDIgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9wdHAvcHRwX2Nsb2NrLmMgYi9kcml2ZXJzL3B0cC9wdHBfY2xvY2suYwppbmRleCAxMTNiNjZm
MWZjOWUuLjVmNWQ1NGY1MTUzZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9wdHAvcHRwX2Nsb2NrLmMK
KysrIGIvZHJpdmVycy9wdHAvcHRwX2Nsb2NrLmMKQEAgLTIxNCwxNiArMjE0LDE3IEBAIHN0cnVj
dCBwdHBfY2xvY2sgKnB0cF9jbG9ja19yZWdpc3RlcihzdHJ1Y3QgcHRwX2Nsb2NrX2luZm8gKmlu
Zm8sCiAJbXV0ZXhfaW5pdCgmcHRwLT5waW5jZmdfbXV4KTsKIAlpbml0X3dhaXRxdWV1ZV9oZWFk
KCZwdHAtPnRzZXZfd3EpOwogCisJZXJyID0gcHRwX3BvcHVsYXRlX3Bpbl9ncm91cHMocHRwKTsK
KwlpZiAoZXJyKQorCQlnb3RvIG5vX3Bpbl9ncm91cHM7CisKIAkvKiBDcmVhdGUgYSBuZXcgZGV2
aWNlIGluIG91ciBjbGFzcy4gKi8KLQlwdHAtPmRldiA9IGRldmljZV9jcmVhdGUocHRwX2NsYXNz
LCBwYXJlbnQsIHB0cC0+ZGV2aWQsIHB0cCwKLQkJCQkgInB0cCVkIiwgcHRwLT5pbmRleCk7CisJ
cHRwLT5kZXYgPSBkZXZpY2VfY3JlYXRlX3dpdGhfZ3JvdXBzKHB0cF9jbGFzcywgcGFyZW50LCBw
dHAtPmRldmlkLAorCQkJCQkgICAgIHB0cCwgcHRwLT5waW5fYXR0cl9ncm91cHMsCisJCQkJCSAg
ICAgInB0cCVkIiwgcHRwLT5pbmRleCk7CiAJaWYgKElTX0VSUihwdHAtPmRldikpCiAJCWdvdG8g
bm9fZGV2aWNlOwogCi0JZXJyID0gcHRwX3BvcHVsYXRlX3N5c2ZzKHB0cCk7Ci0JaWYgKGVycikK
LQkJZ290byBub19zeXNmczsKLQogCS8qIFJlZ2lzdGVyIGEgbmV3IFBQUyBzb3VyY2UuICovCiAJ
aWYgKGluZm8tPnBwcykgewogCQlzdHJ1Y3QgcHBzX3NvdXJjZV9pbmZvIHBwczsKQEAgLTI1MSwx
MCArMjUyLDEwIEBAIG5vX2Nsb2NrOgogCWlmIChwdHAtPnBwc19zb3VyY2UpCiAJCXBwc191bnJl
Z2lzdGVyX3NvdXJjZShwdHAtPnBwc19zb3VyY2UpOwogbm9fcHBzOgotCXB0cF9jbGVhbnVwX3N5
c2ZzKHB0cCk7Ci1ub19zeXNmczoKIAlkZXZpY2VfZGVzdHJveShwdHBfY2xhc3MsIHB0cC0+ZGV2
aWQpOwogbm9fZGV2aWNlOgorCXB0cF9jbGVhbnVwX3Bpbl9ncm91cHMocHRwKTsKK25vX3Bpbl9n
cm91cHM6CiAJbXV0ZXhfZGVzdHJveSgmcHRwLT50c2V2cV9tdXgpOwogCW11dGV4X2Rlc3Ryb3ko
JnB0cC0+cGluY2ZnX211eCk7CiBub19zbG90OgpAQCAtMjcyLDggKzI3Myw5IEBAIGludCBwdHBf
Y2xvY2tfdW5yZWdpc3RlcihzdHJ1Y3QgcHRwX2Nsb2NrICpwdHApCiAJLyogUmVsZWFzZSB0aGUg
Y2xvY2sncyByZXNvdXJjZXMuICovCiAJaWYgKHB0cC0+cHBzX3NvdXJjZSkKIAkJcHBzX3VucmVn
aXN0ZXJfc291cmNlKHB0cC0+cHBzX3NvdXJjZSk7Ci0JcHRwX2NsZWFudXBfc3lzZnMocHRwKTsK
KwogCWRldmljZV9kZXN0cm95KHB0cF9jbGFzcywgcHRwLT5kZXZpZCk7CisJcHRwX2NsZWFudXBf
cGluX2dyb3VwcyhwdHApOwogCiAJcG9zaXhfY2xvY2tfdW5yZWdpc3RlcigmcHRwLT5jbG9jayk7
CiAJcmV0dXJuIDA7CmRpZmYgLS1naXQgYS9kcml2ZXJzL3B0cC9wdHBfcHJpdmF0ZS5oIGIvZHJp
dmVycy9wdHAvcHRwX3ByaXZhdGUuaAppbmRleCA5YzVkNDE0MjFiNjUuLmQ5NTg4ODk3NGQwYyAx
MDA2NDQKLS0tIGEvZHJpdmVycy9wdHAvcHRwX3ByaXZhdGUuaAorKysgYi9kcml2ZXJzL3B0cC9w
dHBfcHJpdmF0ZS5oCkBAIC01NCw2ICs1NCw4IEBAIHN0cnVjdCBwdHBfY2xvY2sgewogCXN0cnVj
dCBkZXZpY2VfYXR0cmlidXRlICpwaW5fZGV2X2F0dHI7CiAJc3RydWN0IGF0dHJpYnV0ZSAqKnBp
bl9hdHRyOwogCXN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgcGluX2F0dHJfZ3JvdXA7CisJLyogMXN0
IGVudHJ5IGlzIGEgcG9pbnRlciB0byB0aGUgcmVhbCBncm91cCwgMm5kIGlzIE5VTEwgdGVybWlu
YXRvciAqLworCWNvbnN0IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKnBpbl9hdHRyX2dyb3Vwc1sy
XTsKIH07CiAKIC8qCkBAIC05NCw4ICs5Niw3IEBAIHVpbnQgcHRwX3BvbGwoc3RydWN0IHBvc2l4
X2Nsb2NrICpwYywKIAogZXh0ZXJuIGNvbnN0IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKnB0cF9n
cm91cHNbXTsKIAotaW50IHB0cF9jbGVhbnVwX3N5c2ZzKHN0cnVjdCBwdHBfY2xvY2sgKnB0cCk7
Ci0KLWludCBwdHBfcG9wdWxhdGVfc3lzZnMoc3RydWN0IHB0cF9jbG9jayAqcHRwKTsKK2ludCBw
dHBfcG9wdWxhdGVfcGluX2dyb3VwcyhzdHJ1Y3QgcHRwX2Nsb2NrICpwdHApOwordm9pZCBwdHBf
Y2xlYW51cF9waW5fZ3JvdXBzKHN0cnVjdCBwdHBfY2xvY2sgKnB0cCk7CiAKICNlbmRpZgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9wdHAvcHRwX3N5c2ZzLmMgYi9kcml2ZXJzL3B0cC9wdHBfc3lzZnMu
YwppbmRleCBhNTVhNmViNGRmZGUuLjczMWQwNDIzYzhhYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9w
dHAvcHRwX3N5c2ZzLmMKKysrIGIvZHJpdmVycy9wdHAvcHRwX3N5c2ZzLmMKQEAgLTI2OCwyNSAr
MjY4LDE0IEBAIHN0YXRpYyBzc2l6ZV90IHB0cF9waW5fc3RvcmUoc3RydWN0IGRldmljZSAqZGV2
LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKIAlyZXR1cm4gY291bnQ7CiB9CiAKLWlu
dCBwdHBfY2xlYW51cF9zeXNmcyhzdHJ1Y3QgcHRwX2Nsb2NrICpwdHApCitpbnQgcHRwX3BvcHVs
YXRlX3Bpbl9ncm91cHMoc3RydWN0IHB0cF9jbG9jayAqcHRwKQogewotCXN0cnVjdCBkZXZpY2Ug
KmRldiA9IHB0cC0+ZGV2OwotCXN0cnVjdCBwdHBfY2xvY2tfaW5mbyAqaW5mbyA9IHB0cC0+aW5m
bzsKLQotCWlmIChpbmZvLT5uX3BpbnMpIHsKLQkJc3lzZnNfcmVtb3ZlX2dyb3VwKCZkZXYtPmtv
YmosICZwdHAtPnBpbl9hdHRyX2dyb3VwKTsKLQkJa2ZyZWUocHRwLT5waW5fYXR0cik7Ci0JCWtm
cmVlKHB0cC0+cGluX2Rldl9hdHRyKTsKLQl9Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQg
cHRwX3BvcHVsYXRlX3BpbnMoc3RydWN0IHB0cF9jbG9jayAqcHRwKQotewotCXN0cnVjdCBkZXZp
Y2UgKmRldiA9IHB0cC0+ZGV2OwogCXN0cnVjdCBwdHBfY2xvY2tfaW5mbyAqaW5mbyA9IHB0cC0+
aW5mbzsKIAlpbnQgZXJyID0gLUVOT01FTSwgaSwgbl9waW5zID0gaW5mby0+bl9waW5zOwogCisJ
aWYgKCFuX3BpbnMpCisJCXJldHVybiAwOworCiAJcHRwLT5waW5fZGV2X2F0dHIgPSBremFsbG9j
KG5fcGlucyAqIHNpemVvZigqcHRwLT5waW5fZGV2X2F0dHIpLAogCQkJCSAgICBHRlBfS0VSTkVM
KTsKIAlpZiAoIXB0cC0+cGluX2Rldl9hdHRyKQpAQCAtMzEwLDI4ICsyOTksMTggQEAgc3RhdGlj
IGludCBwdHBfcG9wdWxhdGVfcGlucyhzdHJ1Y3QgcHRwX2Nsb2NrICpwdHApCiAJcHRwLT5waW5f
YXR0cl9ncm91cC5uYW1lID0gInBpbnMiOwogCXB0cC0+cGluX2F0dHJfZ3JvdXAuYXR0cnMgPSBw
dHAtPnBpbl9hdHRyOwogCi0JZXJyID0gc3lzZnNfY3JlYXRlX2dyb3VwKCZkZXYtPmtvYmosICZw
dHAtPnBpbl9hdHRyX2dyb3VwKTsKLQlpZiAoZXJyKQotCQlnb3RvIG5vX2dyb3VwOworCXB0cC0+
cGluX2F0dHJfZ3JvdXBzWzBdID0gJnB0cC0+cGluX2F0dHJfZ3JvdXA7CisKIAlyZXR1cm4gMDsK
IAotbm9fZ3JvdXA6Ci0Ja2ZyZWUocHRwLT5waW5fYXR0cik7CiBub19waW5fYXR0cjoKIAlrZnJl
ZShwdHAtPnBpbl9kZXZfYXR0cik7CiBub19kZXZfYXR0cjoKIAlyZXR1cm4gZXJyOwogfQogCi1p
bnQgcHRwX3BvcHVsYXRlX3N5c2ZzKHN0cnVjdCBwdHBfY2xvY2sgKnB0cCkKK3ZvaWQgcHRwX2Ns
ZWFudXBfcGluX2dyb3VwcyhzdHJ1Y3QgcHRwX2Nsb2NrICpwdHApCiB7Ci0Jc3RydWN0IHB0cF9j
bG9ja19pbmZvICppbmZvID0gcHRwLT5pbmZvOwotCWludCBlcnI7Ci0KLQlpZiAoaW5mby0+bl9w
aW5zKSB7Ci0JCWVyciA9IHB0cF9wb3B1bGF0ZV9waW5zKHB0cCk7Ci0JCWlmIChlcnIpCi0JCQly
ZXR1cm4gZXJyOwotCX0KLQlyZXR1cm4gMDsKKwlrZnJlZShwdHAtPnBpbl9hdHRyKTsKKwlrZnJl
ZShwdHAtPnBpbl9kZXZfYXR0cik7CiB9CgpGcm9tIDFkOWJiNTkzOTBkYTc2OTE4N2MzNTM3NzI1
MTJhZDkxZDNmNjE0MzAgTW9uIFNlcCAxNyAwMDowMDowMCAyMDAxCkZyb206IExvZ2FuIEd1bnRo
b3JwZSA8bG9nYW5nQGRlbHRhdGVlLmNvbT4KRGF0ZTogRnJpLCAxNyBNYXIgMjAxNyAxMjo0ODow
OCAtMDYwMApTdWJqZWN0OiBjaGFyZGV2OiBhZGQgaGVscGVyIGZ1bmN0aW9uIHRvIHJlZ2lzdGVy
IGNoYXIgZGV2cyB3aXRoIGEgc3RydWN0CiBkZXZpY2UKCmNvbW1pdCAyMzNlZDA5ZDdmZGFjZjU5
MmVlOTFlNmM5N2NlNWY0MzY0ZmJlN2MwIHVwc3RyZWFtLgoKQ3JlZGl0IGZvciB0aGlzIHBhdGNo
IGdvZXMgaXMgc2hhcmVkIHdpdGggRGFuIFdpbGxpYW1zIFsxXS4gSSd2ZQp0YWtlbiB0aGluZ3Mg
b25lIHN0ZXAgZnVydGhlciB0byBtYWtlIHRoZSBoZWxwZXIgZnVuY3Rpb24gbW9yZQp1c2VmdWwg
YW5kIGNsZWFuIHVwIGNhbGxpbmcgY29kZS4KClRoZXJlJ3MgYSBjb21tb24gcGF0dGVybiBpbiB0
aGUga2VybmVsIHdoZXJlYnkgYSBzdHJ1Y3QgY2RldiBpcyBwbGFjZWQKaW4gYSBzdHJ1Y3R1cmUg
YWxvbmcgc2lkZSBhIHN0cnVjdCBkZXZpY2Ugd2hpY2ggbWFuYWdlcyB0aGUgbGlmZS1jeWNsZQpv
ZiBib3RoLiBJbiB0aGUgbmFpdmUgYXBwcm9hY2gsIHRoZSByZWZlcmVuY2UgY291bnRpbmcgaXMg
YnJva2VuIGFuZAp0aGUgc3RydWN0IGRldmljZSBjYW4gZnJlZSBldmVyeXRoaW5nIGJlZm9yZSB0
aGUgY2hhcmRldiBjb2RlCmlzIGVudGlyZWx5IHJlbGVhc2VkLgoKTWFueSBkZXZlbG9wZXJzIGhh
dmUgc29sdmVkIHRoaXMgcHJvYmxlbSBieSBsaW5raW5nIHRoZSBpbnRlcm5hbCBrb2JqcwppbiB0
aGlzIGZhc2hpb246CgpjZGV2LmtvYmoucGFyZW50ID0gJnBhcmVudF9kZXYua29iajsKClRoZSBj
ZGV2IGNvZGUgZXhwbGljaXRseSBnZXRzIGFuZCBwdXRzIGEgcmVmZXJlbmNlIHRvIGl0J3Mga29i
aiBwYXJlbnQuClNvIHRoaXMgc2VlbXMgbGlrZSBpdCB3YXMgaW50ZW5kZWQgdG8gYmUgdXNlZCB0
aGlzIHdheS4gRG1pdHJ0eSBUb3Jva2hvdgpmaXJzdCBwdXQgdGhpcyBpbiBwbGFjZSBpbiAyMDEy
IHdpdGggdGhpcyBjb21taXQ6CgoyZjAxNTdmIGNoYXJfZGV2OiBwaW4gcGFyZW50IGtvYmplY3QK
CmFuZCB0aGUgZmlyc3QgaW5zdGFuY2Ugb2YgdGhlIGZpeCB3YXMgdGhlbiBkb25lIGluIHRoZSBp
bnB1dCBzdWJzeXN0ZW0KaW4gdGhlIGZvbGxvd2luZyBjb21taXQ6Cgo0YTIxNWFhIElucHV0OiBm
aXggdXNlLWFmdGVyLWZyZWUgaW50cm9kdWNlZCB3aXRoIGR5bmFtaWMgbWlub3IgY2hhbmdlcwoK
U3Vic2VxdWVudGx5IG92ZXIgdGhlIHllYXJzLCBob3dldmVyLCB0aGlzIGlzc3VlIHNlZW1zIHRv
IGhhdmUgdHJpcHBlZAp1cCBtdWx0aXBsZSBkZXZlbG9wZXJzIGluZGVwZW5kZW50bHkuIEZvciBl
eGFtcGxlLCBzZWUgdGhlc2UgY29tbWl0czoKCjBkNWI3ZGEgaWlvOiBQcmV2ZW50IHJhY2UgYmV0
d2VlbiBJSU8gY2hhcmRldiBvcGVuaW5nIGFuZCBJSU8gZGV2aWNlCihieSBMYXJzLVBldGVyIENs
YXVzZW4gaW4gMjAxMykKCmJhMGVmODUgdHBtOiBGaXggaW5pdGlhbGl6YXRpb24gb2YgdGhlIGNk
ZXYKKGJ5IEphc29uIEd1bnRob3JwZSBpbiAyMDE1KQoKNWIyOGRkZSBbbWVkaWFdIG1lZGlhOiBm
aXggdXNlLWFmdGVyLWZyZWUgaW4gY2Rldl9wdXQoKSB3aGVuIGFwcCBleGl0cwphZnRlciBkcml2
ZXIgdW5iaW5kCihieSBTaGF1aCBLaGFuIGluIDIwMTYpCgpUaGlzIHRlY2huaXF1ZSBpcyBzaW1p
bGFybHkgZG9uZSBpbiBhdCBsZWFzdCAxNSBwbGFjZXMgd2l0aGluIHRoZSBrZXJuZWwKYW5kIHBy
b2JhYmx5IHNob3VsZCBoYXZlIGJlZW4gZG9uZSBzbyBpbiBhbm90aGVyLCBhdCBsZWFzdCwgNSBw
bGFjZXMuClRoZSBrb2JqIGxpbmUgYWxzbyBsb29rcyB2ZXJ5IHN1c3BlY3QgaW4gdGhhdCBvbmUg
d291bGQgbm90IGV4cGVjdApkcml2ZXJzIHRvIGhhdmUgdG8gbWVzcyB3aXRoIGtvYmplY3QgaW50
ZXJuYWxzIGluIHRoaXMgd2F5LgpFdmVuIGhpZ2hseSBleHBlcmllbmNlZCBrZXJuZWwgZGV2ZWxv
cGVycyBjYW4gYmUgc3VycHJpc2VkIGJ5IHRoaXMKY29kZSwgYXMgc2VlbiBpbiBbMl0uCgpUbyBo
ZWxwIGFsbGV2aWF0ZSB0aGlzIHNpdHVhdGlvbiwgYW5kIGhvcGVmdWxseSBwcmV2ZW50IGZ1dHVy
ZQp3YXN0ZWQgZWZmb3J0IG9uIHRoaXMgcHJvYmxlbSwgdGhpcyBwYXRjaCBpbnRyb2R1Y2VzIGEg
aGVscGVyIGZ1bmN0aW9uCnRvIHJlZ2lzdGVyIGEgY2hhciBkZXZpY2UgYWxvbmcgd2l0aCBpdHMg
cGFyZW50IHN0cnVjdCBkZXZpY2UuClRoaXMgY3JlYXRlcyBhIG1vcmUgcmVndWxhciBBUEkgZm9y
IHR5aW5nIGEgY2hhciBkZXZpY2UgdG8gaXRzIHBhcmVudAp3aXRob3V0IHRoZSBkZXZlbG9wZXIg
aGF2aW5nIHRvIHNldCBtZW1iZXJzIGluIHRoZSB1bmRlcmx5aW5nIGtvYmplY3QuCgpUaGlzIHBh
dGNoIGludHJvZHVjZSBjZGV2X2RldmljZV9hZGQgYW5kIGNkZXZfZGV2aWNlX2RlbCB3aGljaApy
ZXBsYWNlcyBhIGNvbW1vbiBwYXR0ZXJuIGluY2x1ZGluZyBzZXR0aW5nIHRoZSBrb2JqIHBhcmVu
dCwgY2FsbGluZwpjZGV2X2FkZCBhbmQgdGhlbiBjYWxsaW5nIGRldmljZV9hZGQuIEl0IGFsc28g
aW50cm9kdWNlcyBjZGV2X3NldF9wYXJlbnQKZm9yIHRoZSBmZXcgY2FzZXMgdGhhdCBzZXQgdGhl
IGtvYmplY3QgcGFyZW50IHdpdGhvdXQgdXNpbmcgZGV2aWNlX2FkZC4KClsxXSBodHRwczovL2xr
bWwub3JnL2xrbWwvMjAxNy8yLzEzLzcwMApbMl0gaHR0cHM6Ly9sa21sLm9yZy9sa21sLzIwMTcv
Mi8xMC8zNzAKClNpZ25lZC1vZmYtYnk6IExvZ2FuIEd1bnRob3JwZSA8bG9nYW5nQGRlbHRhdGVl
LmNvbT4KU2lnbmVkLW9mZi1ieTogRGFuIFdpbGxpYW1zIDxkYW4uai53aWxsaWFtc0BpbnRlbC5j
b20+ClJldmlld2VkLWJ5OiBIYW5zIFZlcmt1aWwgPGhhbnMudmVya3VpbEBjaXNjby5jb20+ClJl
dmlld2VkLWJ5OiBBbGV4YW5kcmUgQmVsbG9uaSA8YWxleGFuZHJlLmJlbGxvbmlAZnJlZS1lbGVj
dHJvbnMuY29tPgpTaWduZWQtb2ZmLWJ5OiBHcmVnIEtyb2FoLUhhcnRtYW4gPGdyZWdraEBsaW51
eGZvdW5kYXRpb24ub3JnPgpTaWduZWQtb2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxiZW4uaHV0Y2hp
bmdzQGNvZGV0aGluay5jby51az4KLS0tCiBmcy9jaGFyX2Rldi5jICAgICAgICB8IDg2ICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBpbmNsdWRlL2xpbnV4L2Nk
ZXYuaCB8ICA1ICsrKwogMiBmaWxlcyBjaGFuZ2VkLCA5MSBpbnNlcnRpb25zKCspCgpkaWZmIC0t
Z2l0IGEvZnMvY2hhcl9kZXYuYyBiL2ZzL2NoYXJfZGV2LmMKaW5kZXggZjFmM2JiODEyNzk5Li45
MTU0YTJkN2IxOTUgMTAwNjQ0Ci0tLSBhL2ZzL2NoYXJfZGV2LmMKKysrIGIvZnMvY2hhcl9kZXYu
YwpAQCAtNDcyLDYgKzQ3Miw4NSBAQCBpbnQgY2Rldl9hZGQoc3RydWN0IGNkZXYgKnAsIGRldl90
IGRldiwgdW5zaWduZWQgY291bnQpCiAJcmV0dXJuIDA7CiB9CiAKKy8qKgorICogY2Rldl9zZXRf
cGFyZW50KCkgLSBzZXQgdGhlIHBhcmVudCBrb2JqZWN0IGZvciBhIGNoYXIgZGV2aWNlCisgKiBA
cDogdGhlIGNkZXYgc3RydWN0dXJlCisgKiBAa29iajogdGhlIGtvYmplY3QgdG8gdGFrZSBhIHJl
ZmVyZW5jZSB0bworICoKKyAqIGNkZXZfc2V0X3BhcmVudCgpIHNldHMgYSBwYXJlbnQga29iamVj
dCB3aGljaCB3aWxsIGJlIHJlZmVyZW5jZWQKKyAqIGFwcHJvcHJpYXRlbHkgc28gdGhlIHBhcmVu
dCBpcyBub3QgZnJlZWQgYmVmb3JlIHRoZSBjZGV2LiBUaGlzCisgKiBzaG91bGQgYmUgY2FsbGVk
IGJlZm9yZSBjZGV2X2FkZC4KKyAqLwordm9pZCBjZGV2X3NldF9wYXJlbnQoc3RydWN0IGNkZXYg
KnAsIHN0cnVjdCBrb2JqZWN0ICprb2JqKQoreworCVdBUk5fT04oIWtvYmotPnN0YXRlX2luaXRp
YWxpemVkKTsKKwlwLT5rb2JqLnBhcmVudCA9IGtvYmo7Cit9CisKKy8qKgorICogY2Rldl9kZXZp
Y2VfYWRkKCkgLSBhZGQgYSBjaGFyIGRldmljZSBhbmQgaXQncyBjb3JyZXNwb25kaW5nCisgKglz
dHJ1Y3QgZGV2aWNlLCBsaW5raW5rCisgKiBAZGV2OiB0aGUgZGV2aWNlIHN0cnVjdHVyZQorICog
QGNkZXY6IHRoZSBjZGV2IHN0cnVjdHVyZQorICoKKyAqIGNkZXZfZGV2aWNlX2FkZCgpIGFkZHMg
dGhlIGNoYXIgZGV2aWNlIHJlcHJlc2VudGVkIGJ5IEBjZGV2IHRvIHRoZSBzeXN0ZW0sCisgKiBq
dXN0IGFzIGNkZXZfYWRkIGRvZXMuIEl0IHRoZW4gYWRkcyBAZGV2IHRvIHRoZSBzeXN0ZW0gdXNp
bmcgZGV2aWNlX2FkZAorICogVGhlIGRldl90IGZvciB0aGUgY2hhciBkZXZpY2Ugd2lsbCBiZSB0
YWtlbiBmcm9tIHRoZSBzdHJ1Y3QgZGV2aWNlIHdoaWNoCisgKiBuZWVkcyB0byBiZSBpbml0aWFs
aXplZCBmaXJzdC4gVGhpcyBoZWxwZXIgZnVuY3Rpb24gY29ycmVjdGx5IHRha2VzIGEKKyAqIHJl
ZmVyZW5jZSB0byB0aGUgcGFyZW50IGRldmljZSBzbyB0aGUgcGFyZW50IHdpbGwgbm90IGdldCBy
ZWxlYXNlZCB1bnRpbAorICogYWxsIHJlZmVyZW5jZXMgdG8gdGhlIGNkZXYgYXJlIHJlbGVhc2Vk
LgorICoKKyAqIFRoaXMgaGVscGVyIHVzZXMgZGV2LT5kZXZ0IGZvciB0aGUgZGV2aWNlIG51bWJl
ci4gSWYgaXQgaXMgbm90IHNldAorICogaXQgd2lsbCBub3QgYWRkIHRoZSBjZGV2IGFuZCBpdCB3
aWxsIGJlIGVxdWl2YWxlbnQgdG8gZGV2aWNlX2FkZC4KKyAqCisgKiBUaGlzIGZ1bmN0aW9uIHNo
b3VsZCBiZSB1c2VkIHdoZW5ldmVyIHRoZSBzdHJ1Y3QgY2RldiBhbmQgdGhlCisgKiBzdHJ1Y3Qg
ZGV2aWNlIGFyZSBtZW1iZXJzIG9mIHRoZSBzYW1lIHN0cnVjdHVyZSB3aG9zZSBsaWZldGltZSBp
cworICogbWFuYWdlZCBieSB0aGUgc3RydWN0IGRldmljZS4KKyAqCisgKiBOT1RFOiBDYWxsZXJz
IG11c3QgYXNzdW1lIHRoYXQgdXNlcnNwYWNlIHdhcyBhYmxlIHRvIG9wZW4gdGhlIGNkZXYgYW5k
CisgKiBjYW4gY2FsbCBjZGV2IGZvcHMgY2FsbGJhY2tzIGF0IGFueSB0aW1lLCBldmVuIGlmIHRo
aXMgZnVuY3Rpb24gZmFpbHMuCisgKi8KK2ludCBjZGV2X2RldmljZV9hZGQoc3RydWN0IGNkZXYg
KmNkZXYsIHN0cnVjdCBkZXZpY2UgKmRldikKK3sKKwlpbnQgcmMgPSAwOworCisJaWYgKGRldi0+
ZGV2dCkgeworCQljZGV2X3NldF9wYXJlbnQoY2RldiwgJmRldi0+a29iaik7CisKKwkJcmMgPSBj
ZGV2X2FkZChjZGV2LCBkZXYtPmRldnQsIDEpOworCQlpZiAocmMpCisJCQlyZXR1cm4gcmM7CisJ
fQorCisJcmMgPSBkZXZpY2VfYWRkKGRldik7CisJaWYgKHJjKQorCQljZGV2X2RlbChjZGV2KTsK
KworCXJldHVybiByYzsKK30KKworLyoqCisgKiBjZGV2X2RldmljZV9kZWwoKSAtIGludmVyc2Ug
b2YgY2Rldl9kZXZpY2VfYWRkCisgKiBAZGV2OiB0aGUgZGV2aWNlIHN0cnVjdHVyZQorICogQGNk
ZXY6IHRoZSBjZGV2IHN0cnVjdHVyZQorICoKKyAqIGNkZXZfZGV2aWNlX2RlbCgpIGlzIGEgaGVs
cGVyIGZ1bmN0aW9uIHRvIGNhbGwgY2Rldl9kZWwgYW5kIGRldmljZV9kZWwuCisgKiBJdCBzaG91
bGQgYmUgdXNlZCB3aGVuZXZlciBjZGV2X2RldmljZV9hZGQgaXMgdXNlZC4KKyAqCisgKiBJZiBk
ZXYtPmRldnQgaXMgbm90IHNldCBpdCB3aWxsIG5vdCByZW1vdmUgdGhlIGNkZXYgYW5kIHdpbGwg
YmUgZXF1aXZhbGVudAorICogdG8gZGV2aWNlX2RlbC4KKyAqCisgKiBOT1RFOiBUaGlzIGd1YXJh
bnRlZXMgdGhhdCBhc3NvY2lhdGVkIHN5c2ZzIGNhbGxiYWNrcyBhcmUgbm90IHJ1bm5pbmcKKyAq
IG9yIHJ1bm5hYmxlLCBob3dldmVyIGFueSBjZGV2cyBhbHJlYWR5IG9wZW4gd2lsbCByZW1haW4g
YW5kIHRoZWlyIGZvcHMKKyAqIHdpbGwgc3RpbGwgYmUgY2FsbGFibGUgZXZlbiBhZnRlciB0aGlz
IGZ1bmN0aW9uIHJldHVybnMuCisgKi8KK3ZvaWQgY2Rldl9kZXZpY2VfZGVsKHN0cnVjdCBjZGV2
ICpjZGV2LCBzdHJ1Y3QgZGV2aWNlICpkZXYpCit7CisJZGV2aWNlX2RlbChkZXYpOworCWlmIChk
ZXYtPmRldnQpCisJCWNkZXZfZGVsKGNkZXYpOworfQorCiBzdGF0aWMgdm9pZCBjZGV2X3VubWFw
KGRldl90IGRldiwgdW5zaWduZWQgY291bnQpCiB7CiAJa29ial91bm1hcChjZGV2X21hcCwgZGV2
LCBjb3VudCk7CkBAIC00ODMsNiArNTYyLDEwIEBAIHN0YXRpYyB2b2lkIGNkZXZfdW5tYXAoZGV2
X3QgZGV2LCB1bnNpZ25lZCBjb3VudCkKICAqCiAgKiBjZGV2X2RlbCgpIHJlbW92ZXMgQHAgZnJv
bSB0aGUgc3lzdGVtLCBwb3NzaWJseSBmcmVlaW5nIHRoZSBzdHJ1Y3R1cmUKICAqIGl0c2VsZi4K
KyAqCisgKiBOT1RFOiBUaGlzIGd1YXJhbnRlZXMgdGhhdCBjZGV2IGRldmljZSB3aWxsIG5vIGxv
bmdlciBiZSBhYmxlIHRvIGJlCisgKiBvcGVuZWQsIGhvd2V2ZXIgYW55IGNkZXZzIGFscmVhZHkg
b3BlbiB3aWxsIHJlbWFpbiBhbmQgdGhlaXIgZm9wcyB3aWxsCisgKiBzdGlsbCBiZSBjYWxsYWJs
ZSBldmVuIGFmdGVyIGNkZXZfZGVsIHJldHVybnMuCiAgKi8KIHZvaWQgY2Rldl9kZWwoc3RydWN0
IGNkZXYgKnApCiB7CkBAIC01NzEsNSArNjU0LDggQEAgRVhQT1JUX1NZTUJPTChjZGV2X2luaXQp
OwogRVhQT1JUX1NZTUJPTChjZGV2X2FsbG9jKTsKIEVYUE9SVF9TWU1CT0woY2Rldl9kZWwpOwog
RVhQT1JUX1NZTUJPTChjZGV2X2FkZCk7CitFWFBPUlRfU1lNQk9MKGNkZXZfc2V0X3BhcmVudCk7
CitFWFBPUlRfU1lNQk9MKGNkZXZfZGV2aWNlX2FkZCk7CitFWFBPUlRfU1lNQk9MKGNkZXZfZGV2
aWNlX2RlbCk7CiBFWFBPUlRfU1lNQk9MKF9fcmVnaXN0ZXJfY2hyZGV2KTsKIEVYUE9SVF9TWU1C
T0woX191bnJlZ2lzdGVyX2NocmRldik7CmRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2NkZXYu
aCBiL2luY2x1ZGUvbGludXgvY2Rldi5oCmluZGV4IGY4NzYzNjE1YTVmMi4uNDA4YmMwOWNlNDk3
IDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L2NkZXYuaAorKysgYi9pbmNsdWRlL2xpbnV4L2Nk
ZXYuaApAQCAtNCw2ICs0LDcgQEAKICNpbmNsdWRlIDxsaW51eC9rb2JqZWN0Lmg+CiAjaW5jbHVk
ZSA8bGludXgva2Rldl90Lmg+CiAjaW5jbHVkZSA8bGludXgvbGlzdC5oPgorI2luY2x1ZGUgPGxp
bnV4L2RldmljZS5oPgogCiBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zOwogc3RydWN0IGlub2RlOwpA
QCAtMjYsNiArMjcsMTAgQEAgdm9pZCBjZGV2X3B1dChzdHJ1Y3QgY2RldiAqcCk7CiAKIGludCBj
ZGV2X2FkZChzdHJ1Y3QgY2RldiAqLCBkZXZfdCwgdW5zaWduZWQpOwogCit2b2lkIGNkZXZfc2V0
X3BhcmVudChzdHJ1Y3QgY2RldiAqcCwgc3RydWN0IGtvYmplY3QgKmtvYmopOworaW50IGNkZXZf
ZGV2aWNlX2FkZChzdHJ1Y3QgY2RldiAqY2Rldiwgc3RydWN0IGRldmljZSAqZGV2KTsKK3ZvaWQg
Y2Rldl9kZXZpY2VfZGVsKHN0cnVjdCBjZGV2ICpjZGV2LCBzdHJ1Y3QgZGV2aWNlICpkZXYpOwor
CiB2b2lkIGNkZXZfZGVsKHN0cnVjdCBjZGV2ICopOwogCiB2b2lkIGNkX2ZvcmdldChzdHJ1Y3Qg
aW5vZGUgKik7CgpGcm9tIDk5Yzk1MWE4N2IyMmMwZjQ2NTJkZmY5MmM4NWYyZTRjZTdhMWQ2ZGQg
TW9uIFNlcCAxNyAwMDowMDowMCAyMDAxCkZyb206IFl1ZUhhaWJpbmcgPHl1ZWhhaWJpbmdAaHVh
d2VpLmNvbT4KRGF0ZTogRnJpLCAyMyBOb3YgMjAxOCAwOTo1NDo1NSArMDgwMApTdWJqZWN0OiBw
dHA6IEZpeCBwYXNzIHplcm8gdG8gRVJSX1BUUigpIGluIHB0cF9jbG9ja19yZWdpc3RlcgoKY29t
bWl0IGFlYTBhODk3YWY5ZTQ0YzI1OGU4YWI5Mjk2ZmFkNDE3ZjFiYzA2M2EgdXBzdHJlYW0uCgpG
aXggc21hdGNoIHdhcm5pbmc6Cgpkcml2ZXJzL3B0cC9wdHBfY2xvY2suYzoyOTggcHRwX2Nsb2Nr
X3JlZ2lzdGVyKCkgd2FybjoKIHBhc3NpbmcgemVybyB0byAnRVJSX1BUUicKCidlcnInIHNob3Vs
ZCBiZSBzZXQgd2hpbGUgZGV2aWNlX2NyZWF0ZV93aXRoX2dyb3VwcyBhbmQKcHBzX3JlZ2lzdGVy
X3NvdXJjZSBmYWlscwoKRml4ZXM6IDg1YTY2ZTU1MDE5NSAoInB0cDogY3JlYXRlICJwaW5zIiB0
b2dldGhlciB3aXRoIHRoZSByZXN0IG9mIGF0dHJpYnV0ZXMiKQpTaWduZWQtb2ZmLWJ5OiBZdWVI
YWliaW5nIDx5dWVoYWliaW5nQGh1YXdlaS5jb20+CkFja2VkLWJ5OiBSaWNoYXJkIENvY2hyYW4g
PHJpY2hhcmRjb2NocmFuQGdtYWlsLmNvbT4KU2lnbmVkLW9mZi1ieTogRGF2aWQgUy4gTWlsbGVy
IDxkYXZlbUBkYXZlbWxvZnQubmV0PgpTaWduZWQtb2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxiZW4u
aHV0Y2hpbmdzQGNvZGV0aGluay5jby51az4KLS0tCiBkcml2ZXJzL3B0cC9wdHBfY2xvY2suYyB8
IDUgKysrKy0KIDEgZmlsZSBjaGFuZ2VkLCA0IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkK
CmRpZmYgLS1naXQgYS9kcml2ZXJzL3B0cC9wdHBfY2xvY2suYyBiL2RyaXZlcnMvcHRwL3B0cF9j
bG9jay5jCmluZGV4IDVmNWQ1NGY1MTUzZi4uYTI5NzcyNjY3Zjc5IDEwMDY0NAotLS0gYS9kcml2
ZXJzL3B0cC9wdHBfY2xvY2suYworKysgYi9kcml2ZXJzL3B0cC9wdHBfY2xvY2suYwpAQCAtMjIy
LDggKzIyMiwxMCBAQCBzdHJ1Y3QgcHRwX2Nsb2NrICpwdHBfY2xvY2tfcmVnaXN0ZXIoc3RydWN0
IHB0cF9jbG9ja19pbmZvICppbmZvLAogCXB0cC0+ZGV2ID0gZGV2aWNlX2NyZWF0ZV93aXRoX2dy
b3VwcyhwdHBfY2xhc3MsIHBhcmVudCwgcHRwLT5kZXZpZCwKIAkJCQkJICAgICBwdHAsIHB0cC0+
cGluX2F0dHJfZ3JvdXBzLAogCQkJCQkgICAgICJwdHAlZCIsIHB0cC0+aW5kZXgpOwotCWlmIChJ
U19FUlIocHRwLT5kZXYpKQorCWlmIChJU19FUlIocHRwLT5kZXYpKSB7CisJCWVyciA9IFBUUl9F
UlIocHRwLT5kZXYpOwogCQlnb3RvIG5vX2RldmljZTsKKwl9CiAKIAkvKiBSZWdpc3RlciBhIG5l
dyBQUFMgc291cmNlLiAqLwogCWlmIChpbmZvLT5wcHMpIHsKQEAgLTIzNCw2ICsyMzYsNyBAQCBz
dHJ1Y3QgcHRwX2Nsb2NrICpwdHBfY2xvY2tfcmVnaXN0ZXIoc3RydWN0IHB0cF9jbG9ja19pbmZv
ICppbmZvLAogCQlwcHMub3duZXIgPSBpbmZvLT5vd25lcjsKIAkJcHRwLT5wcHNfc291cmNlID0g
cHBzX3JlZ2lzdGVyX3NvdXJjZSgmcHBzLCBQVFBfUFBTX0RFRkFVTFRTKTsKIAkJaWYgKCFwdHAt
PnBwc19zb3VyY2UpIHsKKwkJCWVyciA9IC1FSU5WQUw7CiAJCQlwcl9lcnIoImZhaWxlZCB0byBy
ZWdpc3RlciBwcHMgc291cmNlXG4iKTsKIAkJCWdvdG8gbm9fcHBzOwogCQl9CgpGcm9tIGI0MzZh
YzIzMDBiYmFlZTZlNGViY2FkYmIxODI0MjVkYTE2MTEzZjYgTW9uIFNlcCAxNyAwMDowMDowMCAy
MDAxCkZyb206IFZsYWRpcyBEcm9ub3YgPHZkcm9ub3ZAcmVkaGF0LmNvbT4KRGF0ZTogRnJpLCAy
NyBEZWMgMjAxOSAwMzoyNjoyNyArMDEwMApTdWJqZWN0OiBwdHA6IGZpeCB0aGUgcmFjZSBiZXR3
ZWVuIHRoZSByZWxlYXNlIG9mIHB0cF9jbG9jayBhbmQgY2RldgoKY29tbWl0IGEzMzEyMWU1NDg3
YjQyNDMzOTYzNmIyNWMzNWQzYTE4MGVhYTVmNWUgdXBzdHJlYW0uCgpJbiBhIGNhc2Ugd2hlbiBh
IHB0cCBjaGFyZGV2IChsaWtlIC9kZXYvcHRwMCkgaXMgb3BlbiBidXQgYW4gdW5kZXJseWluZwpk
ZXZpY2UgaXMgcmVtb3ZlZCwgY2xvc2luZyB0aGlzIGZpbGUgbGVhZHMgdG8gYSByYWNlLiBUaGlz
IHJlcHJvZHVjZXMKZWFzaWx5IGluIGEga3ZtIHZpcnR1YWwgbWFjaGluZToKCnRzIyBjYXQgb3Bl
bnB0cDAuYwppbnQgbWFpbigpIHsgLi4uIGZwID0gZm9wZW4oIi9kZXYvcHRwMCIsICJyIik7IC4u
LiBzbGVlcCgxMCk7IH0KdHMjIHVuYW1lIC1yCjUuNS4wLXJjMy00NmNmMDUzZQp0cyMgY2F0IC9w
cm9jL2NtZGxpbmUKLi4uIHNsdWJfZGVidWc9RlpQCnRzIyBtb2Rwcm9iZSBwdHBfa3ZtCnRzIyAu
L29wZW5wdHAwICYKWzFdIDY3MApvcGVuZWQgL2Rldi9wdHAwLCBzbGVlcGluZyAxMHMuLi4KdHMj
IHJtbW9kIHB0cF9rdm0KdHMjIGxzIC9kZXYvcHRwKgpsczogY2Fubm90IGFjY2VzcyAnL2Rldi9w
dHAqJzogTm8gc3VjaCBmaWxlIG9yIGRpcmVjdG9yeQp0cyMgLi4ud29rZW4gdXAKWyAgIDQ4LjAx
MDgwOV0gZ2VuZXJhbCBwcm90ZWN0aW9uIGZhdWx0OiAwMDAwIFsjMV0gU01QClsgICA0OC4wMTI1
MDJdIENQVTogNiBQSUQ6IDY1OCBDb21tOiBvcGVucHRwMCBOb3QgdGFpbnRlZCA1LjUuMC1yYzMt
NDZjZjA1M2UgIzI1ClsgICA0OC4wMTQ2MjRdIEhhcmR3YXJlIG5hbWU6IFFFTVUgU3RhbmRhcmQg
UEMgKGk0NDBGWCArIFBJSVgsIDE5OTYpLCAuLi4KWyAgIDQ4LjAxNjI3MF0gUklQOiAwMDEwOm1v
ZHVsZV9wdXQucGFydC4wKzB4Ny8weDgwClsgICA0OC4wMTc5MzldIFJTUDogMDAxODpmZmZmYjM4
NTAwNzNiZTAwIEVGTEFHUzogMDAwMTAyMDIKWyAgIDQ4LjAxODMzOV0gUkFYOiAwMDAwMDAwMDZi
NmI2YjZiIFJCWDogNmI2YjZiNmI2YjZiNmI2YiBSQ1g6IGZmZmY4OWE0NzZjMDBhZDAKWyAgIDQ4
LjAxODkzNl0gUkRYOiBmZmZmZjY1YTA4ZDNlYTA4IFJTSTogMDAwMDAwMDAwMDAwMDI0NyBSREk6
IDZiNmI2YjZiNmI2YjZiNmIKWyAgIDQ4LjAxOTQ3MF0gLi4uICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIF5eXiBhIHNsdWIgcG9pc29uClsgICA0OC4wMjM4NTRd
IENhbGwgVHJhY2U6ClsgICA0OC4wMjQwNTBdICBfX2ZwdXQrMHgyMWYvMHgyNDAKWyAgIDQ4LjAy
NDI4OF0gIHRhc2tfd29ya19ydW4rMHg3OS8weDkwClsgICA0OC4wMjQ1NTVdICBkb19leGl0KzB4
MmFmLzB4YWIwClsgICA0OC4wMjQ3OTldICA/IHZmc193cml0ZSsweDE2YS8weDE5MApbICAgNDgu
MDI1MDgyXSAgZG9fZ3JvdXBfZXhpdCsweDM1LzB4OTAKWyAgIDQ4LjAyNTM4N10gIF9feDY0X3N5
c19leGl0X2dyb3VwKzB4Zi8weDEwClsgICA0OC4wMjU3MzddICBkb19zeXNjYWxsXzY0KzB4M2Qv
MHgxMzAKWyAgIDQ4LjAyNjA1Nl0gIGVudHJ5X1NZU0NBTExfNjRfYWZ0ZXJfaHdmcmFtZSsweDQ0
LzB4YTkKWyAgIDQ4LjAyNjQ3OV0gUklQOiAwMDMzOjB4N2Y1M2IxMjA4MmY2ClsgICA0OC4wMjY3
OTJdIC4uLgpbICAgNDguMDMwOTQ1XSBNb2R1bGVzIGxpbmtlZCBpbjogcHRwIGk2MzAwZXNiIHdh
dGNoZG9nIFtsYXN0IHVubG9hZGVkOiBwdHBfa3ZtXQpbICAgNDguMDQ1MDAxXSBGaXhpbmcgcmVj
dXJzaXZlIGZhdWx0IGJ1dCByZWJvb3QgaXMgbmVlZGVkIQoKVGhpcyBoYXBwZW5zIGluOgoKc3Rh
dGljIHZvaWQgX19mcHV0KHN0cnVjdCBmaWxlICpmaWxlKQp7ICAgLi4uCiAgICBpZiAoZmlsZS0+
Zl9vcC0+cmVsZWFzZSkKICAgICAgICBmaWxlLT5mX29wLT5yZWxlYXNlKGlub2RlLCBmaWxlKTsg
PDw8IGNkZXYgaXMga2ZyZWUnZCBoZXJlCiAgICBpZiAodW5saWtlbHkoU19JU0NIUihpbm9kZS0+
aV9tb2RlKSAmJiBpbm9kZS0+aV9jZGV2ICE9IE5VTEwgJiYKICAgICAgICAgICAgICEobW9kZSAm
IEZNT0RFX1BBVEgpKSkgewogICAgICAgIGNkZXZfcHV0KGlub2RlLT5pX2NkZXYpOyA8PDwgY2Rl
diBmaWVsZHMgYXJlIGFjY2Vzc2VkIGhlcmUKCk5hbWVseToKCl9fZnB1dCgpCiAgcG9zaXhfY2xv
Y2tfcmVsZWFzZSgpCiAgICBrcmVmX3B1dCgmY2xrLT5rcmVmLCBkZWxldGVfY2xvY2spIDw8PCB0
aGUgbGFzdCByZWZlcmVuY2UKICAgICAgZGVsZXRlX2Nsb2NrKCkKICAgICAgICBkZWxldGVfcHRw
X2Nsb2NrKCkKICAgICAgICAgIGtmcmVlKHB0cCkgPDw8IGNkZXYgaXMgZW1iZWRkZWQgaW4gcHRw
CiAgY2Rldl9wdXQKICAgIG1vZHVsZV9wdXQocC0+b3duZXIpIDw8PCAqcCBpcyBrZnJlZSdkLCBi
YW5nIQoKSGVyZSBjZGV2IGlzIGVtYmVkZGVkIGluIHBvc2l4X2Nsb2NrIHdoaWNoIGlzIGVtYmVk
ZGVkIGluIHB0cF9jbG9jay4KVGhlIHJhY2UgaGFwcGVucyBiZWNhdXNlIHB0cF9jbG9jaydzIGxp
ZmV0aW1lIGlzIGNvbnRyb2xsZWQgYnkgdHdvCnJlZmNvdW50czoga3JlZiBhbmQgY2Rldi5rb2Jq
IGluIHBvc2l4X2Nsb2NrLiBUaGlzIGlzIHdyb25nLgoKTWFrZSBwdHBfY2xvY2sncyBzeXNmcyBk
ZXZpY2UgYSBwYXJlbnQgb2YgY2RldiB3aXRoIGNkZXZfZGV2aWNlX2FkZCgpCmNyZWF0ZWQgZXNw
ZWNpYWxseSBmb3Igc3VjaCBjYXNlcy4gVGhpcyB3YXkgdGhlIHBhcmVudCBkZXZpY2Ugd2l0aCBp
dHMKcHRwX2Nsb2NrIGlzIG5vdCByZWxlYXNlZCB1bnRpbCBhbGwgcmVmZXJlbmNlcyB0byB0aGUg
Y2RldiBhcmUgcmVsZWFzZWQuClRoaXMgYWRkcyBhIHJlcXVpcmVtZW50IHRoYXQgYW4gaW5pdGlh
bGl6ZWQgYnV0IG5vdCBleHBvc2VkIHN0cnVjdApkZXZpY2Ugc2hvdWxkIGJlIHByb3ZpZGVkIHRv
IHBvc2l4X2Nsb2NrX3JlZ2lzdGVyKCkgYnkgYSBjYWxsZXIgaW5zdGVhZApvZiBhIHNpbXBsZSBk
ZXZfdC4KClRoaXMgYXBwcm9hY2ggd2FzIGFkb3B0ZWQgZnJvbSB0aGUgY29tbWl0IDcyMTM5ZGZh
MjQ2NCAoIndhdGNoZG9nOiBGaXgKdGhlIHJhY2UgYmV0d2VlbiB0aGUgcmVsZWFzZSBvZiB3YXRj
aGRvZ19jb3JlX2RhdGEgYW5kIGNkZXYiKS4gU2VlCmRldGFpbHMgb2YgdGhlIGltcGxlbWVudGF0
aW9uIGluIHRoZSBjb21taXQgMjMzZWQwOWQ3ZmRhICgiY2hhcmRldjogYWRkCmhlbHBlciBmdW5j
dGlvbiB0byByZWdpc3RlciBjaGFyIGRldnMgd2l0aCBhIHN0cnVjdCBkZXZpY2UiKS4KCkxpbms6
IGh0dHBzOi8vbG9yZS5rZXJuZWwub3JnL2xpbnV4LWZzZGV2ZWwvMjAxOTExMjUxMjUzNDIuNjE4
OS0xLXZkcm9ub3ZAcmVkaGF0LmNvbS9ULyN1CkFuYWx5emVkLWJ5OiBTdGVwaGVuIEpvaG5zdG9u
IDxzam9obnN0b0ByZWRoYXQuY29tPgpBbmFseXplZC1ieTogVmVybiBMb3Zlam95IDx2bG92ZWpv
eUByZWRoYXQuY29tPgpTaWduZWQtb2ZmLWJ5OiBWbGFkaXMgRHJvbm92IDx2ZHJvbm92QHJlZGhh
dC5jb20+CkFja2VkLWJ5OiBSaWNoYXJkIENvY2hyYW4gPHJpY2hhcmRjb2NocmFuQGdtYWlsLmNv
bT4KU2lnbmVkLW9mZi1ieTogRGF2aWQgUy4gTWlsbGVyIDxkYXZlbUBkYXZlbWxvZnQubmV0PgpT
aWduZWQtb2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxiZW4uaHV0Y2hpbmdzQGNvZGV0aGluay5jby51
az4KLS0tCiBkcml2ZXJzL3B0cC9wdHBfY2xvY2suYyAgICAgfCAzMSArKysrKysrKysrKysrKy0t
LS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL3B0cC9wdHBfcHJpdmF0ZS5oICAgfCAgMiArLQogaW5j
bHVkZS9saW51eC9wb3NpeC1jbG9jay5oIHwgMTkgKysrKysrKysrKystLS0tLS0tLQoga2VybmVs
L3RpbWUvcG9zaXgtY2xvY2suYyAgIHwgMzEgKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0t
LQogNCBmaWxlcyBjaGFuZ2VkLCAzOSBpbnNlcnRpb25zKCspLCA0NCBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL3B0cC9wdHBfY2xvY2suYyBiL2RyaXZlcnMvcHRwL3B0cF9jbG9j
ay5jCmluZGV4IGEyOTc3MjY2N2Y3OS4uOTc3YjUyZGJjYmJhIDEwMDY0NAotLS0gYS9kcml2ZXJz
L3B0cC9wdHBfY2xvY2suYworKysgYi9kcml2ZXJzL3B0cC9wdHBfY2xvY2suYwpAQCAtMTcxLDkg
KzE3MSw5IEBAIHN0YXRpYyBzdHJ1Y3QgcG9zaXhfY2xvY2tfb3BlcmF0aW9ucyBwdHBfY2xvY2tf
b3BzID0gewogCS5yZWFkCQk9IHB0cF9yZWFkLAogfTsKIAotc3RhdGljIHZvaWQgZGVsZXRlX3B0
cF9jbG9jayhzdHJ1Y3QgcG9zaXhfY2xvY2sgKnBjKQorc3RhdGljIHZvaWQgcHRwX2Nsb2NrX3Jl
bGVhc2Uoc3RydWN0IGRldmljZSAqZGV2KQogewotCXN0cnVjdCBwdHBfY2xvY2sgKnB0cCA9IGNv
bnRhaW5lcl9vZihwYywgc3RydWN0IHB0cF9jbG9jaywgY2xvY2spOworCXN0cnVjdCBwdHBfY2xv
Y2sgKnB0cCA9IGNvbnRhaW5lcl9vZihkZXYsIHN0cnVjdCBwdHBfY2xvY2ssIGRldik7CiAKIAlt
dXRleF9kZXN0cm95KCZwdHAtPnRzZXZxX211eCk7CiAJbXV0ZXhfZGVzdHJveSgmcHRwLT5waW5j
ZmdfbXV4KTsKQEAgLTIwNSw3ICsyMDUsNiBAQCBzdHJ1Y3QgcHRwX2Nsb2NrICpwdHBfY2xvY2tf
cmVnaXN0ZXIoc3RydWN0IHB0cF9jbG9ja19pbmZvICppbmZvLAogCX0KIAogCXB0cC0+Y2xvY2su
b3BzID0gcHRwX2Nsb2NrX29wczsKLQlwdHAtPmNsb2NrLnJlbGVhc2UgPSBkZWxldGVfcHRwX2Ns
b2NrOwogCXB0cC0+aW5mbyA9IGluZm87CiAJcHRwLT5kZXZpZCA9IE1LREVWKG1ham9yLCBpbmRl
eCk7CiAJcHRwLT5pbmRleCA9IGluZGV4OwpAQCAtMjE4LDE1ICsyMTcsNiBAQCBzdHJ1Y3QgcHRw
X2Nsb2NrICpwdHBfY2xvY2tfcmVnaXN0ZXIoc3RydWN0IHB0cF9jbG9ja19pbmZvICppbmZvLAog
CWlmIChlcnIpCiAJCWdvdG8gbm9fcGluX2dyb3VwczsKIAotCS8qIENyZWF0ZSBhIG5ldyBkZXZp
Y2UgaW4gb3VyIGNsYXNzLiAqLwotCXB0cC0+ZGV2ID0gZGV2aWNlX2NyZWF0ZV93aXRoX2dyb3Vw
cyhwdHBfY2xhc3MsIHBhcmVudCwgcHRwLT5kZXZpZCwKLQkJCQkJICAgICBwdHAsIHB0cC0+cGlu
X2F0dHJfZ3JvdXBzLAotCQkJCQkgICAgICJwdHAlZCIsIHB0cC0+aW5kZXgpOwotCWlmIChJU19F
UlIocHRwLT5kZXYpKSB7Ci0JCWVyciA9IFBUUl9FUlIocHRwLT5kZXYpOwotCQlnb3RvIG5vX2Rl
dmljZTsKLQl9Ci0KIAkvKiBSZWdpc3RlciBhIG5ldyBQUFMgc291cmNlLiAqLwogCWlmIChpbmZv
LT5wcHMpIHsKIAkJc3RydWN0IHBwc19zb3VyY2VfaW5mbyBwcHM7CkBAIC0yNDIsOCArMjMyLDE4
IEBAIHN0cnVjdCBwdHBfY2xvY2sgKnB0cF9jbG9ja19yZWdpc3RlcihzdHJ1Y3QgcHRwX2Nsb2Nr
X2luZm8gKmluZm8sCiAJCX0KIAl9CiAKLQkvKiBDcmVhdGUgYSBwb3NpeCBjbG9jay4gKi8KLQll
cnIgPSBwb3NpeF9jbG9ja19yZWdpc3RlcigmcHRwLT5jbG9jaywgcHRwLT5kZXZpZCk7CisJLyog
SW5pdGlhbGl6ZSBhIG5ldyBkZXZpY2Ugb2Ygb3VyIGNsYXNzIGluIG91ciBjbG9jayBzdHJ1Y3R1
cmUuICovCisJZGV2aWNlX2luaXRpYWxpemUoJnB0cC0+ZGV2KTsKKwlwdHAtPmRldi5kZXZ0ID0g
cHRwLT5kZXZpZDsKKwlwdHAtPmRldi5jbGFzcyA9IHB0cF9jbGFzczsKKwlwdHAtPmRldi5wYXJl
bnQgPSBwYXJlbnQ7CisJcHRwLT5kZXYuZ3JvdXBzID0gcHRwLT5waW5fYXR0cl9ncm91cHM7CisJ
cHRwLT5kZXYucmVsZWFzZSA9IHB0cF9jbG9ja19yZWxlYXNlOworCWRldl9zZXRfZHJ2ZGF0YSgm
cHRwLT5kZXYsIHB0cCk7CisJZGV2X3NldF9uYW1lKCZwdHAtPmRldiwgInB0cCVkIiwgcHRwLT5p
bmRleCk7CisKKwkvKiBDcmVhdGUgYSBwb3NpeCBjbG9jayBhbmQgbGluayBpdCB0byB0aGUgZGV2
aWNlLiAqLworCWVyciA9IHBvc2l4X2Nsb2NrX3JlZ2lzdGVyKCZwdHAtPmNsb2NrLCAmcHRwLT5k
ZXYpOwogCWlmIChlcnIpIHsKIAkJcHJfZXJyKCJmYWlsZWQgdG8gY3JlYXRlIHBvc2l4IGNsb2Nr
XG4iKTsKIAkJZ290byBub19jbG9jazsKQEAgLTI1NSw4ICsyNTUsNiBAQCBub19jbG9jazoKIAlp
ZiAocHRwLT5wcHNfc291cmNlKQogCQlwcHNfdW5yZWdpc3Rlcl9zb3VyY2UocHRwLT5wcHNfc291
cmNlKTsKIG5vX3BwczoKLQlkZXZpY2VfZGVzdHJveShwdHBfY2xhc3MsIHB0cC0+ZGV2aWQpOwot
bm9fZGV2aWNlOgogCXB0cF9jbGVhbnVwX3Bpbl9ncm91cHMocHRwKTsKIG5vX3Bpbl9ncm91cHM6
CiAJbXV0ZXhfZGVzdHJveSgmcHRwLT50c2V2cV9tdXgpOwpAQCAtMjc3LDcgKzI3NSw2IEBAIGlu
dCBwdHBfY2xvY2tfdW5yZWdpc3RlcihzdHJ1Y3QgcHRwX2Nsb2NrICpwdHApCiAJaWYgKHB0cC0+
cHBzX3NvdXJjZSkKIAkJcHBzX3VucmVnaXN0ZXJfc291cmNlKHB0cC0+cHBzX3NvdXJjZSk7CiAK
LQlkZXZpY2VfZGVzdHJveShwdHBfY2xhc3MsIHB0cC0+ZGV2aWQpOwogCXB0cF9jbGVhbnVwX3Bp
bl9ncm91cHMocHRwKTsKIAogCXBvc2l4X2Nsb2NrX3VucmVnaXN0ZXIoJnB0cC0+Y2xvY2spOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9wdHAvcHRwX3ByaXZhdGUuaCBiL2RyaXZlcnMvcHRwL3B0cF9w
cml2YXRlLmgKaW5kZXggZDk1ODg4OTc0ZDBjLi4xNTM0NmU4NDBjYWEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvcHRwL3B0cF9wcml2YXRlLmgKKysrIGIvZHJpdmVycy9wdHAvcHRwX3ByaXZhdGUuaApA
QCAtNDAsNyArNDAsNyBAQCBzdHJ1Y3QgdGltZXN0YW1wX2V2ZW50X3F1ZXVlIHsKIAogc3RydWN0
IHB0cF9jbG9jayB7CiAJc3RydWN0IHBvc2l4X2Nsb2NrIGNsb2NrOwotCXN0cnVjdCBkZXZpY2Ug
KmRldjsKKwlzdHJ1Y3QgZGV2aWNlIGRldjsKIAlzdHJ1Y3QgcHRwX2Nsb2NrX2luZm8gKmluZm87
CiAJZGV2X3QgZGV2aWQ7CiAJaW50IGluZGV4OyAvKiBpbmRleCBpbnRvIGNsb2Nrcy5tYXAgKi8K
ZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvcG9zaXgtY2xvY2suaCBiL2luY2x1ZGUvbGludXgv
cG9zaXgtY2xvY2suaAppbmRleCA4M2IyMmFlOWFlMTIuLmIzOTQyMGEwMzIxYyAxMDA2NDQKLS0t
IGEvaW5jbHVkZS9saW51eC9wb3NpeC1jbG9jay5oCisrKyBiL2luY2x1ZGUvbGludXgvcG9zaXgt
Y2xvY2suaApAQCAtMTA0LDI5ICsxMDQsMzIgQEAgc3RydWN0IHBvc2l4X2Nsb2NrX29wZXJhdGlv
bnMgewogICoKICAqIEBvcHM6ICAgICBGdW5jdGlvbmFsIGludGVyZmFjZSB0byB0aGUgY2xvY2sK
ICAqIEBjZGV2OiAgICBDaGFyYWN0ZXIgZGV2aWNlIGluc3RhbmNlIGZvciB0aGlzIGNsb2NrCi0g
KiBAa3JlZjogICAgUmVmZXJlbmNlIGNvdW50LgorICogQGRldjogICAgIFBvaW50ZXIgdG8gdGhl
IGNsb2NrJ3MgZGV2aWNlLgogICogQHJ3c2VtOiAgIFByb3RlY3RzIHRoZSAnem9tYmllJyBmaWVs
ZCBmcm9tIGNvbmN1cnJlbnQgYWNjZXNzLgogICogQHpvbWJpZTogIElmICd6b21iaWUnIGlzIHRy
dWUsIHRoZW4gdGhlIGhhcmR3YXJlIGhhcyBkaXNhcHBlYXJlZC4KLSAqIEByZWxlYXNlOiBBIGZ1
bmN0aW9uIHRvIGZyZWUgdGhlIHN0cnVjdHVyZSB3aGVuIHRoZSByZWZlcmVuY2UgY291bnQgcmVh
Y2hlcwotICogICAgICAgICAgIHplcm8uIE1heSBiZSBOVUxMIGlmIHN0cnVjdHVyZSBpcyBzdGF0
aWNhbGx5IGFsbG9jYXRlZC4KICAqCiAgKiBEcml2ZXJzIHNob3VsZCBlbWJlZCB0aGVpciBzdHJ1
Y3QgcG9zaXhfY2xvY2sgd2l0aGluIGEgcHJpdmF0ZQogICogc3RydWN0dXJlLCBvYnRhaW5pbmcg
YSByZWZlcmVuY2UgdG8gaXQgZHVyaW5nIGNhbGxiYWNrcyB1c2luZwogICogY29udGFpbmVyX29m
KCkuCisgKgorICogRHJpdmVycyBzaG91bGQgc3VwcGx5IGFuIGluaXRpYWxpemVkIGJ1dCBub3Qg
ZXhwb3NlZCBzdHJ1Y3QgZGV2aWNlCisgKiB0byBwb3NpeF9jbG9ja19yZWdpc3RlcigpLiBJdCBp
cyB1c2VkIHRvIG1hbmFnZSBsaWZldGltZSBvZiB0aGUKKyAqIGRyaXZlcidzIHByaXZhdGUgc3Ry
dWN0dXJlLiBJdCdzICdyZWxlYXNlJyBmaWVsZCBzaG91bGQgYmUgc2V0IHRvCisgKiBhIHJlbGVh
c2UgZnVuY3Rpb24gZm9yIHRoaXMgcHJpdmF0ZSBzdHJ1Y3R1cmUuCiAgKi8KIHN0cnVjdCBwb3Np
eF9jbG9jayB7CiAJc3RydWN0IHBvc2l4X2Nsb2NrX29wZXJhdGlvbnMgb3BzOwogCXN0cnVjdCBj
ZGV2IGNkZXY7Ci0Jc3RydWN0IGtyZWYga3JlZjsKKwlzdHJ1Y3QgZGV2aWNlICpkZXY7CiAJc3Ry
dWN0IHJ3X3NlbWFwaG9yZSByd3NlbTsKIAlib29sIHpvbWJpZTsKLQl2b2lkICgqcmVsZWFzZSko
c3RydWN0IHBvc2l4X2Nsb2NrICpjbGspOwogfTsKIAogLyoqCiAgKiBwb3NpeF9jbG9ja19yZWdp
c3RlcigpIC0gcmVnaXN0ZXIgYSBuZXcgY2xvY2sKLSAqIEBjbGs6ICAgUG9pbnRlciB0byB0aGUg
Y2xvY2suIENhbGxlciBtdXN0IHByb3ZpZGUgJ29wcycgYW5kICdyZWxlYXNlJwotICogQGRldmlk
OiBBbGxvY2F0ZWQgZGV2aWNlIGlkCisgKiBAY2xrOiAgIFBvaW50ZXIgdG8gdGhlIGNsb2NrLiBD
YWxsZXIgbXVzdCBwcm92aWRlICdvcHMnIGZpZWxkCisgKiBAZGV2OiAgIFBvaW50ZXIgdG8gdGhl
IGluaXRpYWxpemVkIGRldmljZS4gQ2FsbGVyIG11c3QgcHJvdmlkZQorICogICAgICAgICAncmVs
ZWFzZScgZmllbGQKICAqCiAgKiBBIGNsb2NrIGRyaXZlciBjYWxscyB0aGlzIGZ1bmN0aW9uIHRv
IHJlZ2lzdGVyIGl0c2VsZiB3aXRoIHRoZQogICogY2xvY2sgZGV2aWNlIHN1YnN5c3RlbS4gSWYg
J2NsaycgcG9pbnRzIHRvIGR5bmFtaWNhbGx5IGFsbG9jYXRlZApAQCAtMTM1LDcgKzEzOCw3IEBA
IHN0cnVjdCBwb3NpeF9jbG9jayB7CiAgKgogICogUmV0dXJucyB6ZXJvIG9uIHN1Y2Nlc3MsIG5v
bi16ZXJvIG90aGVyd2lzZS4KICAqLwotaW50IHBvc2l4X2Nsb2NrX3JlZ2lzdGVyKHN0cnVjdCBw
b3NpeF9jbG9jayAqY2xrLCBkZXZfdCBkZXZpZCk7CitpbnQgcG9zaXhfY2xvY2tfcmVnaXN0ZXIo
c3RydWN0IHBvc2l4X2Nsb2NrICpjbGssIHN0cnVjdCBkZXZpY2UgKmRldik7CiAKIC8qKgogICog
cG9zaXhfY2xvY2tfdW5yZWdpc3RlcigpIC0gdW5yZWdpc3RlciBhIGNsb2NrCmRpZmYgLS1naXQg
YS9rZXJuZWwvdGltZS9wb3NpeC1jbG9jay5jIGIva2VybmVsL3RpbWUvcG9zaXgtY2xvY2suYwpp
bmRleCBlMjQwMDhjMDk4YzYuLjQ1YTBhMjYwMjNkNCAxMDA2NDQKLS0tIGEva2VybmVsL3RpbWUv
cG9zaXgtY2xvY2suYworKysgYi9rZXJuZWwvdGltZS9wb3NpeC1jbG9jay5jCkBAIC0yNSw4ICsy
NSw2IEBACiAjaW5jbHVkZSA8bGludXgvc3lzY2FsbHMuaD4KICNpbmNsdWRlIDxsaW51eC91YWNj
ZXNzLmg+CiAKLXN0YXRpYyB2b2lkIGRlbGV0ZV9jbG9jayhzdHJ1Y3Qga3JlZiAqa3JlZik7Ci0K
IC8qCiAgKiBSZXR1cm5zIE5VTEwgaWYgdGhlIHBvc2l4X2Nsb2NrIGluc3RhbmNlIGF0dGFjaGVk
IHRvICdmcCcgaXMgb2xkIGFuZCBzdGFsZS4KICAqLwpAQCAtMTY4LDcgKzE2Niw3IEBAIHN0YXRp
YyBpbnQgcG9zaXhfY2xvY2tfb3BlbihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAq
ZnApCiAJCWVyciA9IDA7CiAKIAlpZiAoIWVycikgewotCQlrcmVmX2dldCgmY2xrLT5rcmVmKTsK
KwkJZ2V0X2RldmljZShjbGstPmRldik7CiAJCWZwLT5wcml2YXRlX2RhdGEgPSBjbGs7CiAJfQog
b3V0OgpAQCAtMTg0LDcgKzE4Miw3IEBAIHN0YXRpYyBpbnQgcG9zaXhfY2xvY2tfcmVsZWFzZShz
dHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZnApCiAJaWYgKGNsay0+b3BzLnJlbGVh
c2UpCiAJCWVyciA9IGNsay0+b3BzLnJlbGVhc2UoY2xrKTsKIAotCWtyZWZfcHV0KCZjbGstPmty
ZWYsIGRlbGV0ZV9jbG9jayk7CisJcHV0X2RldmljZShjbGstPmRldik7CiAKIAlmcC0+cHJpdmF0
ZV9kYXRhID0gTlVMTDsKIApAQCAtMjA2LDM4ICsyMDQsMzUgQEAgc3RhdGljIGNvbnN0IHN0cnVj
dCBmaWxlX29wZXJhdGlvbnMgcG9zaXhfY2xvY2tfZmlsZV9vcGVyYXRpb25zID0gewogI2VuZGlm
CiB9OwogCi1pbnQgcG9zaXhfY2xvY2tfcmVnaXN0ZXIoc3RydWN0IHBvc2l4X2Nsb2NrICpjbGss
IGRldl90IGRldmlkKQoraW50IHBvc2l4X2Nsb2NrX3JlZ2lzdGVyKHN0cnVjdCBwb3NpeF9jbG9j
ayAqY2xrLCBzdHJ1Y3QgZGV2aWNlICpkZXYpCiB7CiAJaW50IGVycjsKIAotCWtyZWZfaW5pdCgm
Y2xrLT5rcmVmKTsKIAlpbml0X3J3c2VtKCZjbGstPnJ3c2VtKTsKIAogCWNkZXZfaW5pdCgmY2xr
LT5jZGV2LCAmcG9zaXhfY2xvY2tfZmlsZV9vcGVyYXRpb25zKTsKKwllcnIgPSBjZGV2X2Rldmlj
ZV9hZGQoJmNsay0+Y2RldiwgZGV2KTsKKwlpZiAoZXJyKSB7CisJCXByX2VycigiJXMgdW5hYmxl
IHRvIGFkZCBkZXZpY2UgJWQ6JWRcbiIsCisJCQlkZXZfbmFtZShkZXYpLCBNQUpPUihkZXYtPmRl
dnQpLCBNSU5PUihkZXYtPmRldnQpKTsKKwkJcmV0dXJuIGVycjsKKwl9CiAJY2xrLT5jZGV2Lm93
bmVyID0gY2xrLT5vcHMub3duZXI7Ci0JZXJyID0gY2Rldl9hZGQoJmNsay0+Y2RldiwgZGV2aWQs
IDEpOworCWNsay0+ZGV2ID0gZGV2OwogCi0JcmV0dXJuIGVycjsKKwlyZXR1cm4gMDsKIH0KIEVY
UE9SVF9TWU1CT0xfR1BMKHBvc2l4X2Nsb2NrX3JlZ2lzdGVyKTsKIAotc3RhdGljIHZvaWQgZGVs
ZXRlX2Nsb2NrKHN0cnVjdCBrcmVmICprcmVmKQotewotCXN0cnVjdCBwb3NpeF9jbG9jayAqY2xr
ID0gY29udGFpbmVyX29mKGtyZWYsIHN0cnVjdCBwb3NpeF9jbG9jaywga3JlZik7Ci0KLQlpZiAo
Y2xrLT5yZWxlYXNlKQotCQljbGstPnJlbGVhc2UoY2xrKTsKLX0KLQogdm9pZCBwb3NpeF9jbG9j
a191bnJlZ2lzdGVyKHN0cnVjdCBwb3NpeF9jbG9jayAqY2xrKQogewotCWNkZXZfZGVsKCZjbGst
PmNkZXYpOworCWNkZXZfZGV2aWNlX2RlbCgmY2xrLT5jZGV2LCBjbGstPmRldik7CiAKIAlkb3du
X3dyaXRlKCZjbGstPnJ3c2VtKTsKIAljbGstPnpvbWJpZSA9IHRydWU7CiAJdXBfd3JpdGUoJmNs
ay0+cndzZW0pOwogCi0Ja3JlZl9wdXQoJmNsay0+a3JlZiwgZGVsZXRlX2Nsb2NrKTsKKwlwdXRf
ZGV2aWNlKGNsay0+ZGV2KTsKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKHBvc2l4X2Nsb2NrX3VucmVn
aXN0ZXIpOwogCgpGcm9tIDQ4OWFkN2ZkMWM3YTUxNDA0NTJiMDBkY2ZhMjNmYWVhYWUwZmRhMjEg
TW9uIFNlcCAxNyAwMDowMDowMCAyMDAxCkZyb206IFZsYWRpcyBEcm9ub3YgPHZkcm9ub3ZAcmVk
aGF0LmNvbT4KRGF0ZTogTW9uLCAxMyBKYW4gMjAyMCAxNDowMDowOSArMDEwMApTdWJqZWN0OiBw
dHA6IGZyZWUgcHRwIGRldmljZSBwaW4gZGVzY3JpcHRvcnMgcHJvcGVybHkKCmNvbW1pdCA3NTcx
ODU4NGNiM2M2NGU2MjY5MTA5ZDRkNTRmODg4YWM1YTVmZDE1IHVwc3RyZWFtLgoKVGhlcmUgaXMg
YSBidWcgaW4gcHRwX2Nsb2NrX3VucmVnaXN0ZXIoKSwgd2hlcmUgcHRwX2NsZWFudXBfcGluX2dy
b3VwcygpCmZpcnN0IGZyZWVzIHB0cC0+cGluX3ssZGV2X31hdHRyLCBidXQgdGhlbiBwb3NpeF9j
bG9ja191bnJlZ2lzdGVyKCkgbmVlZHMKdGhlbSB0byBkZXN0cm95IGEgcmVsYXRlZCBzeXNmcyBk
ZXZpY2UuCgpUaGVzZSBmdW5jdGlvbnMgY2FuIG5vdCBiZSBqdXN0IHN3YXBwZWQsIGFzIHBvc2l4
X2Nsb2NrX3VucmVnaXN0ZXIoKSBmcmVlcwpwdHAgd2hpY2ggaXMgbmVlZGVkIGluIHRoZSBwdHBf
Y2xlYW51cF9waW5fZ3JvdXBzKCkuIEZpeCB0aGlzIGJ5IGNhbGxpbmcKcHRwX2NsZWFudXBfcGlu
X2dyb3VwcygpIGluIHB0cF9jbG9ja19yZWxlYXNlKCksIHJpZ2h0IGJlZm9yZSBwdHAgaXMgZnJl
ZWQuCgpUaGlzIG1ha2VzIHRoaXMgcGF0Y2ggZml4IGFuIFVBRiBidWcgaW4gYSBwYXRjaCB3aGlj
aCBmaXhlcyBhbiBVQUYgYnVnLgoKUmVwb3J0ZWQtYnk6IEFudHRpIExhYWtzbyA8YW50dGkubGFh
a3NvQGludGVsLmNvbT4KRml4ZXM6IGEzMzEyMWU1NDg3YiAoInB0cDogZml4IHRoZSByYWNlIGJl
dHdlZW4gdGhlIHJlbGVhc2Ugb2YgcHRwX2Nsb2NrIGFuZCBjZGV2IikKTGluazogaHR0cHM6Ly9s
b3JlLmtlcm5lbC5vcmcvbmV0ZGV2LzNkMmJkMDk3MzVkYmRhZjAwMzU4NWNhMzc2YjdjMWU1YjY5
YTE5YmQuY2FtZWxAaW50ZWwuY29tLwpTaWduZWQtb2ZmLWJ5OiBWbGFkaXMgRHJvbm92IDx2ZHJv
bm92QHJlZGhhdC5jb20+CkFja2VkLWJ5OiBSaWNoYXJkIENvY2hyYW4gPHJpY2hhcmRjb2NocmFu
QGdtYWlsLmNvbT4KU2lnbmVkLW9mZi1ieTogRGF2aWQgUy4gTWlsbGVyIDxkYXZlbUBkYXZlbWxv
ZnQubmV0PgpTaWduZWQtb2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxiZW4uaHV0Y2hpbmdzQGNvZGV0
aGluay5jby51az4KLS0tCiBkcml2ZXJzL3B0cC9wdHBfY2xvY2suYyB8IDQgKystLQogMSBmaWxl
IGNoYW5nZWQsIDIgaW5zZXJ0aW9ucygrKSwgMiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9k
cml2ZXJzL3B0cC9wdHBfY2xvY2suYyBiL2RyaXZlcnMvcHRwL3B0cF9jbG9jay5jCmluZGV4IDk3
N2I1MmRiY2JiYS4uZWZlNjhiMTM3MDRkIDEwMDY0NAotLS0gYS9kcml2ZXJzL3B0cC9wdHBfY2xv
Y2suYworKysgYi9kcml2ZXJzL3B0cC9wdHBfY2xvY2suYwpAQCAtMTc1LDYgKzE3NSw3IEBAIHN0
YXRpYyB2b2lkIHB0cF9jbG9ja19yZWxlYXNlKHN0cnVjdCBkZXZpY2UgKmRldikKIHsKIAlzdHJ1
Y3QgcHRwX2Nsb2NrICpwdHAgPSBjb250YWluZXJfb2YoZGV2LCBzdHJ1Y3QgcHRwX2Nsb2NrLCBk
ZXYpOwogCisJcHRwX2NsZWFudXBfcGluX2dyb3VwcyhwdHApOwogCW11dGV4X2Rlc3Ryb3koJnB0
cC0+dHNldnFfbXV4KTsKIAltdXRleF9kZXN0cm95KCZwdHAtPnBpbmNmZ19tdXgpOwogCWlkYV9z
aW1wbGVfcmVtb3ZlKCZwdHBfY2xvY2tzX21hcCwgcHRwLT5pbmRleCk7CkBAIC0yNzUsOSArMjc2
LDggQEAgaW50IHB0cF9jbG9ja191bnJlZ2lzdGVyKHN0cnVjdCBwdHBfY2xvY2sgKnB0cCkKIAlp
ZiAocHRwLT5wcHNfc291cmNlKQogCQlwcHNfdW5yZWdpc3Rlcl9zb3VyY2UocHRwLT5wcHNfc291
cmNlKTsKIAotCXB0cF9jbGVhbnVwX3Bpbl9ncm91cHMocHRwKTsKLQogCXBvc2l4X2Nsb2NrX3Vu
cmVnaXN0ZXIoJnB0cC0+Y2xvY2spOworCiAJcmV0dXJuIDA7CiB9CiBFWFBPUlRfU1lNQk9MKHB0
cF9jbG9ja191bnJlZ2lzdGVyKTsK


--=-sm3amSSQ2Cx2K8vGyMQj--

