Return-Path: <stable-owner@vger.kernel.org>
X-Original-To: lists+stable@lfdr.de
Delivered-To: lists+stable@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id C4EFE1CFDA7
	for <lists+stable@lfdr.de>; Tue, 12 May 2020 20:46:46 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1725554AbgELSqp (ORCPT <rfc822;lists+stable@lfdr.de>);
        Tue, 12 May 2020 14:46:45 -0400
Received: from imap2.colo.codethink.co.uk ([78.40.148.184]:34958 "EHLO
        imap2.colo.codethink.co.uk" rhost-flags-OK-OK-OK-OK)
        by vger.kernel.org with ESMTP id S1725987AbgELSqo (ORCPT
        <rfc822;stable@vger.kernel.org>); Tue, 12 May 2020 14:46:44 -0400
Received: from shadbolt.e.decadent.org.uk ([88.96.1.126] helo=xylophone)
        by imap2.colo.codethink.co.uk with esmtpsa  (Exim 4.92 #3 (Debian))
        id 1jYZvJ-0005R0-CA; Tue, 12 May 2020 19:46:37 +0100
Message-ID: <48426ffc013c1f59df8357ae6f9d5b5ffa5d6812.camel@codethink.co.uk>
Subject: [4.9-stable] Security fixes
From:   Ben Hutchings <ben.hutchings@codethink.co.uk>
To:     Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
        Sasha Levin <Alexander.Levin@microsoft.com>
Cc:     stable <stable@vger.kernel.org>
Date:   Tue, 12 May 2020 19:46:35 +0100
Organization: Codethink Ltd.
Content-Type: multipart/mixed; boundary="=-EHwstzCwUMQpJPrpPoxo"
User-Agent: Evolution 3.30.5-1.1 
MIME-Version: 1.0
Sender: stable-owner@vger.kernel.org
Precedence: bulk
List-ID: <stable.vger.kernel.org>
X-Mailing-List: stable@vger.kernel.org


--=-EHwstzCwUMQpJPrpPoxo
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: 7bit

Here are some fixes that required backporting for 4.9.  All of them
are already present in (or queued for) later stable branches.

Ben.

-- 
Ben Hutchings, Software Developer                         Codethink Ltd
https://www.codethink.co.uk/                 Dale House, 35 Dale Street
                                     Manchester, M1 2HF, United Kingdom

--=-EHwstzCwUMQpJPrpPoxo
Content-Type: application/mbox; name="security-4.9.mbox"
Content-Disposition: attachment; filename="security-4.9.mbox"
Content-Transfer-Encoding: base64

RnJvbSAwZjdhZDg4NzQ3NTE5YmEyNGVkYjRmNmMzOGNlODI0MTM2MzdjZGFiIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBTaGlqaWUgTHVvIDxsdW9zaGlqaWUxQGh1YXdlaS5jb20+CkRh
dGU6IE1vbiwgMTAgRmViIDIwMjAgMjA6MTc6NTIgLTA1MDAKU3ViamVjdDogZXh0NDogYWRkIGNv
bmRfcmVzY2hlZCgpIHRvIGV4dDRfcHJvdGVjdF9yZXNlcnZlZF9pbm9kZQoKY29tbWl0IGFmMTMz
YWRlOWE0MDc5NGEzNzEwNGVjYmNjMjgyN2MwZWEzNzNhM2MgdXBzdHJlYW0uCgpXaGVuIGpvdXJu
YWwgc2l6ZSBpcyBzZXQgdG9vIGJpZyBieSAibWtmcy5leHQ0IC1KIHNpemU9Iiwgb3Igd2hlbgp3
ZSBtb3VudCBhIGNyYWZ0ZWQgaW1hZ2UgdG8gbWFrZSBqb3VybmFsIGlub2RlLT5pX3NpemUgdG9v
IGJpZywKdGhlIGxvb3AsICJ3aGlsZSAoaSA8IG51bSkiLCBob2xkcyBjcHUgdG9vIGxvbmcuIFRo
aXMgY291bGQgY2F1c2UKc29mdCBsb2NrdXAuCgpbICA1MjkuMzU3NTQxXSBDYWxsIHRyYWNlOgpb
ICA1MjkuMzU3NTUxXSAgZHVtcF9iYWNrdHJhY2UrMHgwLzB4MTk4ClsgIDUyOS4zNTc1NTVdICBz
aG93X3N0YWNrKzB4MjQvMHgzMApbICA1MjkuMzU3NTYyXSAgZHVtcF9zdGFjaysweGE0LzB4Y2MK
WyAgNTI5LjM1NzU2OF0gIHdhdGNoZG9nX3RpbWVyX2ZuKzB4MzAwLzB4M2U4ClsgIDUyOS4zNTc1
NzRdICBfX2hydGltZXJfcnVuX3F1ZXVlcysweDExNC8weDM1OApbICA1MjkuMzU3NTc2XSAgaHJ0
aW1lcl9pbnRlcnJ1cHQrMHgxMDQvMHgyZDgKWyAgNTI5LjM1NzU4MF0gIGFyY2hfdGltZXJfaGFu
ZGxlcl92aXJ0KzB4MzgvMHg1OApbICA1MjkuMzU3NTg0XSAgaGFuZGxlX3BlcmNwdV9kZXZpZF9p
cnErMHg5MC8weDI0OApbICA1MjkuMzU3NTg4XSAgZ2VuZXJpY19oYW5kbGVfaXJxKzB4MzQvMHg1
MApbICA1MjkuMzU3NTkwXSAgX19oYW5kbGVfZG9tYWluX2lycSsweDY4LzB4YzAKWyAgNTI5LjM1
NzU5M10gIGdpY19oYW5kbGVfaXJxKzB4NmMvMHgxNTAKWyAgNTI5LjM1NzU5NV0gIGVsMV9pcnEr
MHhiOC8weDE0MApbICA1MjkuMzU3NTk5XSAgX19sbF9zY19hdG9taWNfYWRkX3JldHVybl9hY3F1
aXJlKzB4MTQvMHgyMApbICA1MjkuMzU3NjY4XSAgZXh0NF9tYXBfYmxvY2tzKzB4NjQvMHg1YzAg
W2V4dDRdClsgIDUyOS4zNTc2OTNdICBleHQ0X3NldHVwX3N5c3RlbV96b25lKzB4MzMwLzB4NDU4
IFtleHQ0XQpbICA1MjkuMzU3NzE3XSAgZXh0NF9maWxsX3N1cGVyKzB4MjE3MC8weDJiYTggW2V4
dDRdClsgIDUyOS4zNTc3MjJdICBtb3VudF9iZGV2KzB4MWE4LzB4MWU4ClsgIDUyOS4zNTc3NDZd
ICBleHQ0X21vdW50KzB4NDQvMHg1OCBbZXh0NF0KWyAgNTI5LjM1Nzc0OF0gIG1vdW50X2ZzKzB4
NTAvMHgxNzAKWyAgNTI5LjM1Nzc1Ml0gIHZmc19rZXJuX21vdW50LnBhcnQuOSsweDU0LzB4MTg4
ClsgIDUyOS4zNTc3NTVdICBkb19tb3VudCsweDVhYy8weGQ3OApbICA1MjkuMzU3NzU4XSAga3N5
c19tb3VudCsweDljLzB4MTE4ClsgIDUyOS4zNTc3NjBdICBfX2FybTY0X3N5c19tb3VudCsweDI4
LzB4MzgKWyAgNTI5LjM1Nzc2NF0gIGVsMF9zdmNfY29tbW9uKzB4NzgvMHgxMzAKWyAgNTI5LjM1
Nzc2Nl0gIGVsMF9zdmNfaGFuZGxlcisweDM4LzB4NzgKWyAgNTI5LjM1Nzc2OV0gIGVsMF9zdmMr
MHg4LzB4YwpbICA1NDEuMzU2NTE2XSB3YXRjaGRvZzogQlVHOiBzb2Z0IGxvY2t1cCAtIENQVSMw
IHN0dWNrIGZvciAyM3MhIFttb3VudDoxODY3NF0KCkxpbms6IGh0dHBzOi8vbG9yZS5rZXJuZWwu
b3JnL3IvMjAyMDAyMTEwMTE3NTIuMjkyNDItMS1sdW9zaGlqaWUxQGh1YXdlaS5jb20KUmV2aWV3
ZWQtYnk6IEphbiBLYXJhIDxqYWNrQHN1c2UuY3o+ClNpZ25lZC1vZmYtYnk6IFNoaWppZSBMdW8g
PGx1b3NoaWppZTFAaHVhd2VpLmNvbT4KU2lnbmVkLW9mZi1ieTogVGhlb2RvcmUgVHMnbyA8dHl0
c29AbWl0LmVkdT4KQ2M6IHN0YWJsZUBrZXJuZWwub3JnClNpZ25lZC1vZmYtYnk6IEJlbiBIdXRj
aGluZ3MgPGJlbi5odXRjaGluZ3NAY29kZXRoaW5rLmNvLnVrPgotLS0KIGZzL2V4dDQvYmxvY2tf
dmFsaWRpdHkuYyB8IDEgKwogMSBmaWxlIGNoYW5nZWQsIDEgaW5zZXJ0aW9uKCspCgpkaWZmIC0t
Z2l0IGEvZnMvZXh0NC9ibG9ja192YWxpZGl0eS5jIGIvZnMvZXh0NC9ibG9ja192YWxpZGl0eS5j
CmluZGV4IGQzMWQ5M2VlNWU3Ni4uNDVjN2IwZjlhOGUzIDEwMDY0NAotLS0gYS9mcy9leHQ0L2Js
b2NrX3ZhbGlkaXR5LmMKKysrIGIvZnMvZXh0NC9ibG9ja192YWxpZGl0eS5jCkBAIC0xNTIsNiAr
MTUyLDcgQEAgc3RhdGljIGludCBleHQ0X3Byb3RlY3RfcmVzZXJ2ZWRfaW5vZGUoc3RydWN0IHN1
cGVyX2Jsb2NrICpzYiwgdTMyIGlubykKIAkJcmV0dXJuIFBUUl9FUlIoaW5vZGUpOwogCW51bSA9
IChpbm9kZS0+aV9zaXplICsgc2ItPnNfYmxvY2tzaXplIC0gMSkgPj4gc2ItPnNfYmxvY2tzaXpl
X2JpdHM7CiAJd2hpbGUgKGkgPCBudW0pIHsKKwkJY29uZF9yZXNjaGVkKCk7CiAJCW1hcC5tX2xi
bGsgPSBpOwogCQltYXAubV9sZW4gPSBudW0gLSBpOwogCQluID0gZXh0NF9tYXBfYmxvY2tzKE5V
TEwsIGlub2RlLCAmbWFwLCAwKTsKCkZyb20gNzk2NDYyZDY2YThmNzk0ODI1MzAxZTY4NWJmY2Y2
ZmNhMjdhZmZlMyBNb24gU2VwIDE3IDAwOjAwOjAwIDIwMDEKRnJvbTogU2FicmluYSBEdWJyb2Nh
IDxzZEBxdWVhc3lzbmFpbC5uZXQ+CkRhdGU6IFdlZCwgNCBEZWMgMjAxOSAxNTozNTo1MiArMDEw
MApTdWJqZWN0OiBuZXQ6IGlwdjY6IGFkZCBuZXQgYXJndW1lbnQgdG8gaXA2X2RzdF9sb29rdXBf
ZmxvdwoKY29tbWl0IGM0ZTg1ZjczYWZiNjM4NDEyM2U1ZWYxYmJhMzMxNWIyZTNhZDAzMWUgdXBz
dHJlYW0uCgpUaGlzIHdpbGwgYmUgdXNlZCBpbiB0aGUgY29udmVyc2lvbiBvZiBpcHY2X3N0dWIg
dG8gaXA2X2RzdF9sb29rdXBfZmxvdywKYXMgc29tZSBtb2R1bGVzIGN1cnJlbnRseSBwYXNzIGEg
bmV0IGFyZ3VtZW50IHdpdGhvdXQgYSBzb2NrZXQgdG8KaXA2X2RzdF9sb29rdXAuIFRoaXMgaXMg
ZXF1aXZhbGVudCB0byBjb21taXQgMzQzZDYwYWFkYTVhICgiaXB2NjogY2hhbmdlCmlwdjZfc3R1
Yl9pbXBsLmlwdjZfZHN0X2xvb2t1cCB0byB0YWtlIG5ldCBhcmd1bWVudCIpLgoKU2lnbmVkLW9m
Zi1ieTogU2FicmluYSBEdWJyb2NhIDxzZEBxdWVhc3lzbmFpbC5uZXQ+ClNpZ25lZC1vZmYtYnk6
IERhdmlkIFMuIE1pbGxlciA8ZGF2ZW1AZGF2ZW1sb2Z0Lm5ldD4KW2J3aDogQmFja3BvcnRlZCB0
byA0Ljk6IGFkanVzdCBjb250ZXh0XQpTaWduZWQtb2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxiZW4u
aHV0Y2hpbmdzQGNvZGV0aGluay5jby51az4KLS0tCiBpbmNsdWRlL25ldC9pcHY2LmggICAgICAg
ICAgICAgICB8IDIgKy0KIG5ldC9kY2NwL2lwdjYuYyAgICAgICAgICAgICAgICAgIHwgNiArKyst
LS0KIG5ldC9pcHY2L2FmX2luZXQ2LmMgICAgICAgICAgICAgIHwgMiArLQogbmV0L2lwdjYvZGF0
YWdyYW0uYyAgICAgICAgICAgICAgfCAyICstCiBuZXQvaXB2Ni9pbmV0Nl9jb25uZWN0aW9uX3Nv
Y2suYyB8IDQgKystLQogbmV0L2lwdjYvaXA2X291dHB1dC5jICAgICAgICAgICAgfCA4ICsrKyst
LS0tCiBuZXQvaXB2Ni9yYXcuYyAgICAgICAgICAgICAgICAgICB8IDIgKy0KIG5ldC9pcHY2L3N5
bmNvb2tpZXMuYyAgICAgICAgICAgIHwgMiArLQogbmV0L2lwdjYvdGNwX2lwdjYuYyAgICAgICAg
ICAgICAgfCA0ICsrLS0KIG5ldC9sMnRwL2wydHBfaXA2LmMgICAgICAgICAgICAgIHwgMiArLQog
bmV0L3NjdHAvaXB2Ni5jICAgICAgICAgICAgICAgICAgfCA0ICsrLS0KIDExIGZpbGVzIGNoYW5n
ZWQsIDE5IGluc2VydGlvbnMoKyksIDE5IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2luY2x1
ZGUvbmV0L2lwdjYuaCBiL2luY2x1ZGUvbmV0L2lwdjYuaAppbmRleCAxNjgwMDllZWY1ZTQuLjFh
NDhlMTBlYzYxNyAxMDA2NDQKLS0tIGEvaW5jbHVkZS9uZXQvaXB2Ni5oCisrKyBiL2luY2x1ZGUv
bmV0L2lwdjYuaApAQCAtODU2LDcgKzg1Niw3IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IHNrX2J1
ZmYgKmlwNl9maW5pc2hfc2tiKHN0cnVjdCBzb2NrICpzaykKIAogaW50IGlwNl9kc3RfbG9va3Vw
KHN0cnVjdCBuZXQgKm5ldCwgc3RydWN0IHNvY2sgKnNrLCBzdHJ1Y3QgZHN0X2VudHJ5ICoqZHN0
LAogCQkgICBzdHJ1Y3QgZmxvd2k2ICpmbDYpOwotc3RydWN0IGRzdF9lbnRyeSAqaXA2X2RzdF9s
b29rdXBfZmxvdyhjb25zdCBzdHJ1Y3Qgc29jayAqc2ssIHN0cnVjdCBmbG93aTYgKmZsNiwKK3N0
cnVjdCBkc3RfZW50cnkgKmlwNl9kc3RfbG9va3VwX2Zsb3coc3RydWN0IG5ldCAqbmV0LCBjb25z
dCBzdHJ1Y3Qgc29jayAqc2ssIHN0cnVjdCBmbG93aTYgKmZsNiwKIAkJCQkgICAgICBjb25zdCBz
dHJ1Y3QgaW42X2FkZHIgKmZpbmFsX2RzdCk7CiBzdHJ1Y3QgZHN0X2VudHJ5ICppcDZfc2tfZHN0
X2xvb2t1cF9mbG93KHN0cnVjdCBzb2NrICpzaywgc3RydWN0IGZsb3dpNiAqZmw2LAogCQkJCQkg
Y29uc3Qgc3RydWN0IGluNl9hZGRyICpmaW5hbF9kc3QpOwpkaWZmIC0tZ2l0IGEvbmV0L2RjY3Av
aXB2Ni5jIGIvbmV0L2RjY3AvaXB2Ni5jCmluZGV4IDg3YzUxM2I1ZmYyZS4uOTQzODg3M2ZjM2M4
IDEwMDY0NAotLS0gYS9uZXQvZGNjcC9pcHY2LmMKKysrIGIvbmV0L2RjY3AvaXB2Ni5jCkBAIC0y
MDksNyArMjA5LDcgQEAgc3RhdGljIGludCBkY2NwX3Y2X3NlbmRfcmVzcG9uc2UoY29uc3Qgc3Ry
dWN0IHNvY2sgKnNrLCBzdHJ1Y3QgcmVxdWVzdF9zb2NrICpyZXEKIAlmaW5hbF9wID0gZmw2X3Vw
ZGF0ZV9kc3QoJmZsNiwgcmN1X2RlcmVmZXJlbmNlKG5wLT5vcHQpLCAmZmluYWwpOwogCXJjdV9y
ZWFkX3VubG9jaygpOwogCi0JZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxvdyhzaywgJmZsNiwgZmlu
YWxfcCk7CisJZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxvdyhzb2NrX25ldChzayksIHNrLCAmZmw2
LCBmaW5hbF9wKTsKIAlpZiAoSVNfRVJSKGRzdCkpIHsKIAkJZXJyID0gUFRSX0VSUihkc3QpOwog
CQlkc3QgPSBOVUxMOwpAQCAtMjgwLDcgKzI4MCw3IEBAIHN0YXRpYyB2b2lkIGRjY3BfdjZfY3Rs
X3NlbmRfcmVzZXQoY29uc3Qgc3RydWN0IHNvY2sgKnNrLCBzdHJ1Y3Qgc2tfYnVmZiAqcnhza2Ip
CiAJc2VjdXJpdHlfc2tiX2NsYXNzaWZ5X2Zsb3cocnhza2IsIGZsb3dpNl90b19mbG93aSgmZmw2
KSk7CiAKIAkvKiBzayA9IE5VTEwsIGJ1dCBpdCBpcyBzYWZlIGZvciBub3cuIFJTVCBzb2NrZXQg
cmVxdWlyZWQuICovCi0JZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxvdyhjdGxfc2ssICZmbDYsIE5V
TEwpOworCWRzdCA9IGlwNl9kc3RfbG9va3VwX2Zsb3coc29ja19uZXQoY3RsX3NrKSwgY3RsX3Nr
LCAmZmw2LCBOVUxMKTsKIAlpZiAoIUlTX0VSUihkc3QpKSB7CiAJCXNrYl9kc3Rfc2V0KHNrYiwg
ZHN0KTsKIAkJaXA2X3htaXQoY3RsX3NrLCBza2IsICZmbDYsIDAsIE5VTEwsIDApOwpAQCAtODg5
LDcgKzg4OSw3IEBAIHN0YXRpYyBpbnQgZGNjcF92Nl9jb25uZWN0KHN0cnVjdCBzb2NrICpzaywg
c3RydWN0IHNvY2thZGRyICp1YWRkciwKIAlvcHQgPSByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVk
KG5wLT5vcHQsIGxvY2tkZXBfc29ja19pc19oZWxkKHNrKSk7CiAJZmluYWxfcCA9IGZsNl91cGRh
dGVfZHN0KCZmbDYsIG9wdCwgJmZpbmFsKTsKIAotCWRzdCA9IGlwNl9kc3RfbG9va3VwX2Zsb3co
c2ssICZmbDYsIGZpbmFsX3ApOworCWRzdCA9IGlwNl9kc3RfbG9va3VwX2Zsb3coc29ja19uZXQo
c2spLCBzaywgJmZsNiwgZmluYWxfcCk7CiAJaWYgKElTX0VSUihkc3QpKSB7CiAJCWVyciA9IFBU
Ul9FUlIoZHN0KTsKIAkJZ290byBmYWlsdXJlOwpkaWZmIC0tZ2l0IGEvbmV0L2lwdjYvYWZfaW5l
dDYuYyBiL25ldC9pcHY2L2FmX2luZXQ2LmMKaW5kZXggODg4NWRiYWQyMTdiLi4yZTkxNjM3Yzlk
NDkgMTAwNjQ0Ci0tLSBhL25ldC9pcHY2L2FmX2luZXQ2LmMKKysrIGIvbmV0L2lwdjYvYWZfaW5l
dDYuYwpAQCAtNzAyLDcgKzcwMiw3IEBAIGludCBpbmV0Nl9za19yZWJ1aWxkX2hlYWRlcihzdHJ1
Y3Qgc29jayAqc2spCiAJCQkJCSAmZmluYWwpOwogCQlyY3VfcmVhZF91bmxvY2soKTsKIAotCQlk
c3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNrLCAmZmw2LCBmaW5hbF9wKTsKKwkJZHN0ID0gaXA2
X2RzdF9sb29rdXBfZmxvdyhzb2NrX25ldChzayksIHNrLCAmZmw2LCBmaW5hbF9wKTsKIAkJaWYg
KElTX0VSUihkc3QpKSB7CiAJCQlzay0+c2tfcm91dGVfY2FwcyA9IDA7CiAJCQlzay0+c2tfZXJy
X3NvZnQgPSAtUFRSX0VSUihkc3QpOwpkaWZmIC0tZ2l0IGEvbmV0L2lwdjYvZGF0YWdyYW0uYyBi
L25ldC9pcHY2L2RhdGFncmFtLmMKaW5kZXggOTU2YWYxMWU5YmEzLi41ODkyOTYyMmRlMGUgMTAw
NjQ0Ci0tLSBhL25ldC9pcHY2L2RhdGFncmFtLmMKKysrIGIvbmV0L2lwdjYvZGF0YWdyYW0uYwpA
QCAtODcsNyArODcsNyBAQCBpbnQgaXA2X2RhdGFncmFtX2RzdF91cGRhdGUoc3RydWN0IHNvY2sg
KnNrLCBib29sIGZpeF9za19zYWRkcikKIAlmaW5hbF9wID0gZmw2X3VwZGF0ZV9kc3QoJmZsNiwg
b3B0LCAmZmluYWwpOwogCXJjdV9yZWFkX3VubG9jaygpOwogCi0JZHN0ID0gaXA2X2RzdF9sb29r
dXBfZmxvdyhzaywgJmZsNiwgZmluYWxfcCk7CisJZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxvdyhz
b2NrX25ldChzayksIHNrLCAmZmw2LCBmaW5hbF9wKTsKIAlpZiAoSVNfRVJSKGRzdCkpIHsKIAkJ
ZXJyID0gUFRSX0VSUihkc3QpOwogCQlnb3RvIG91dDsKZGlmZiAtLWdpdCBhL25ldC9pcHY2L2lu
ZXQ2X2Nvbm5lY3Rpb25fc29jay5jIGIvbmV0L2lwdjYvaW5ldDZfY29ubmVjdGlvbl9zb2NrLmMK
aW5kZXggNzk4YTA5NTBlOWE2Li5iNzYwY2NlYzQ0ZDMgMTAwNjQ0Ci0tLSBhL25ldC9pcHY2L2lu
ZXQ2X2Nvbm5lY3Rpb25fc29jay5jCisrKyBiL25ldC9pcHY2L2luZXQ2X2Nvbm5lY3Rpb25fc29j
ay5jCkBAIC05MCw3ICs5MCw3IEBAIHN0cnVjdCBkc3RfZW50cnkgKmluZXQ2X2Nza19yb3V0ZV9y
ZXEoY29uc3Qgc3RydWN0IHNvY2sgKnNrLAogCWZsNi0+Zmw2X3Nwb3J0ID0gaHRvbnMoaXJlcS0+
aXJfbnVtKTsKIAlzZWN1cml0eV9yZXFfY2xhc3NpZnlfZmxvdyhyZXEsIGZsb3dpNl90b19mbG93
aShmbDYpKTsKIAotCWRzdCA9IGlwNl9kc3RfbG9va3VwX2Zsb3coc2ssIGZsNiwgZmluYWxfcCk7
CisJZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxvdyhzb2NrX25ldChzayksIHNrLCBmbDYsIGZpbmFs
X3ApOwogCWlmIChJU19FUlIoZHN0KSkKIAkJcmV0dXJuIE5VTEw7CiAKQEAgLTE0NCw3ICsxNDQs
NyBAQCBzdGF0aWMgc3RydWN0IGRzdF9lbnRyeSAqaW5ldDZfY3NrX3JvdXRlX3NvY2tldChzdHJ1
Y3Qgc29jayAqc2ssCiAKIAlkc3QgPSBfX2luZXQ2X2Nza19kc3RfY2hlY2soc2ssIG5wLT5kc3Rf
Y29va2llKTsKIAlpZiAoIWRzdCkgewotCQlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNrLCBm
bDYsIGZpbmFsX3ApOworCQlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNvY2tfbmV0KHNrKSwg
c2ssIGZsNiwgZmluYWxfcCk7CiAKIAkJaWYgKCFJU19FUlIoZHN0KSkKIAkJCWlwNl9kc3Rfc3Rv
cmUoc2ssIGRzdCwgTlVMTCwgTlVMTCk7CmRpZmYgLS1naXQgYS9uZXQvaXB2Ni9pcDZfb3V0cHV0
LmMgYi9uZXQvaXB2Ni9pcDZfb3V0cHV0LmMKaW5kZXggMTE0MDdkZDZiYzdjLi5kOTNhOThkZmU1
MmQgMTAwNjQ0Ci0tLSBhL25ldC9pcHY2L2lwNl9vdXRwdXQuYworKysgYi9uZXQvaXB2Ni9pcDZf
b3V0cHV0LmMKQEAgLTEwNzUsMTkgKzEwNzUsMTkgQEAgRVhQT1JUX1NZTUJPTF9HUEwoaXA2X2Rz
dF9sb29rdXApOwogICoJSXQgcmV0dXJucyBhIHZhbGlkIGRzdCBwb2ludGVyIG9uIHN1Y2Nlc3Ms
IG9yIGEgcG9pbnRlciBlbmNvZGVkCiAgKgllcnJvciBjb2RlLgogICovCi1zdHJ1Y3QgZHN0X2Vu
dHJ5ICppcDZfZHN0X2xvb2t1cF9mbG93KGNvbnN0IHN0cnVjdCBzb2NrICpzaywgc3RydWN0IGZs
b3dpNiAqZmw2LAorc3RydWN0IGRzdF9lbnRyeSAqaXA2X2RzdF9sb29rdXBfZmxvdyhzdHJ1Y3Qg
bmV0ICpuZXQsIGNvbnN0IHN0cnVjdCBzb2NrICpzaywgc3RydWN0IGZsb3dpNiAqZmw2LAogCQkJ
CSAgICAgIGNvbnN0IHN0cnVjdCBpbjZfYWRkciAqZmluYWxfZHN0KQogewogCXN0cnVjdCBkc3Rf
ZW50cnkgKmRzdCA9IE5VTEw7CiAJaW50IGVycjsKIAotCWVyciA9IGlwNl9kc3RfbG9va3VwX3Rh
aWwoc29ja19uZXQoc2spLCBzaywgJmRzdCwgZmw2KTsKKwllcnIgPSBpcDZfZHN0X2xvb2t1cF90
YWlsKG5ldCwgc2ssICZkc3QsIGZsNik7CiAJaWYgKGVycikKIAkJcmV0dXJuIEVSUl9QVFIoZXJy
KTsKIAlpZiAoZmluYWxfZHN0KQogCQlmbDYtPmRhZGRyID0gKmZpbmFsX2RzdDsKIAotCXJldHVy
biB4ZnJtX2xvb2t1cF9yb3V0ZShzb2NrX25ldChzayksIGRzdCwgZmxvd2k2X3RvX2Zsb3dpKGZs
NiksIHNrLCAwKTsKKwlyZXR1cm4geGZybV9sb29rdXBfcm91dGUobmV0LCBkc3QsIGZsb3dpNl90
b19mbG93aShmbDYpLCBzaywgMCk7CiB9CiBFWFBPUlRfU1lNQk9MX0dQTChpcDZfZHN0X2xvb2t1
cF9mbG93KTsKIApAQCAtMTExMiw3ICsxMTEyLDcgQEAgc3RydWN0IGRzdF9lbnRyeSAqaXA2X3Nr
X2RzdF9sb29rdXBfZmxvdyhzdHJ1Y3Qgc29jayAqc2ssIHN0cnVjdCBmbG93aTYgKmZsNiwKIAog
CWRzdCA9IGlwNl9za19kc3RfY2hlY2soc2ssIGRzdCwgZmw2KTsKIAlpZiAoIWRzdCkKLQkJZHN0
ID0gaXA2X2RzdF9sb29rdXBfZmxvdyhzaywgZmw2LCBmaW5hbF9kc3QpOworCQlkc3QgPSBpcDZf
ZHN0X2xvb2t1cF9mbG93KHNvY2tfbmV0KHNrKSwgc2ssIGZsNiwgZmluYWxfZHN0KTsKIAogCXJl
dHVybiBkc3Q7CiB9CmRpZmYgLS1naXQgYS9uZXQvaXB2Ni9yYXcuYyBiL25ldC9pcHY2L3Jhdy5j
CmluZGV4IDMwMTk3OGRmNjUwZS4uNDdhY2QyMGQ0ZTFmIDEwMDY0NAotLS0gYS9uZXQvaXB2Ni9y
YXcuYworKysgYi9uZXQvaXB2Ni9yYXcuYwpAQCAtOTIwLDcgKzkyMCw3IEBAIHN0YXRpYyBpbnQg
cmF3djZfc2VuZG1zZyhzdHJ1Y3Qgc29jayAqc2ssIHN0cnVjdCBtc2doZHIgKm1zZywgc2l6ZV90
IGxlbikKIAogCWZsNi5mbG93bGFiZWwgPSBpcDZfbWFrZV9mbG93aW5mbyhpcGM2LnRjbGFzcywg
Zmw2LmZsb3dsYWJlbCk7CiAKLQlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNrLCAmZmw2LCBm
aW5hbF9wKTsKKwlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNvY2tfbmV0KHNrKSwgc2ssICZm
bDYsIGZpbmFsX3ApOwogCWlmIChJU19FUlIoZHN0KSkgewogCQllcnIgPSBQVFJfRVJSKGRzdCk7
CiAJCWdvdG8gb3V0OwpkaWZmIC0tZ2l0IGEvbmV0L2lwdjYvc3luY29va2llcy5jIGIvbmV0L2lw
djYvc3luY29va2llcy5jCmluZGV4IDdhODY0MzNkODg5Ni4uNDgzNDAxNWIyN2Y0IDEwMDY0NAot
LS0gYS9uZXQvaXB2Ni9zeW5jb29raWVzLmMKKysrIGIvbmV0L2lwdjYvc3luY29va2llcy5jCkBA
IC0yMzAsNyArMjMwLDcgQEAgc3RydWN0IHNvY2sgKmNvb2tpZV92Nl9jaGVjayhzdHJ1Y3Qgc29j
ayAqc2ssIHN0cnVjdCBza19idWZmICpza2IpCiAJCWZsNi5mbDZfc3BvcnQgPSBpbmV0X3NrKHNr
KS0+aW5ldF9zcG9ydDsKIAkJc2VjdXJpdHlfcmVxX2NsYXNzaWZ5X2Zsb3cocmVxLCBmbG93aTZf
dG9fZmxvd2koJmZsNikpOwogCi0JCWRzdCA9IGlwNl9kc3RfbG9va3VwX2Zsb3coc2ssICZmbDYs
IGZpbmFsX3ApOworCQlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNvY2tfbmV0KHNrKSwgc2ss
ICZmbDYsIGZpbmFsX3ApOwogCQlpZiAoSVNfRVJSKGRzdCkpCiAJCQlnb3RvIG91dF9mcmVlOwog
CX0KZGlmZiAtLWdpdCBhL25ldC9pcHY2L3RjcF9pcHY2LmMgYi9uZXQvaXB2Ni90Y3BfaXB2Ni5j
CmluZGV4IDQ5NTM0NjZjZjk4Zi4uN2IzMzZiNzgwM2ZmIDEwMDY0NAotLS0gYS9uZXQvaXB2Ni90
Y3BfaXB2Ni5jCisrKyBiL25ldC9pcHY2L3RjcF9pcHY2LmMKQEAgLTI0NCw3ICsyNDQsNyBAQCBz
dGF0aWMgaW50IHRjcF92Nl9jb25uZWN0KHN0cnVjdCBzb2NrICpzaywgc3RydWN0IHNvY2thZGRy
ICp1YWRkciwKIAogCXNlY3VyaXR5X3NrX2NsYXNzaWZ5X2Zsb3coc2ssIGZsb3dpNl90b19mbG93
aSgmZmw2KSk7CiAKLQlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNrLCAmZmw2LCBmaW5hbF9w
KTsKKwlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNvY2tfbmV0KHNrKSwgc2ssICZmbDYsIGZp
bmFsX3ApOwogCWlmIChJU19FUlIoZHN0KSkgewogCQllcnIgPSBQVFJfRVJSKGRzdCk7CiAJCWdv
dG8gZmFpbHVyZTsKQEAgLTg0MSw3ICs4NDEsNyBAQCBzdGF0aWMgdm9pZCB0Y3BfdjZfc2VuZF9y
ZXNwb25zZShjb25zdCBzdHJ1Y3Qgc29jayAqc2ssIHN0cnVjdCBza19idWZmICpza2IsIHUzMgog
CSAqIFVuZGVybHlpbmcgZnVuY3Rpb24gd2lsbCB1c2UgdGhpcyB0byByZXRyaWV2ZSB0aGUgbmV0
d29yawogCSAqIG5hbWVzcGFjZQogCSAqLwotCWRzdCA9IGlwNl9kc3RfbG9va3VwX2Zsb3coY3Rs
X3NrLCAmZmw2LCBOVUxMKTsKKwlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNvY2tfbmV0KGN0
bF9zayksIGN0bF9zaywgJmZsNiwgTlVMTCk7CiAJaWYgKCFJU19FUlIoZHN0KSkgewogCQlza2Jf
ZHN0X3NldChidWZmLCBkc3QpOwogCQlpcDZfeG1pdChjdGxfc2ssIGJ1ZmYsICZmbDYsIGZsNi5m
bG93aTZfbWFyaywgTlVMTCwgdGNsYXNzKTsKZGlmZiAtLWdpdCBhL25ldC9sMnRwL2wydHBfaXA2
LmMgYi9uZXQvbDJ0cC9sMnRwX2lwNi5jCmluZGV4IDQyM2NiMDk1YWQzNy4uMjgyNzRmMzk3YzU1
IDEwMDY0NAotLS0gYS9uZXQvbDJ0cC9sMnRwX2lwNi5jCisrKyBiL25ldC9sMnRwL2wydHBfaXA2
LmMKQEAgLTYyMCw3ICs2MjAsNyBAQCBzdGF0aWMgaW50IGwydHBfaXA2X3NlbmRtc2coc3RydWN0
IHNvY2sgKnNrLCBzdHJ1Y3QgbXNnaGRyICptc2csIHNpemVfdCBsZW4pCiAKIAlmbDYuZmxvd2xh
YmVsID0gaXA2X21ha2VfZmxvd2luZm8oaXBjNi50Y2xhc3MsIGZsNi5mbG93bGFiZWwpOwogCi0J
ZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxvdyhzaywgJmZsNiwgZmluYWxfcCk7CisJZHN0ID0gaXA2
X2RzdF9sb29rdXBfZmxvdyhzb2NrX25ldChzayksIHNrLCAmZmw2LCBmaW5hbF9wKTsKIAlpZiAo
SVNfRVJSKGRzdCkpIHsKIAkJZXJyID0gUFRSX0VSUihkc3QpOwogCQlnb3RvIG91dDsKZGlmZiAt
LWdpdCBhL25ldC9zY3RwL2lwdjYuYyBiL25ldC9zY3RwL2lwdjYuYwppbmRleCAzNGFiN2Y5MmYw
NjQuLjUwYmM4YzRjYTkwNiAxMDA2NDQKLS0tIGEvbmV0L3NjdHAvaXB2Ni5jCisrKyBiL25ldC9z
Y3RwL2lwdjYuYwpAQCAtMjY5LDcgKzI2OSw3IEBAIHN0YXRpYyB2b2lkIHNjdHBfdjZfZ2V0X2Rz
dChzdHJ1Y3Qgc2N0cF90cmFuc3BvcnQgKnQsIHVuaW9uIHNjdHBfYWRkciAqc2FkZHIsCiAJZmlu
YWxfcCA9IGZsNl91cGRhdGVfZHN0KGZsNiwgcmN1X2RlcmVmZXJlbmNlKG5wLT5vcHQpLCAmZmlu
YWwpOwogCXJjdV9yZWFkX3VubG9jaygpOwogCi0JZHN0ID0gaXA2X2RzdF9sb29rdXBfZmxvdyhz
aywgZmw2LCBmaW5hbF9wKTsKKwlkc3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNvY2tfbmV0KHNr
KSwgc2ssIGZsNiwgZmluYWxfcCk7CiAJaWYgKCFhc29jIHx8IHNhZGRyKSB7CiAJCXQtPmRzdCA9
IGRzdDsKIAkJbWVtY3B5KGZsLCAmX2ZsLCBzaXplb2YoX2ZsKSk7CkBAIC0zMjcsNyArMzI3LDcg
QEAgc3RhdGljIHZvaWQgc2N0cF92Nl9nZXRfZHN0KHN0cnVjdCBzY3RwX3RyYW5zcG9ydCAqdCwg
dW5pb24gc2N0cF9hZGRyICpzYWRkciwKIAkJZmw2LT5zYWRkciA9IGxhZGRyLT5hLnY2LnNpbjZf
YWRkcjsKIAkJZmw2LT5mbDZfc3BvcnQgPSBsYWRkci0+YS52Ni5zaW42X3BvcnQ7CiAJCWZpbmFs
X3AgPSBmbDZfdXBkYXRlX2RzdChmbDYsIHJjdV9kZXJlZmVyZW5jZShucC0+b3B0KSwgJmZpbmFs
KTsKLQkJYmRzdCA9IGlwNl9kc3RfbG9va3VwX2Zsb3coc2ssIGZsNiwgZmluYWxfcCk7CisJCWJk
c3QgPSBpcDZfZHN0X2xvb2t1cF9mbG93KHNvY2tfbmV0KHNrKSwgc2ssIGZsNiwgZmluYWxfcCk7
CiAKIAkJaWYgKElTX0VSUihiZHN0KSkKIAkJCWNvbnRpbnVlOwoKRnJvbSBhYmM0ZjI0ZThmNDA3
MTQ4NjI0MzI5OTkwOTExZDY5MzhjOGUxZmM2IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9t
OiBTYWJyaW5hIER1YnJvY2EgPHNkQHF1ZWFzeXNuYWlsLm5ldD4KRGF0ZTogV2VkLCA0IERlYyAy
MDE5IDE1OjM1OjUzICswMTAwClN1YmplY3Q6IG5ldDogaXB2Nl9zdHViOiB1c2UgaXA2X2RzdF9s
b29rdXBfZmxvdyBpbnN0ZWFkIG9mIGlwNl9kc3RfbG9va3VwCgpjb21taXQgNmM4OTkxZjQxNTQ2
YzNjNDcyNTAzZGZmMWVhOWRhYWRkZjkzMzFjMiB1cHN0cmVhbS4KCmlwdjZfc3R1YiB1c2VzIHRo
ZSBpcDZfZHN0X2xvb2t1cCBmdW5jdGlvbiB0byBhbGxvdyBvdGhlciBtb2R1bGVzIHRvCnBlcmZv
cm0gSVB2NiBsb29rdXBzLiBIb3dldmVyLCB0aGlzIGZ1bmN0aW9uIHNraXBzIHRoZSBYRlJNIGxh
eWVyCmVudGlyZWx5LgoKQWxsIHVzZXJzIG9mIGlwdjZfc3R1Yi0+aXA2X2RzdF9sb29rdXAgdXNl
IGlwX3JvdXRlX291dHB1dF9mbG93ICh2aWEgdGhlCmlwX3JvdXRlX291dHB1dF9rZXkgYW5kIGlw
X3JvdXRlX291dHB1dCBoZWxwZXJzKSBmb3IgdGhlaXIgSVB2NCBsb29rdXBzLAp3aGljaCBjYWxs
cyB4ZnJtX2xvb2t1cF9yb3V0ZSgpLiBUaGlzIHBhdGNoIGZpeGVzIHRoaXMgaW5jb25zaXN0ZW50
CmJlaGF2aW9yIGJ5IHN3aXRjaGluZyB0aGUgc3R1YiB0byBpcDZfZHN0X2xvb2t1cF9mbG93LCB3
aGljaCBhbHNvIGNhbGxzCnhmcm1fbG9va3VwX3JvdXRlKCkuCgpUaGlzIHJlcXVpcmVzIHNvbWUg
Y2hhbmdlcyBpbiBhbGwgdGhlIGNhbGxlcnMsIGFzIHRoZXNlIHR3byBmdW5jdGlvbnMKdGFrZSBk
aWZmZXJlbnQgYXJndW1lbnRzIGFuZCBoYXZlIGRpZmZlcmVudCByZXR1cm4gdHlwZXMuCgpGaXhl
czogNWY4MWJkMmU1ZDgwICgiaXB2NjogZXhwb3J0IGEgc3R1YiBmb3IgSVB2NiBzeW1ib2xzIHVz
ZWQgYnkgdnhsYW4iKQpSZXBvcnRlZC1ieTogWGl1bWVpIE11IDx4bXVAcmVkaGF0LmNvbT4KU2ln
bmVkLW9mZi1ieTogU2FicmluYSBEdWJyb2NhIDxzZEBxdWVhc3lzbmFpbC5uZXQ+ClNpZ25lZC1v
ZmYtYnk6IERhdmlkIFMuIE1pbGxlciA8ZGF2ZW1AZGF2ZW1sb2Z0Lm5ldD4KW2J3aDogQmFja3Bv
cnRlZCB0byA0Ljk6CiAtIERyb3AgY2hhbmdlcyBpbiBsd3RfYnBmLmMgYW5kIG1seDUKIC0gSW5p
dGlhbGlzZSAiZHN0IiBpbiBkcml2ZXJzL2luZmluaWJhbmQvY29yZS9hZGRyLmM6YWRkcl9yZXNv
bHZlKCkKICAgdG8gYXZvaWQgaW50cm9kdWNpbmcgYSBzcHVyaW91cyAibWF5IGJlIHVzZWQgdW5p
bml0aWFsaXNlZCIgd2FybmluZwogLSBBZGp1c3QgZmlsZW5hbWUsIGNvbnRleHQsIGluZGVudGF0
aW9uXQpTaWduZWQtb2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxiZW4uaHV0Y2hpbmdzQGNvZGV0aGlu
ay5jby51az4KLS0tCiBkcml2ZXJzL2luZmluaWJhbmQvY29yZS9hZGRyLmMgICAgICB8ICA4ICsr
KystLS0tCiBkcml2ZXJzL2luZmluaWJhbmQvc3cvcnhlL3J4ZV9uZXQuYyB8ICA4ICsrKysrLS0t
CiBkcml2ZXJzL25ldC9nZW5ldmUuYyAgICAgICAgICAgICAgICB8ICA0ICsrKy0KIGRyaXZlcnMv
bmV0L3Z4bGFuLmMgICAgICAgICAgICAgICAgIHwgMTAgKysrKy0tLS0tLQogaW5jbHVkZS9uZXQv
YWRkcmNvbmYuaCAgICAgICAgICAgICAgfCAgNiArKysrLS0KIG5ldC9pcHY2L2FkZHJjb25mX2Nv
cmUuYyAgICAgICAgICAgIHwgMTEgKysrKysrLS0tLS0KIG5ldC9pcHY2L2FmX2luZXQ2LmMgICAg
ICAgICAgICAgICAgIHwgIDIgKy0KIG5ldC9tcGxzL2FmX21wbHMuYyAgICAgICAgICAgICAgICAg
IHwgIDcgKysrLS0tLQogbmV0L3RpcGMvdWRwX21lZGlhLmMgICAgICAgICAgICAgICAgfCAgOSAr
KysrKystLS0KIDkgZmlsZXMgY2hhbmdlZCwgMzYgaW5zZXJ0aW9ucygrKSwgMjkgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9pbmZpbmliYW5kL2NvcmUvYWRkci5jIGIvZHJpdmVy
cy9pbmZpbmliYW5kL2NvcmUvYWRkci5jCmluZGV4IGY3ZDIzYzEwODFkYy4uNjhlZWQ0NWI4NjAw
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2luZmluaWJhbmQvY29yZS9hZGRyLmMKKysrIGIvZHJpdmVy
cy9pbmZpbmliYW5kL2NvcmUvYWRkci5jCkBAIC00NTMsMTYgKzQ1MywxNSBAQCBzdGF0aWMgaW50
IGFkZHI2X3Jlc29sdmUoc3RydWN0IHNvY2thZGRyX2luNiAqc3JjX2luLAogCXN0cnVjdCBmbG93
aTYgZmw2OwogCXN0cnVjdCBkc3RfZW50cnkgKmRzdDsKIAlzdHJ1Y3QgcnQ2X2luZm8gKnJ0Owot
CWludCByZXQ7CiAKIAltZW1zZXQoJmZsNiwgMCwgc2l6ZW9mIGZsNik7CiAJZmw2LmRhZGRyID0g
ZHN0X2luLT5zaW42X2FkZHI7CiAJZmw2LnNhZGRyID0gc3JjX2luLT5zaW42X2FkZHI7CiAJZmw2
LmZsb3dpNl9vaWYgPSBhZGRyLT5ib3VuZF9kZXZfaWY7CiAKLQlyZXQgPSBpcHY2X3N0dWItPmlw
djZfZHN0X2xvb2t1cChhZGRyLT5uZXQsIE5VTEwsICZkc3QsICZmbDYpOwotCWlmIChyZXQgPCAw
KQotCQlyZXR1cm4gcmV0OworCWRzdCA9IGlwdjZfc3R1Yi0+aXB2Nl9kc3RfbG9va3VwX2Zsb3co
YWRkci0+bmV0LCBOVUxMLCAmZmw2LCBOVUxMKTsKKwlpZiAoSVNfRVJSKGRzdCkpCisJCXJldHVy
biBQVFJfRVJSKGRzdCk7CiAKIAlydCA9IChzdHJ1Y3QgcnQ2X2luZm8gKilkc3Q7CiAJaWYgKGlw
djZfYWRkcl9hbnkoJnNyY19pbi0+c2luNl9hZGRyKSkgewpAQCAtNTUyLDYgKzU1MSw3IEBAIHN0
YXRpYyBpbnQgYWRkcl9yZXNvbHZlKHN0cnVjdCBzb2NrYWRkciAqc3JjX2luLAogCQljb25zdCBz
dHJ1Y3Qgc29ja2FkZHJfaW42ICpkc3RfaW42ID0KIAkJCShjb25zdCBzdHJ1Y3Qgc29ja2FkZHJf
aW42ICopZHN0X2luOwogCisJCWRzdCA9IE5VTEw7CiAJCXJldCA9IGFkZHI2X3Jlc29sdmUoKHN0
cnVjdCBzb2NrYWRkcl9pbjYgKilzcmNfaW4sCiAJCQkJICAgIGRzdF9pbjYsIGFkZHIsCiAJCQkJ
ICAgICZkc3QpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9pbmZpbmliYW5kL3N3L3J4ZS9yeGVfbmV0
LmMgYi9kcml2ZXJzL2luZmluaWJhbmQvc3cvcnhlL3J4ZV9uZXQuYwppbmRleCBmNGYzOTQyZWJi
ZDEuLmQxOWUwMDNlODM4MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9pbmZpbmliYW5kL3N3L3J4ZS9y
eGVfbmV0LmMKKysrIGIvZHJpdmVycy9pbmZpbmliYW5kL3N3L3J4ZS9yeGVfbmV0LmMKQEAgLTE4
MiwxMCArMTgyLDEyIEBAIHN0YXRpYyBzdHJ1Y3QgZHN0X2VudHJ5ICpyeGVfZmluZF9yb3V0ZTYo
c3RydWN0IG5ldF9kZXZpY2UgKm5kZXYsCiAJbWVtY3B5KCZmbDYuZGFkZHIsIGRhZGRyLCBzaXpl
b2YoKmRhZGRyKSk7CiAJZmw2LmZsb3dpNl9wcm90byA9IElQUFJPVE9fVURQOwogCi0JaWYgKHVu
bGlrZWx5KGlwdjZfc3R1Yi0+aXB2Nl9kc3RfbG9va3VwKHNvY2tfbmV0KHJlY3Zfc29ja2V0cy5z
azYtPnNrKSwKLQkJCQkJCXJlY3Zfc29ja2V0cy5zazYtPnNrLCAmbmRzdCwgJmZsNikpKSB7CisJ
bmRzdCA9IGlwdjZfc3R1Yi0+aXB2Nl9kc3RfbG9va3VwX2Zsb3coc29ja19uZXQocmVjdl9zb2Nr
ZXRzLnNrNi0+c2spLAorCQkJCQkgICAgICAgcmVjdl9zb2NrZXRzLnNrNi0+c2ssICZmbDYsCisJ
CQkJCSAgICAgICBOVUxMKTsKKwlpZiAodW5saWtlbHkoSVNfRVJSKG5kc3QpKSkgewogCQlwcl9l
cnJfcmF0ZWxpbWl0ZWQoIm5vIHJvdXRlIHRvICVwSTZcbiIsIGRhZGRyKTsKLQkJZ290byBwdXQ7
CisJCXJldHVybiBOVUxMOwogCX0KIAogCWlmICh1bmxpa2VseShuZHN0LT5lcnJvcikpIHsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2dlbmV2ZS5jIGIvZHJpdmVycy9uZXQvZ2VuZXZlLmMKaW5k
ZXggOTJhZDQzZTUzYzcyLi4zNWQ4YzYzNmRlMTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbmV0L2dl
bmV2ZS5jCisrKyBiL2RyaXZlcnMvbmV0L2dlbmV2ZS5jCkBAIC04MzUsNyArODM1LDkgQEAgc3Rh
dGljIHN0cnVjdCBkc3RfZW50cnkgKmdlbmV2ZV9nZXRfdjZfZHN0KHN0cnVjdCBza19idWZmICpz
a2IsCiAJCQlyZXR1cm4gZHN0OwogCX0KIAotCWlmIChpcHY2X3N0dWItPmlwdjZfZHN0X2xvb2t1
cChnZW5ldmUtPm5ldCwgZ3M2LT5zb2NrLT5zaywgJmRzdCwgZmw2KSkgeworCWRzdCA9IGlwdjZf
c3R1Yi0+aXB2Nl9kc3RfbG9va3VwX2Zsb3coZ2VuZXZlLT5uZXQsIGdzNi0+c29jay0+c2ssIGZs
NiwKKwkJCQkJICAgICAgTlVMTCk7CisJaWYgKElTX0VSUihkc3QpKSB7CiAJCW5ldGRldl9kYmco
ZGV2LCAibm8gcm91dGUgdG8gJXBJNlxuIiwgJmZsNi0+ZGFkZHIpOwogCQlyZXR1cm4gRVJSX1BU
UigtRU5FVFVOUkVBQ0gpOwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L3Z4bGFuLmMgYi9k
cml2ZXJzL25ldC92eGxhbi5jCmluZGV4IGJjNDU0MmQ5YTA4ZC4uNThkZGI2YzkwNDE4IDEwMDY0
NAotLS0gYS9kcml2ZXJzL25ldC92eGxhbi5jCisrKyBiL2RyaXZlcnMvbmV0L3Z4bGFuLmMKQEAg
LTE4ODEsNyArMTg4MSw2IEBAIHN0YXRpYyBzdHJ1Y3QgZHN0X2VudHJ5ICp2eGxhbjZfZ2V0X3Jv
dXRlKHN0cnVjdCB2eGxhbl9kZXYgKnZ4bGFuLAogCWJvb2wgdXNlX2NhY2hlID0gaXBfdHVubmVs
X2RzdF9jYWNoZV91c2FibGUoc2tiLCBpbmZvKTsKIAlzdHJ1Y3QgZHN0X2VudHJ5ICpuZHN0Owog
CXN0cnVjdCBmbG93aTYgZmw2OwotCWludCBlcnI7CiAKIAlpZiAoIXNvY2s2KQogCQlyZXR1cm4g
RVJSX1BUUigtRUlPKTsKQEAgLTE5MDIsMTEgKzE5MDEsMTAgQEAgc3RhdGljIHN0cnVjdCBkc3Rf
ZW50cnkgKnZ4bGFuNl9nZXRfcm91dGUoc3RydWN0IHZ4bGFuX2RldiAqdnhsYW4sCiAJZmw2LmZs
b3dpNl9tYXJrID0gc2tiLT5tYXJrOwogCWZsNi5mbG93aTZfcHJvdG8gPSBJUFBST1RPX1VEUDsK
IAotCWVyciA9IGlwdjZfc3R1Yi0+aXB2Nl9kc3RfbG9va3VwKHZ4bGFuLT5uZXQsCi0JCQkJCSBz
b2NrNi0+c29jay0+c2ssCi0JCQkJCSAmbmRzdCwgJmZsNik7Ci0JaWYgKGVyciA8IDApCi0JCXJl
dHVybiBFUlJfUFRSKGVycik7CisJbmRzdCA9IGlwdjZfc3R1Yi0+aXB2Nl9kc3RfbG9va3VwX2Zs
b3codnhsYW4tPm5ldCwgc29jazYtPnNvY2stPnNrLAorCQkJCQkgICAgICAgJmZsNiwgTlVMTCk7
CisJaWYgKHVubGlrZWx5KElTX0VSUihuZHN0KSkpCisJCXJldHVybiBFUlJfUFRSKC1FTkVUVU5S
RUFDSCk7CiAKIAkqc2FkZHIgPSBmbDYuc2FkZHI7CiAJaWYgKHVzZV9jYWNoZSkKZGlmZiAtLWdp
dCBhL2luY2x1ZGUvbmV0L2FkZHJjb25mLmggYi9pbmNsdWRlL25ldC9hZGRyY29uZi5oCmluZGV4
IGI4ZWU4YTExM2UzMi4uMDE5YjA2YzAzNWE4IDEwMDY0NAotLS0gYS9pbmNsdWRlL25ldC9hZGRy
Y29uZi5oCisrKyBiL2luY2x1ZGUvbmV0L2FkZHJjb25mLmgKQEAgLTIwNiw4ICsyMDYsMTAgQEAg
c3RydWN0IGlwdjZfc3R1YiB7CiAJCQkJIGNvbnN0IHN0cnVjdCBpbjZfYWRkciAqYWRkcik7CiAJ
aW50ICgqaXB2Nl9zb2NrX21jX2Ryb3ApKHN0cnVjdCBzb2NrICpzaywgaW50IGlmaW5kZXgsCiAJ
CQkJIGNvbnN0IHN0cnVjdCBpbjZfYWRkciAqYWRkcik7Ci0JaW50ICgqaXB2Nl9kc3RfbG9va3Vw
KShzdHJ1Y3QgbmV0ICpuZXQsIHN0cnVjdCBzb2NrICpzaywKLQkJCSAgICAgICBzdHJ1Y3QgZHN0
X2VudHJ5ICoqZHN0LCBzdHJ1Y3QgZmxvd2k2ICpmbDYpOworCXN0cnVjdCBkc3RfZW50cnkgKigq
aXB2Nl9kc3RfbG9va3VwX2Zsb3cpKHN0cnVjdCBuZXQgKm5ldCwKKwkJCQkJCSAgY29uc3Qgc3Ry
dWN0IHNvY2sgKnNrLAorCQkJCQkJICBzdHJ1Y3QgZmxvd2k2ICpmbDYsCisJCQkJCQkgIGNvbnN0
IHN0cnVjdCBpbjZfYWRkciAqZmluYWxfZHN0KTsKIAl2b2lkICgqdWRwdjZfZW5jYXBfZW5hYmxl
KSh2b2lkKTsKIAl2b2lkICgqbmRpc2Nfc2VuZF9uYSkoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwg
Y29uc3Qgc3RydWN0IGluNl9hZGRyICpkYWRkciwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbjZf
YWRkciAqc29saWNpdGVkX2FkZHIsCmRpZmYgLS1naXQgYS9uZXQvaXB2Ni9hZGRyY29uZl9jb3Jl
LmMgYi9uZXQvaXB2Ni9hZGRyY29uZl9jb3JlLmMKaW5kZXggYmZhOTQxZmMxMTY1Li4xMjkzMjRi
MzZmYjYgMTAwNjQ0Ci0tLSBhL25ldC9pcHY2L2FkZHJjb25mX2NvcmUuYworKysgYi9uZXQvaXB2
Ni9hZGRyY29uZl9jb3JlLmMKQEAgLTEwNywxNSArMTA3LDE2IEBAIGludCBpbmV0NmFkZHJfbm90
aWZpZXJfY2FsbF9jaGFpbih1bnNpZ25lZCBsb25nIHZhbCwgdm9pZCAqdikKIH0KIEVYUE9SVF9T
WU1CT0woaW5ldDZhZGRyX25vdGlmaWVyX2NhbGxfY2hhaW4pOwogCi1zdGF0aWMgaW50IGVhZm5v
c3VwcG9ydF9pcHY2X2RzdF9sb29rdXAoc3RydWN0IG5ldCAqbmV0LCBzdHJ1Y3Qgc29jayAqdTEs
Ci0JCQkJCXN0cnVjdCBkc3RfZW50cnkgKip1MiwKLQkJCQkJc3RydWN0IGZsb3dpNiAqdTMpCitz
dGF0aWMgc3RydWN0IGRzdF9lbnRyeSAqZWFmbm9zdXBwb3J0X2lwdjZfZHN0X2xvb2t1cF9mbG93
KHN0cnVjdCBuZXQgKm5ldCwKKwkJCQkJCQkgICBjb25zdCBzdHJ1Y3Qgc29jayAqc2ssCisJCQkJ
CQkJICAgc3RydWN0IGZsb3dpNiAqZmw2LAorCQkJCQkJCSAgIGNvbnN0IHN0cnVjdCBpbjZfYWRk
ciAqZmluYWxfZHN0KQogewotCXJldHVybiAtRUFGTk9TVVBQT1JUOworCXJldHVybiBFUlJfUFRS
KC1FQUZOT1NVUFBPUlQpOwogfQogCiBjb25zdCBzdHJ1Y3QgaXB2Nl9zdHViICppcHY2X3N0dWIg
X19yZWFkX21vc3RseSA9ICYoc3RydWN0IGlwdjZfc3R1YikgewotCS5pcHY2X2RzdF9sb29rdXAg
PSBlYWZub3N1cHBvcnRfaXB2Nl9kc3RfbG9va3VwLAorCS5pcHY2X2RzdF9sb29rdXBfZmxvdyA9
IGVhZm5vc3VwcG9ydF9pcHY2X2RzdF9sb29rdXBfZmxvdywKIH07CiBFWFBPUlRfU1lNQk9MX0dQ
TChpcHY2X3N0dWIpOwogCmRpZmYgLS1naXQgYS9uZXQvaXB2Ni9hZl9pbmV0Ni5jIGIvbmV0L2lw
djYvYWZfaW5ldDYuYwppbmRleCAyZTkxNjM3YzlkNDkuLmM2NzQ2YWFmN2ZiZiAxMDA2NDQKLS0t
IGEvbmV0L2lwdjYvYWZfaW5ldDYuYworKysgYi9uZXQvaXB2Ni9hZl9pbmV0Ni5jCkBAIC04NjAs
NyArODYwLDcgQEAgc3RhdGljIHN0cnVjdCBwZXJuZXRfb3BlcmF0aW9ucyBpbmV0Nl9uZXRfb3Bz
ID0gewogc3RhdGljIGNvbnN0IHN0cnVjdCBpcHY2X3N0dWIgaXB2Nl9zdHViX2ltcGwgPSB7CiAJ
LmlwdjZfc29ja19tY19qb2luID0gaXB2Nl9zb2NrX21jX2pvaW4sCiAJLmlwdjZfc29ja19tY19k
cm9wID0gaXB2Nl9zb2NrX21jX2Ryb3AsCi0JLmlwdjZfZHN0X2xvb2t1cCA9IGlwNl9kc3RfbG9v
a3VwLAorCS5pcHY2X2RzdF9sb29rdXBfZmxvdyA9IGlwNl9kc3RfbG9va3VwX2Zsb3csCiAJLnVk
cHY2X2VuY2FwX2VuYWJsZSA9IHVkcHY2X2VuY2FwX2VuYWJsZSwKIAkubmRpc2Nfc2VuZF9uYSA9
IG5kaXNjX3NlbmRfbmEsCiAJLm5kX3RibAk9ICZuZF90YmwsCmRpZmYgLS1naXQgYS9uZXQvbXBs
cy9hZl9tcGxzLmMgYi9uZXQvbXBscy9hZl9tcGxzLmMKaW5kZXggZmZhYjk0ZDYxZTFkLi5lYWI5
YzFkNzA4NTYgMTAwNjQ0Ci0tLSBhL25ldC9tcGxzL2FmX21wbHMuYworKysgYi9uZXQvbXBscy9h
Zl9tcGxzLmMKQEAgLTQ5NywxNiArNDk3LDE1IEBAIHN0YXRpYyBzdHJ1Y3QgbmV0X2RldmljZSAq
aW5ldDZfZmliX2xvb2t1cF9kZXYoc3RydWN0IG5ldCAqbmV0LAogCXN0cnVjdCBuZXRfZGV2aWNl
ICpkZXY7CiAJc3RydWN0IGRzdF9lbnRyeSAqZHN0OwogCXN0cnVjdCBmbG93aTYgZmw2OwotCWlu
dCBlcnI7CiAKIAlpZiAoIWlwdjZfc3R1YikKIAkJcmV0dXJuIEVSUl9QVFIoLUVBRk5PU1VQUE9S
VCk7CiAKIAltZW1zZXQoJmZsNiwgMCwgc2l6ZW9mKGZsNikpOwogCW1lbWNweSgmZmw2LmRhZGRy
LCBhZGRyLCBzaXplb2Yoc3RydWN0IGluNl9hZGRyKSk7Ci0JZXJyID0gaXB2Nl9zdHViLT5pcHY2
X2RzdF9sb29rdXAobmV0LCBOVUxMLCAmZHN0LCAmZmw2KTsKLQlpZiAoZXJyKQotCQlyZXR1cm4g
RVJSX1BUUihlcnIpOworCWRzdCA9IGlwdjZfc3R1Yi0+aXB2Nl9kc3RfbG9va3VwX2Zsb3cobmV0
LCBOVUxMLCAmZmw2LCBOVUxMKTsKKwlpZiAoSVNfRVJSKGRzdCkpCisJCXJldHVybiBFUlJfQ0FT
VChkc3QpOwogCiAJZGV2ID0gZHN0LT5kZXY7CiAJZGV2X2hvbGQoZGV2KTsKZGlmZiAtLWdpdCBh
L25ldC90aXBjL3VkcF9tZWRpYS5jIGIvbmV0L3RpcGMvdWRwX21lZGlhLmMKaW5kZXggMDUwMzNh
YjA1YjhmLi5jNmZmM2RlMWRlMzcgMTAwNjQ0Ci0tLSBhL25ldC90aXBjL3VkcF9tZWRpYS5jCisr
KyBiL25ldC90aXBjL3VkcF9tZWRpYS5jCkBAIC0xODcsMTAgKzE4NywxMyBAQCBzdGF0aWMgaW50
IHRpcGNfdWRwX3htaXQoc3RydWN0IG5ldCAqbmV0LCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAogCQkJ
LnNhZGRyID0gc3JjLT5pcHY2LAogCQkJLmZsb3dpNl9wcm90byA9IElQUFJPVE9fVURQCiAJCX07
Ci0JCWVyciA9IGlwdjZfc3R1Yi0+aXB2Nl9kc3RfbG9va3VwKG5ldCwgdWItPnVic29jay0+c2ss
ICZuZHN0LAotCQkJCQkJICZmbDYpOwotCQlpZiAoZXJyKQorCQluZHN0ID0gaXB2Nl9zdHViLT5p
cHY2X2RzdF9sb29rdXBfZmxvdyhuZXQsCisJCQkJCQkgICAgICAgdWItPnVic29jay0+c2ssCisJ
CQkJCQkgICAgICAgJmZsNiwgTlVMTCk7CisJCWlmIChJU19FUlIobmRzdCkpIHsKKwkJCWVyciA9
IFBUUl9FUlIobmRzdCk7CiAJCQlnb3RvIHR4X2Vycm9yOworCQl9CiAJCXR0bCA9IGlwNl9kc3Rf
aG9wbGltaXQobmRzdCk7CiAJCWVyciA9IHVkcF90dW5uZWw2X3htaXRfc2tiKG5kc3QsIHViLT51
YnNvY2stPnNrLCBza2IsIE5VTEwsCiAJCQkJCSAgICZzcmMtPmlwdjYsICZkc3QtPmlwdjYsIDAs
IHR0bCwgMCwKCkZyb20gYjJkNWFkN2IyNTlmNDlmZDkzNWIyZDM5ZjI1NmIwOTg3ZjE1MGJmNiBN
b24gU2VwIDE3IDAwOjAwOjAwIDIwMDEKRnJvbTogV2FpbWFuIExvbmcgPGxvbmdtYW5AcmVkaGF0
LmNvbT4KRGF0ZTogV2VkLCAyMCBTZXAgMjAxNyAxMzoxMjoyMCAtMDYwMApTdWJqZWN0OiBibGt0
cmFjZTogRml4IHBvdGVudGlhbCBkZWFkbG9jayBiZXR3ZWVuIGRlbGV0ZSAmIHN5c2ZzIG9wcwoK
Y29tbWl0IDVhY2IzY2MyYzJlOWQzMDIwYTRmZWU0Mzc2M2M2NDYzNzY3ZjE1NzIgdXBzdHJlYW0u
CgpUaGUgbG9ja2RlcCBjb2RlIGhhZCByZXBvcnRlZCB0aGUgZm9sbG93aW5nIHVuc2FmZSBsb2Nr
aW5nIHNjZW5hcmlvOgoKICAgICAgIENQVTAgICAgICAgICAgICAgICAgICAgIENQVTEKICAgICAg
IC0tLS0gICAgICAgICAgICAgICAgICAgIC0tLS0KICBsb2NrKHNfYWN0aXZlIzIyOCk7CiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NrKCZiZGV2LT5iZF9tdXRleC8xKTsKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2soc19hY3RpdmUjMjI4KTsKICBsb2NrKCZiZGV2
LT5iZF9tdXRleCk7CgogKioqIERFQURMT0NLICoqKgoKVGhlIGRlYWRsb2NrIG1heSBoYXBwZW4g
d2hlbiBvbmUgdGFzayAoQ1BVMSkgaXMgdHJ5aW5nIHRvIGRlbGV0ZSBhCnBhcnRpdGlvbiBpbiBh
IGJsb2NrIGRldmljZSBhbmQgYW5vdGhlciB0YXNrIChDUFUwKSBpcyBhY2Nlc3NpbmcKdHJhY2lu
ZyBzeXNmcyBmaWxlIChlLmcuIC9zeXMvYmxvY2svZG0tMS90cmFjZS9hY3RfbWFzaykgaW4gdGhh
dApwYXJ0aXRpb24uCgpUaGUgc19hY3RpdmUgaXNuJ3QgYW4gYWN0dWFsIGxvY2suIEl0IGlzIGEg
cmVmZXJlbmNlIGNvdW50IChrbi0+Y291bnQpCm9uIHRoZSBzeXNmcyAoa2VybmZzKSBmaWxlLiBS
ZW1vdmFsIG9mIGEgc3lzZnMgZmlsZSwgaG93ZXZlciwgcmVxdWlyZQphIHdhaXQgdW50aWwgYWxs
IHRoZSByZWZlcmVuY2VzIGFyZSBnb25lLiBUaGUgcmVmZXJlbmNlIGNvdW50IGlzCnRyZWF0ZWQg
bGlrZSBhIHJ3c2VtIHVzaW5nIGxvY2tkZXAgaW5zdHJ1bWVudGF0aW9uIGNvZGUuCgpUaGUgZmFj
dCB0aGF0IGEgdGhyZWFkIGlzIGluIHRoZSBzeXNmcyBjYWxsYmFjayBtZXRob2Qgb3IgaW4gdGhl
CmlvY3RsIGNhbGwgbWVhbnMgdGhlcmUgaXMgYSByZWZlcmVuY2UgdG8gdGhlIG9wZW5kZWQgc3lz
ZnMgb3IgZGV2aWNlCmZpbGUuIFRoYXQgc2hvdWxkIHByZXZlbnQgdGhlIHVuZGVybHlpbmcgYmxv
Y2sgc3RydWN0dXJlIGZyb20gYmVpbmcKcmVtb3ZlZC4KCkluc3RlYWQgb2YgdXNpbmcgYmRfbXV0
ZXggaW4gdGhlIGJsb2NrX2RldmljZSBzdHJ1Y3R1cmUsIGEgbmV3CmJsa190cmFjZV9tdXRleCBp
cyBub3cgYWRkZWQgdG8gdGhlIHJlcXVlc3RfcXVldWUgc3RydWN0dXJlIHRvIHByb3RlY3QKYWNj
ZXNzIHRvIHRoZSBibGtfdHJhY2Ugc3RydWN0dXJlLgoKU3VnZ2VzdGVkLWJ5OiBDaHJpc3RvcGgg
SGVsbHdpZyA8aGNoQGluZnJhZGVhZC5vcmc+ClNpZ25lZC1vZmYtYnk6IFdhaW1hbiBMb25nIDxs
b25nbWFuQHJlZGhhdC5jb20+CkFja2VkLWJ5OiBTdGV2ZW4gUm9zdGVkdCAoVk13YXJlKSA8cm9z
dGVkdEBnb29kbWlzLm9yZz4KCkZpeCB0eXBvIGluIHBhdGNoIHN1YmplY3QgbGluZSwgYW5kIHBy
dW5lIGEgY29tbWVudCBkZXRhaWxpbmcgaG93CnRoZSBjb2RlIHVzZWQgdG8gd29yay4KClNpZ25l
ZC1vZmYtYnk6IEplbnMgQXhib2UgPGF4Ym9lQGtlcm5lbC5kaz4KU2lnbmVkLW9mZi1ieTogQmVu
IEh1dGNoaW5ncyA8YmVuLmh1dGNoaW5nc0Bjb2RldGhpbmsuY28udWs+Ci0tLQogYmxvY2svYmxr
LWNvcmUuYyAgICAgICAgfCAgMyArKysKIGluY2x1ZGUvbGludXgvYmxrZGV2LmggIHwgIDEgKwog
a2VybmVsL3RyYWNlL2Jsa3RyYWNlLmMgfCAxOCArKysrKysrKysrKystLS0tLS0KIDMgZmlsZXMg
Y2hhbmdlZCwgMTYgaW5zZXJ0aW9ucygrKSwgNiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9i
bG9jay9ibGstY29yZS5jIGIvYmxvY2svYmxrLWNvcmUuYwppbmRleCBiZGI5MDZiYmZlMTkuLjQ5
ODdmMzEyYTk1ZiAxMDA2NDQKLS0tIGEvYmxvY2svYmxrLWNvcmUuYworKysgYi9ibG9jay9ibGst
Y29yZS5jCkBAIC03MjksNiArNzI5LDkgQEAgc3RydWN0IHJlcXVlc3RfcXVldWUgKmJsa19hbGxv
Y19xdWV1ZV9ub2RlKGdmcF90IGdmcF9tYXNrLCBpbnQgbm9kZV9pZCkKIAogCWtvYmplY3RfaW5p
dCgmcS0+a29iaiwgJmJsa19xdWV1ZV9rdHlwZSk7CiAKKyNpZmRlZiBDT05GSUdfQkxLX0RFVl9J
T19UUkFDRQorCW11dGV4X2luaXQoJnEtPmJsa190cmFjZV9tdXRleCk7CisjZW5kaWYKIAltdXRl
eF9pbml0KCZxLT5zeXNmc19sb2NrKTsKIAlzcGluX2xvY2tfaW5pdCgmcS0+X19xdWV1ZV9sb2Nr
KTsKIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9ibGtkZXYuaCBiL2luY2x1ZGUvbGludXgv
YmxrZGV2LmgKaW5kZXggMmZjNGJhNmZhMDdmLi5hOGRmYmFkNDJkMWIgMTAwNjQ0Ci0tLSBhL2lu
Y2x1ZGUvbGludXgvYmxrZGV2LmgKKysrIGIvaW5jbHVkZS9saW51eC9ibGtkZXYuaApAQCAtNDQ2
LDYgKzQ0Niw3IEBAIHN0cnVjdCByZXF1ZXN0X3F1ZXVlIHsKIAlpbnQJCQlub2RlOwogI2lmZGVm
IENPTkZJR19CTEtfREVWX0lPX1RSQUNFCiAJc3RydWN0IGJsa190cmFjZQkqYmxrX3RyYWNlOwor
CXN0cnVjdCBtdXRleAkJYmxrX3RyYWNlX211dGV4OwogI2VuZGlmCiAJLyoKIAkgKiBmb3IgZmx1
c2ggb3BlcmF0aW9ucwpkaWZmIC0tZ2l0IGEva2VybmVsL3RyYWNlL2Jsa3RyYWNlLmMgYi9rZXJu
ZWwvdHJhY2UvYmxrdHJhY2UuYwppbmRleCBiZmE4YmIzYTZlMTkuLmZmMTM4NGM1ODg0YyAxMDA2
NDQKLS0tIGEva2VybmVsL3RyYWNlL2Jsa3RyYWNlLmMKKysrIGIva2VybmVsL3RyYWNlL2Jsa3Ry
YWNlLmMKQEAgLTY0NCw2ICs2NDQsMTIgQEAgaW50IGJsa190cmFjZV9zdGFydHN0b3Aoc3RydWN0
IHJlcXVlc3RfcXVldWUgKnEsIGludCBzdGFydCkKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKGJsa190
cmFjZV9zdGFydHN0b3ApOwogCisvKgorICogV2hlbiByZWFkaW5nIG9yIHdyaXRpbmcgdGhlIGJs
a3RyYWNlIHN5c2ZzIGZpbGVzLCB0aGUgcmVmZXJlbmNlcyB0byB0aGUKKyAqIG9wZW5lZCBzeXNm
cyBvciBkZXZpY2UgZmlsZXMgc2hvdWxkIHByZXZlbnQgdGhlIHVuZGVybHlpbmcgYmxvY2sgZGV2
aWNlCisgKiBmcm9tIGJlaW5nIHJlbW92ZWQuIFNvIG5vIGZ1cnRoZXIgZGVsZXRlIHByb3RlY3Rp
b24gaXMgcmVhbGx5IG5lZWRlZC4KKyAqLworCiAvKioKICAqIGJsa190cmFjZV9pb2N0bDogLSBo
YW5kbGUgdGhlIGlvY3RscyBhc3NvY2lhdGVkIHdpdGggdHJhY2luZwogICogQGJkZXY6CXRoZSBi
bG9jayBkZXZpY2UKQEAgLTY2MSw3ICs2NjcsNyBAQCBpbnQgYmxrX3RyYWNlX2lvY3RsKHN0cnVj
dCBibG9ja19kZXZpY2UgKmJkZXYsIHVuc2lnbmVkIGNtZCwgY2hhciBfX3VzZXIgKmFyZykKIAlp
ZiAoIXEpCiAJCXJldHVybiAtRU5YSU87CiAKLQltdXRleF9sb2NrKCZiZGV2LT5iZF9tdXRleCk7
CisJbXV0ZXhfbG9jaygmcS0+YmxrX3RyYWNlX211dGV4KTsKIAogCXN3aXRjaCAoY21kKSB7CiAJ
Y2FzZSBCTEtUUkFDRVNFVFVQOgpAQCAtNjg3LDcgKzY5Myw3IEBAIGludCBibGtfdHJhY2VfaW9j
dGwoc3RydWN0IGJsb2NrX2RldmljZSAqYmRldiwgdW5zaWduZWQgY21kLCBjaGFyIF9fdXNlciAq
YXJnKQogCQlicmVhazsKIAl9CiAKLQltdXRleF91bmxvY2soJmJkZXYtPmJkX211dGV4KTsKKwlt
dXRleF91bmxvY2soJnEtPmJsa190cmFjZV9tdXRleCk7CiAJcmV0dXJuIHJldDsKIH0KIApAQCAt
MTY1Niw3ICsxNjYyLDcgQEAgc3RhdGljIHNzaXplX3Qgc3lzZnNfYmxrX3RyYWNlX2F0dHJfc2hv
dyhzdHJ1Y3QgZGV2aWNlICpkZXYsCiAJaWYgKHEgPT0gTlVMTCkKIAkJZ290byBvdXRfYmRwdXQ7
CiAKLQltdXRleF9sb2NrKCZiZGV2LT5iZF9tdXRleCk7CisJbXV0ZXhfbG9jaygmcS0+YmxrX3Ry
YWNlX211dGV4KTsKIAogCWlmIChhdHRyID09ICZkZXZfYXR0cl9lbmFibGUpIHsKIAkJcmV0ID0g
c3ByaW50ZihidWYsICIldVxuIiwgISFxLT5ibGtfdHJhY2UpOwpAQCAtMTY3NSw3ICsxNjgxLDcg
QEAgc3RhdGljIHNzaXplX3Qgc3lzZnNfYmxrX3RyYWNlX2F0dHJfc2hvdyhzdHJ1Y3QgZGV2aWNl
ICpkZXYsCiAJCXJldCA9IHNwcmludGYoYnVmLCAiJWxsdVxuIiwgcS0+YmxrX3RyYWNlLT5lbmRf
bGJhKTsKIAogb3V0X3VubG9ja19iZGV2OgotCW11dGV4X3VubG9jaygmYmRldi0+YmRfbXV0ZXgp
OworCW11dGV4X3VubG9jaygmcS0+YmxrX3RyYWNlX211dGV4KTsKIG91dF9iZHB1dDoKIAliZHB1
dChiZGV2KTsKIG91dDoKQEAgLTE3MTcsNyArMTcyMyw3IEBAIHN0YXRpYyBzc2l6ZV90IHN5c2Zz
X2Jsa190cmFjZV9hdHRyX3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKIAlpZiAocSA9PSBOVUxM
KQogCQlnb3RvIG91dF9iZHB1dDsKIAotCW11dGV4X2xvY2soJmJkZXYtPmJkX211dGV4KTsKKwlt
dXRleF9sb2NrKCZxLT5ibGtfdHJhY2VfbXV0ZXgpOwogCiAJaWYgKGF0dHIgPT0gJmRldl9hdHRy
X2VuYWJsZSkgewogCQlpZiAoISF2YWx1ZSA9PSAhIXEtPmJsa190cmFjZSkgewpAQCAtMTc0Nyw3
ICsxNzUzLDcgQEAgc3RhdGljIHNzaXplX3Qgc3lzZnNfYmxrX3RyYWNlX2F0dHJfc3RvcmUoc3Ry
dWN0IGRldmljZSAqZGV2LAogCX0KIAogb3V0X3VubG9ja19iZGV2OgotCW11dGV4X3VubG9jaygm
YmRldi0+YmRfbXV0ZXgpOworCW11dGV4X3VubG9jaygmcS0+YmxrX3RyYWNlX211dGV4KTsKIG91
dF9iZHB1dDoKIAliZHB1dChiZGV2KTsKIG91dDoKCkZyb20gOTlmN2Q0MGY4ZTAyZjk5ODJkMDNm
M2Q5NmQzMDU3OGQ4ZGZjZGNjMSBNb24gU2VwIDE3IDAwOjAwOjAwIDIwMDEKRnJvbTogSmVucyBB
eGJvZSA8YXhib2VAa2VybmVsLmRrPgpEYXRlOiBTdW4sIDUgTm92IDIwMTcgMDk6MTM6NDggLTA3
MDAKU3ViamVjdDogYmxrdHJhY2U6IGZpeCB1bmxvY2tlZCBhY2Nlc3MgdG8gaW5pdC9zdGFydC1z
dG9wL3RlYXJkb3duCgpjb21taXQgMWYyY2FjMTA3YzU5MWMyNGI2MGIxMTVkNjA1MGFkYzIxM2Qx
MGZjMCB1cHN0cmVhbS4KCnNnLmMgY2FsbHMgaW50byB0aGUgYmxrdHJhY2UgZnVuY3Rpb25zIHdp
dGhvdXQgaG9sZGluZyB0aGUgcHJvcGVyIHF1ZXVlCm11dGV4IGZvciBkb2luZyBzZXR1cCwgc3Rh
cnQvc3RvcCwgb3IgdGVhcmRvd24uCgpBZGQgaW50ZXJuYWwgdW5sb2NrZWQgdmFyaWFudHMsIGFu
ZCBleHBvcnQgdGhlIG9uZXMgdGhhdCBkbyB0aGUgcHJvcGVyCmxvY2tpbmcuCgpGaXhlczogNmRh
MTI3YWQwOTE4ICgiYmxrdHJhY2U6IEFkZCBibGt0cmFjZSBpb2N0bHMgdG8gU0NTSSBnZW5lcmlj
IGRldmljZXMiKQpUZXN0ZWQtYnk6IERtaXRyeSBWeXVrb3YgPGR2eXVrb3ZAZ29vZ2xlLmNvbT4K
U2lnbmVkLW9mZi1ieTogSmVucyBBeGJvZSA8YXhib2VAa2VybmVsLmRrPgpTaWduZWQtb2ZmLWJ5
OiBCZW4gSHV0Y2hpbmdzIDxiZW4uaHV0Y2hpbmdzQGNvZGV0aGluay5jby51az4KLS0tCiBrZXJu
ZWwvdHJhY2UvYmxrdHJhY2UuYyB8IDU4ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KystLS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgNDggaW5zZXJ0aW9ucygrKSwgMTAgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEva2VybmVsL3RyYWNlL2Jsa3RyYWNlLmMgYi9rZXJuZWwvdHJhY2Uv
YmxrdHJhY2UuYwppbmRleCBmZjEzODRjNTg4NGMuLjU1MzM3ZDc5N2RlYiAxMDA2NDQKLS0tIGEv
a2VybmVsL3RyYWNlL2Jsa3RyYWNlLmMKKysrIGIva2VybmVsL3RyYWNlL2Jsa3RyYWNlLmMKQEAg
LTMyOSw3ICszMjksNyBAQCBzdGF0aWMgdm9pZCBibGtfdHJhY2VfY2xlYW51cChzdHJ1Y3QgYmxr
X3RyYWNlICpidCkKIAlwdXRfcHJvYmVfcmVmKCk7CiB9CiAKLWludCBibGtfdHJhY2VfcmVtb3Zl
KHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxKQorc3RhdGljIGludCBfX2Jsa190cmFjZV9yZW1vdmUo
c3RydWN0IHJlcXVlc3RfcXVldWUgKnEpCiB7CiAJc3RydWN0IGJsa190cmFjZSAqYnQ7CiAKQEAg
LTM0Miw2ICszNDIsMTcgQEAgaW50IGJsa190cmFjZV9yZW1vdmUoc3RydWN0IHJlcXVlc3RfcXVl
dWUgKnEpCiAKIAlyZXR1cm4gMDsKIH0KKworaW50IGJsa190cmFjZV9yZW1vdmUoc3RydWN0IHJl
cXVlc3RfcXVldWUgKnEpCit7CisJaW50IHJldDsKKworCW11dGV4X2xvY2soJnEtPmJsa190cmFj
ZV9tdXRleCk7CisJcmV0ID0gX19ibGtfdHJhY2VfcmVtb3ZlKHEpOworCW11dGV4X3VubG9jaygm
cS0+YmxrX3RyYWNlX211dGV4KTsKKworCXJldHVybiByZXQ7Cit9CiBFWFBPUlRfU1lNQk9MX0dQ
TChibGtfdHJhY2VfcmVtb3ZlKTsKIAogc3RhdGljIHNzaXplX3QgYmxrX2Ryb3BwZWRfcmVhZChz
dHJ1Y3QgZmlsZSAqZmlscCwgY2hhciBfX3VzZXIgKmJ1ZmZlciwKQEAgLTU0Niw5ICs1NTcsOCBA
QCBpbnQgZG9fYmxrX3RyYWNlX3NldHVwKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLCBjaGFyICpu
YW1lLCBkZXZfdCBkZXYsCiAJcmV0dXJuIHJldDsKIH0KIAotaW50IGJsa190cmFjZV9zZXR1cChz
dHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSwgY2hhciAqbmFtZSwgZGV2X3QgZGV2LAotCQkgICAgc3Ry
dWN0IGJsb2NrX2RldmljZSAqYmRldiwKLQkJICAgIGNoYXIgX191c2VyICphcmcpCitzdGF0aWMg
aW50IF9fYmxrX3RyYWNlX3NldHVwKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLCBjaGFyICpuYW1l
LCBkZXZfdCBkZXYsCisJCQkgICAgIHN0cnVjdCBibG9ja19kZXZpY2UgKmJkZXYsIGNoYXIgX191
c2VyICphcmcpCiB7CiAJc3RydWN0IGJsa191c2VyX3RyYWNlX3NldHVwIGJ1dHM7CiAJaW50IHJl
dDsKQEAgLTU2Nyw2ICs1NzcsMTkgQEAgaW50IGJsa190cmFjZV9zZXR1cChzdHJ1Y3QgcmVxdWVz
dF9xdWV1ZSAqcSwgY2hhciAqbmFtZSwgZGV2X3QgZGV2LAogCX0KIAlyZXR1cm4gMDsKIH0KKwor
aW50IGJsa190cmFjZV9zZXR1cChzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSwgY2hhciAqbmFtZSwg
ZGV2X3QgZGV2LAorCQkgICAgc3RydWN0IGJsb2NrX2RldmljZSAqYmRldiwKKwkJICAgIGNoYXIg
X191c2VyICphcmcpCit7CisJaW50IHJldDsKKworCW11dGV4X2xvY2soJnEtPmJsa190cmFjZV9t
dXRleCk7CisJcmV0ID0gX19ibGtfdHJhY2Vfc2V0dXAocSwgbmFtZSwgZGV2LCBiZGV2LCBhcmcp
OworCW11dGV4X3VubG9jaygmcS0+YmxrX3RyYWNlX211dGV4KTsKKworCXJldHVybiByZXQ7Cit9
CiBFWFBPUlRfU1lNQk9MX0dQTChibGtfdHJhY2Vfc2V0dXApOwogCiAjaWYgZGVmaW5lZChDT05G
SUdfQ09NUEFUKSAmJiBkZWZpbmVkKENPTkZJR19YODZfNjQpCkBAIC02MDMsNyArNjI2LDcgQEAg
c3RhdGljIGludCBjb21wYXRfYmxrX3RyYWNlX3NldHVwKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpx
LCBjaGFyICpuYW1lLAogfQogI2VuZGlmCiAKLWludCBibGtfdHJhY2Vfc3RhcnRzdG9wKHN0cnVj
dCByZXF1ZXN0X3F1ZXVlICpxLCBpbnQgc3RhcnQpCitzdGF0aWMgaW50IF9fYmxrX3RyYWNlX3N0
YXJ0c3RvcChzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSwgaW50IHN0YXJ0KQogewogCWludCByZXQ7
CiAJc3RydWN0IGJsa190cmFjZSAqYnQgPSBxLT5ibGtfdHJhY2U7CkBAIC02NDIsNiArNjY1LDE3
IEBAIGludCBibGtfdHJhY2Vfc3RhcnRzdG9wKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLCBpbnQg
c3RhcnQpCiAKIAlyZXR1cm4gcmV0OwogfQorCitpbnQgYmxrX3RyYWNlX3N0YXJ0c3RvcChzdHJ1
Y3QgcmVxdWVzdF9xdWV1ZSAqcSwgaW50IHN0YXJ0KQoreworCWludCByZXQ7CisKKwltdXRleF9s
b2NrKCZxLT5ibGtfdHJhY2VfbXV0ZXgpOworCXJldCA9IF9fYmxrX3RyYWNlX3N0YXJ0c3RvcChx
LCBzdGFydCk7CisJbXV0ZXhfdW5sb2NrKCZxLT5ibGtfdHJhY2VfbXV0ZXgpOworCisJcmV0dXJu
IHJldDsKK30KIEVYUE9SVF9TWU1CT0xfR1BMKGJsa190cmFjZV9zdGFydHN0b3ApOwogCiAvKgpA
QCAtNjcyLDcgKzcwNiw3IEBAIGludCBibGtfdHJhY2VfaW9jdGwoc3RydWN0IGJsb2NrX2Rldmlj
ZSAqYmRldiwgdW5zaWduZWQgY21kLCBjaGFyIF9fdXNlciAqYXJnKQogCXN3aXRjaCAoY21kKSB7
CiAJY2FzZSBCTEtUUkFDRVNFVFVQOgogCQliZGV2bmFtZShiZGV2LCBiKTsKLQkJcmV0ID0gYmxr
X3RyYWNlX3NldHVwKHEsIGIsIGJkZXYtPmJkX2RldiwgYmRldiwgYXJnKTsKKwkJcmV0ID0gX19i
bGtfdHJhY2Vfc2V0dXAocSwgYiwgYmRldi0+YmRfZGV2LCBiZGV2LCBhcmcpOwogCQlicmVhazsK
ICNpZiBkZWZpbmVkKENPTkZJR19DT01QQVQpICYmIGRlZmluZWQoQ09ORklHX1g4Nl82NCkKIAlj
YXNlIEJMS1RSQUNFU0VUVVAzMjoKQEAgLTY4MywxMCArNzE3LDEwIEBAIGludCBibGtfdHJhY2Vf
aW9jdGwoc3RydWN0IGJsb2NrX2RldmljZSAqYmRldiwgdW5zaWduZWQgY21kLCBjaGFyIF9fdXNl
ciAqYXJnKQogCWNhc2UgQkxLVFJBQ0VTVEFSVDoKIAkJc3RhcnQgPSAxOwogCWNhc2UgQkxLVFJB
Q0VTVE9QOgotCQlyZXQgPSBibGtfdHJhY2Vfc3RhcnRzdG9wKHEsIHN0YXJ0KTsKKwkJcmV0ID0g
X19ibGtfdHJhY2Vfc3RhcnRzdG9wKHEsIHN0YXJ0KTsKIAkJYnJlYWs7CiAJY2FzZSBCTEtUUkFD
RVRFQVJET1dOOgotCQlyZXQgPSBibGtfdHJhY2VfcmVtb3ZlKHEpOworCQlyZXQgPSBfX2Jsa190
cmFjZV9yZW1vdmUocSk7CiAJCWJyZWFrOwogCWRlZmF1bHQ6CiAJCXJldCA9IC1FTk9UVFk7CkBA
IC03MDQsMTAgKzczOCwxNCBAQCBpbnQgYmxrX3RyYWNlX2lvY3RsKHN0cnVjdCBibG9ja19kZXZp
Y2UgKmJkZXYsIHVuc2lnbmVkIGNtZCwgY2hhciBfX3VzZXIgKmFyZykKICAqKi8KIHZvaWQgYmxr
X3RyYWNlX3NodXRkb3duKHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxKQogeworCW11dGV4X2xvY2so
JnEtPmJsa190cmFjZV9tdXRleCk7CisKIAlpZiAocS0+YmxrX3RyYWNlKSB7Ci0JCWJsa190cmFj
ZV9zdGFydHN0b3AocSwgMCk7Ci0JCWJsa190cmFjZV9yZW1vdmUocSk7CisJCV9fYmxrX3RyYWNl
X3N0YXJ0c3RvcChxLCAwKTsKKwkJX19ibGtfdHJhY2VfcmVtb3ZlKHEpOwogCX0KKworCW11dGV4
X3VubG9jaygmcS0+YmxrX3RyYWNlX211dGV4KTsKIH0KIAogLyoKCkZyb20gYzBkOWY0MzE1MDhl
OTM5ODRlZDk2ZTBlN2YzYmY4YTA3ODZiZDllNCBNb24gU2VwIDE3IDAwOjAwOjAwIDIwMDEKRnJv
bTogSmVucyBBeGJvZSA8YXhib2VAa2VybmVsLmRrPgpEYXRlOiBTdW4sIDE5IE5vdiAyMDE3IDEx
OjUyOjU1IC0wNzAwClN1YmplY3Q6IGJsa3RyYWNlOiBmaXggdHJhY2UgbXV0ZXggZGVhZGxvY2sK
CmNvbW1pdCAyOTY3YWNiYjI1N2E2YTliZjkxMmY0Nzc4YjcyN2UwMDk3MmVhYzliIHVwc3RyZWFt
LgoKQSBwcmV2aW91cyBjb21taXQgY2hhbmdlZCB0aGUgbG9ja2luZyBhcm91bmQgcmVnaXN0cmF0
aW9uL2NsZWFudXAsCmJ1dCBkaXJlY3QgY2FsbGVycyBvZiBibGtfdHJhY2VfcmVtb3ZlKCkgd2Vy
ZSBtaXNzZWQuIFRoaXMgbWVhbnMKdGhhdCBpZiB3ZSBoaXQgdGhlIGVycm9yIHBhdGggaW4gc2V0
dXAsIHdlIHdpbGwgZGVhZGxvY2sgb24KYXR0ZW1wdGluZyB0byByZS1hY3F1aXJlIHRoZSBxdWV1
ZSB0cmFjZSBtdXRleC4KCkZpeGVzOiAxZjJjYWMxMDdjNTkgKCJibGt0cmFjZTogZml4IHVubG9j
a2VkIGFjY2VzcyB0byBpbml0L3N0YXJ0LXN0b3AvdGVhcmRvd24iKQpTaWduZWQtb2ZmLWJ5OiBK
ZW5zIEF4Ym9lIDxheGJvZUBrZXJuZWwuZGs+ClNpZ25lZC1vZmYtYnk6IEJlbiBIdXRjaGluZ3Mg
PGJlbi5odXRjaGluZ3NAY29kZXRoaW5rLmNvLnVrPgotLS0KIGtlcm5lbC90cmFjZS9ibGt0cmFj
ZS5jIHwgNCArKy0tCiAxIGZpbGUgY2hhbmdlZCwgMiBpbnNlcnRpb25zKCspLCAyIGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL2tlcm5lbC90cmFjZS9ibGt0cmFjZS5jIGIva2VybmVsL3RyYWNl
L2Jsa3RyYWNlLmMKaW5kZXggNTUzMzdkNzk3ZGViLi5hODhlNjc3Yzc0ZjMgMTAwNjQ0Ci0tLSBh
L2tlcm5lbC90cmFjZS9ibGt0cmFjZS5jCisrKyBiL2tlcm5lbC90cmFjZS9ibGt0cmFjZS5jCkBA
IC01NzIsNyArNTcyLDcgQEAgc3RhdGljIGludCBfX2Jsa190cmFjZV9zZXR1cChzdHJ1Y3QgcmVx
dWVzdF9xdWV1ZSAqcSwgY2hhciAqbmFtZSwgZGV2X3QgZGV2LAogCQlyZXR1cm4gcmV0OwogCiAJ
aWYgKGNvcHlfdG9fdXNlcihhcmcsICZidXRzLCBzaXplb2YoYnV0cykpKSB7Ci0JCWJsa190cmFj
ZV9yZW1vdmUocSk7CisJCV9fYmxrX3RyYWNlX3JlbW92ZShxKTsKIAkJcmV0dXJuIC1FRkFVTFQ7
CiAJfQogCXJldHVybiAwOwpAQCAtNjE4LDcgKzYxOCw3IEBAIHN0YXRpYyBpbnQgY29tcGF0X2Js
a190cmFjZV9zZXR1cChzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSwgY2hhciAqbmFtZSwKIAkJcmV0
dXJuIHJldDsKIAogCWlmIChjb3B5X3RvX3VzZXIoYXJnLCAmYnV0cy5uYW1lLCBBUlJBWV9TSVpF
KGJ1dHMubmFtZSkpKSB7Ci0JCWJsa190cmFjZV9yZW1vdmUocSk7CisJCV9fYmxrX3RyYWNlX3Jl
bW92ZShxKTsKIAkJcmV0dXJuIC1FRkFVTFQ7CiAJfQogCgpGcm9tIDIxNDE0NzIyMzIwNWQ1NWVm
ODhmNGM1Nzg4OTZiNmE0NmU2NzRhZWIgTW9uIFNlcCAxNyAwMDowMDowMCAyMDAxCkZyb206IEph
biBLYXJhIDxqYWNrQHN1c2UuY3o+CkRhdGU6IFRodSwgNiBGZWIgMjAyMCAxNToyODoxMiArMDEw
MApTdWJqZWN0OiBibGt0cmFjZTogUHJvdGVjdCBxLT5ibGtfdHJhY2Ugd2l0aCBSQ1UKCmNvbW1p
dCBjNzgwZTg2ZGQ0OGVmNjQ2N2ExMTQ2Y2Y3ZDBmZTFlMDVhNjM1MDM5IHVwc3RyZWFtLgoKS0FT
QU4gaXMgcmVwb3J0aW5nIHRoYXQgX19ibGtfYWRkX3RyYWNlKCkgaGFzIGEgdXNlLWFmdGVyLWZy
ZWUgaXNzdWUKd2hlbiBhY2Nlc3NpbmcgcS0+YmxrX3RyYWNlLiBJbmRlZWQgdGhlIHN3aXRjaGlu
ZyBvZiBibG9jayB0cmFjaW5nIChhbmQKdGh1cyBldmVudHVhbCBmcmVlaW5nIG9mIHEtPmJsa190
cmFjZSkgaXMgY29tcGxldGVseSB1bnN5bmNocm9uaXplZCB3aXRoCnRoZSBjdXJyZW50bHkgcnVu
bmluZyB0cmFjaW5nIGFuZCB0aHVzIGl0IGNhbiBoYXBwZW4gdGhhdCB0aGUgYmxrX3RyYWNlCnN0
cnVjdHVyZSBpcyBiZWluZyBmcmVlZCBqdXN0IHdoaWxlIF9fYmxrX2FkZF90cmFjZSgpIHdvcmtz
IG9uIGl0LgpQcm90ZWN0IGFjY2Vzc2VzIHRvIHEtPmJsa190cmFjZSBieSBSQ1UgZHVyaW5nIHRy
YWNpbmcgYW5kIG1ha2Ugc3VyZSB3ZQp3YWl0IGZvciB0aGUgZW5kIG9mIFJDVSBncmFjZSBwZXJp
b2Qgd2hlbiBzaHV0dGluZyBkb3duIHRyYWNpbmcuIEx1Y2tpbHkKdGhhdCBpcyByYXJlIGVub3Vn
aCBldmVudCB0aGF0IHdlIGNhbiBhZmZvcmQgdGhhdC4gTm90ZSB0aGF0IHBvc3Rwb25pbmcKdGhl
IGZyZWVpbmcgb2YgYmxrX3RyYWNlIHRvIGFuIFJDVSBjYWxsYmFjayBzaG91bGQgYmV0dGVyIGJl
IGF2b2lkZWQgYXMKaXQgY291bGQgaGF2ZSB1bmV4cGVjdGVkIHVzZXIgdmlzaWJsZSBzaWRlLWVm
ZmVjdHMgYXMgZGVidWdmcyBmaWxlcwp3b3VsZCBiZSBzdGlsbCBleGlzdGluZyBmb3IgYSBzaG9y
dCB3aGlsZSBibG9jayB0cmFjaW5nIGhhcyBiZWVuIHNodXQKZG93bi4KCkxpbms6IGh0dHBzOi8v
YnVnemlsbGEua2VybmVsLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MjA1NzExCkNDOiBzdGFibGVAdmdl
ci5rZXJuZWwub3JnClJldmlld2VkLWJ5OiBDaGFpdGFueWEgS3Vsa2FybmkgPGNoYWl0YW55YS5r
dWxrYXJuaUB3ZGMuY29tPgpSZXZpZXdlZC1ieTogTWluZyBMZWkgPG1pbmcubGVpQHJlZGhhdC5j
b20+ClRlc3RlZC1ieTogTWluZyBMZWkgPG1pbmcubGVpQHJlZGhhdC5jb20+ClJldmlld2VkLWJ5
OiBCYXJ0IFZhbiBBc3NjaGUgPGJ2YW5hc3NjaGVAYWNtLm9yZz4KUmVwb3J0ZWQtYnk6IFRyaXN0
YW4gTWFkYW5pIDx0cmlzdG1kQGdtYWlsLmNvbT4KU2lnbmVkLW9mZi1ieTogSmFuIEthcmEgPGph
Y2tAc3VzZS5jej4KU2lnbmVkLW9mZi1ieTogSmVucyBBeGJvZSA8YXhib2VAa2VybmVsLmRrPgpb
YndoOiBCYWNrcG9ydGVkIHRvIDQuOTogYWRqdXN0IGNvbnRleHRdClNpZ25lZC1vZmYtYnk6IEJl
biBIdXRjaGluZ3MgPGJlbi5odXRjaGluZ3NAY29kZXRoaW5rLmNvLnVrPgotLS0KIGluY2x1ZGUv
bGludXgvYmxrZGV2LmggICAgICAgfCAgIDIgKy0KIGluY2x1ZGUvbGludXgvYmxrdHJhY2VfYXBp
LmggfCAgMTggKysrKy0tCiBrZXJuZWwvdHJhY2UvYmxrdHJhY2UuYyAgICAgIHwgMTEwICsrKysr
KysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tCiAzIGZpbGVzIGNoYW5nZWQsIDk0IGluc2Vy
dGlvbnMoKyksIDM2IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvYmxr
ZGV2LmggYi9pbmNsdWRlL2xpbnV4L2Jsa2Rldi5oCmluZGV4IGE4ZGZiYWQ0MmQxYi4uMDYwODgx
NDc4ZTU5IDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L2Jsa2Rldi5oCisrKyBiL2luY2x1ZGUv
bGludXgvYmxrZGV2LmgKQEAgLTQ0NSw3ICs0NDUsNyBAQCBzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSB7
CiAJdW5zaWduZWQgaW50CQlzZ19yZXNlcnZlZF9zaXplOwogCWludAkJCW5vZGU7CiAjaWZkZWYg
Q09ORklHX0JMS19ERVZfSU9fVFJBQ0UKLQlzdHJ1Y3QgYmxrX3RyYWNlCSpibGtfdHJhY2U7CisJ
c3RydWN0IGJsa190cmFjZSBfX3JjdQkqYmxrX3RyYWNlOwogCXN0cnVjdCBtdXRleAkJYmxrX3Ry
YWNlX211dGV4OwogI2VuZGlmCiAJLyoKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvYmxrdHJh
Y2VfYXBpLmggYi9pbmNsdWRlL2xpbnV4L2Jsa3RyYWNlX2FwaS5oCmluZGV4IGNjZWI3MmY5ZTI5
Zi4uNDVmYjAwNDI3MzA2IDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L2Jsa3RyYWNlX2FwaS5o
CisrKyBiL2luY2x1ZGUvbGludXgvYmxrdHJhY2VfYXBpLmgKQEAgLTUxLDE4ICs1MSwyNiBAQCB2
b2lkIF9fdHJhY2Vfbm90ZV9tZXNzYWdlKHN0cnVjdCBibGtfdHJhY2UgKiwgY29uc3QgY2hhciAq
Zm10LCAuLi4pOwogICoqLwogI2RlZmluZSBibGtfYWRkX3RyYWNlX21zZyhxLCBmbXQsIC4uLikJ
CQkJCVwKIAlkbyB7CQkJCQkJCQlcCi0JCXN0cnVjdCBibGtfdHJhY2UgKmJ0ID0gKHEpLT5ibGtf
dHJhY2U7CQkJXAorCQlzdHJ1Y3QgYmxrX3RyYWNlICpidDsJCQkJCVwKKwkJCQkJCQkJCVwKKwkJ
cmN1X3JlYWRfbG9jaygpOwkJCQkJXAorCQlidCA9IHJjdV9kZXJlZmVyZW5jZSgocSktPmJsa190
cmFjZSk7CQkJXAogCQlpZiAodW5saWtlbHkoYnQpKQkJCQkJXAogCQkJX190cmFjZV9ub3RlX21l
c3NhZ2UoYnQsIGZtdCwgIyNfX1ZBX0FSR1NfXyk7CVwKKwkJcmN1X3JlYWRfdW5sb2NrKCk7CQkJ
CQlcCiAJfSB3aGlsZSAoMCkKICNkZWZpbmUgQkxLX1ROX01BWF9NU0cJCTEyOAogCiBzdGF0aWMg
aW5saW5lIGJvb2wgYmxrX3RyYWNlX25vdGVfbWVzc2FnZV9lbmFibGVkKHN0cnVjdCByZXF1ZXN0
X3F1ZXVlICpxKQogewotCXN0cnVjdCBibGtfdHJhY2UgKmJ0ID0gcS0+YmxrX3RyYWNlOwotCWlm
IChsaWtlbHkoIWJ0KSkKLQkJcmV0dXJuIGZhbHNlOwotCXJldHVybiBidC0+YWN0X21hc2sgJiBC
TEtfVENfTk9USUZZOworCXN0cnVjdCBibGtfdHJhY2UgKmJ0OworCWJvb2wgcmV0OworCisJcmN1
X3JlYWRfbG9jaygpOworCWJ0ID0gcmN1X2RlcmVmZXJlbmNlKHEtPmJsa190cmFjZSk7CisJcmV0
ID0gYnQgJiYgKGJ0LT5hY3RfbWFzayAmIEJMS19UQ19OT1RJRlkpOworCXJjdV9yZWFkX3VubG9j
aygpOworCXJldHVybiByZXQ7CiB9CiAKIGV4dGVybiB2b2lkIGJsa19hZGRfZHJpdmVyX2RhdGEo
c3RydWN0IHJlcXVlc3RfcXVldWUgKnEsIHN0cnVjdCByZXF1ZXN0ICpycSwKZGlmZiAtLWdpdCBh
L2tlcm5lbC90cmFjZS9ibGt0cmFjZS5jIGIva2VybmVsL3RyYWNlL2Jsa3RyYWNlLmMKaW5kZXgg
YTg4ZTY3N2M3NGYzLi43OGE4OTZhY2QyMWEgMTAwNjQ0Ci0tLSBhL2tlcm5lbC90cmFjZS9ibGt0
cmFjZS5jCisrKyBiL2tlcm5lbC90cmFjZS9ibGt0cmFjZS5jCkBAIC0zMjUsNiArMzI1LDcgQEAg
c3RhdGljIHZvaWQgcHV0X3Byb2JlX3JlZih2b2lkKQogCiBzdGF0aWMgdm9pZCBibGtfdHJhY2Vf
Y2xlYW51cChzdHJ1Y3QgYmxrX3RyYWNlICpidCkKIHsKKwlzeW5jaHJvbml6ZV9yY3UoKTsKIAli
bGtfdHJhY2VfZnJlZShidCk7CiAJcHV0X3Byb2JlX3JlZigpOwogfQpAQCAtNjI5LDggKzYzMCwx
MCBAQCBzdGF0aWMgaW50IGNvbXBhdF9ibGtfdHJhY2Vfc2V0dXAoc3RydWN0IHJlcXVlc3RfcXVl
dWUgKnEsIGNoYXIgKm5hbWUsCiBzdGF0aWMgaW50IF9fYmxrX3RyYWNlX3N0YXJ0c3RvcChzdHJ1
Y3QgcmVxdWVzdF9xdWV1ZSAqcSwgaW50IHN0YXJ0KQogewogCWludCByZXQ7Ci0Jc3RydWN0IGJs
a190cmFjZSAqYnQgPSBxLT5ibGtfdHJhY2U7CisJc3RydWN0IGJsa190cmFjZSAqYnQ7CiAKKwli
dCA9IHJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQocS0+YmxrX3RyYWNlLAorCQkJCSAgICAgICBs
b2NrZGVwX2lzX2hlbGQoJnEtPmJsa190cmFjZV9tdXRleCkpOwogCWlmIChidCA9PSBOVUxMKQog
CQlyZXR1cm4gLUVJTlZBTDsKIApAQCAtNzM5LDggKzc0Miw4IEBAIGludCBibGtfdHJhY2VfaW9j
dGwoc3RydWN0IGJsb2NrX2RldmljZSAqYmRldiwgdW5zaWduZWQgY21kLCBjaGFyIF9fdXNlciAq
YXJnKQogdm9pZCBibGtfdHJhY2Vfc2h1dGRvd24oc3RydWN0IHJlcXVlc3RfcXVldWUgKnEpCiB7
CiAJbXV0ZXhfbG9jaygmcS0+YmxrX3RyYWNlX211dGV4KTsKLQotCWlmIChxLT5ibGtfdHJhY2Up
IHsKKwlpZiAocmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChxLT5ibGtfdHJhY2UsCisJCQkJICAg
ICAgbG9ja2RlcF9pc19oZWxkKCZxLT5ibGtfdHJhY2VfbXV0ZXgpKSkgewogCQlfX2Jsa190cmFj
ZV9zdGFydHN0b3AocSwgMCk7CiAJCV9fYmxrX3RyYWNlX3JlbW92ZShxKTsKIAl9CkBAIC03NjYs
MTAgKzc2OSwxNCBAQCB2b2lkIGJsa190cmFjZV9zaHV0ZG93bihzdHJ1Y3QgcmVxdWVzdF9xdWV1
ZSAqcSkKIHN0YXRpYyB2b2lkIGJsa19hZGRfdHJhY2VfcnEoc3RydWN0IHJlcXVlc3RfcXVldWUg
KnEsIHN0cnVjdCByZXF1ZXN0ICpycSwKIAkJCSAgICAgdW5zaWduZWQgaW50IG5yX2J5dGVzLCB1
MzIgd2hhdCkKIHsKLQlzdHJ1Y3QgYmxrX3RyYWNlICpidCA9IHEtPmJsa190cmFjZTsKKwlzdHJ1
Y3QgYmxrX3RyYWNlICpidDsKIAotCWlmIChsaWtlbHkoIWJ0KSkKKwlyY3VfcmVhZF9sb2NrKCk7
CisJYnQgPSByY3VfZGVyZWZlcmVuY2UocS0+YmxrX3RyYWNlKTsKKwlpZiAobGlrZWx5KCFidCkp
IHsKKwkJcmN1X3JlYWRfdW5sb2NrKCk7CiAJCXJldHVybjsKKwl9CiAKIAlpZiAocnEtPmNtZF90
eXBlID09IFJFUV9UWVBFX0JMT0NLX1BDKSB7CiAJCXdoYXQgfD0gQkxLX1RDX0FDVChCTEtfVENf
UEMpOwpAQCAtNzgwLDYgKzc4Nyw3IEBAIHN0YXRpYyB2b2lkIGJsa19hZGRfdHJhY2VfcnEoc3Ry
dWN0IHJlcXVlc3RfcXVldWUgKnEsIHN0cnVjdCByZXF1ZXN0ICpycSwKIAkJX19ibGtfYWRkX3Ry
YWNlKGJ0LCBibGtfcnFfcG9zKHJxKSwgbnJfYnl0ZXMsIHJlcV9vcChycSksCiAJCQkJcnEtPmNt
ZF9mbGFncywgd2hhdCwgcnEtPmVycm9ycywgMCwgTlVMTCk7CiAJfQorCXJjdV9yZWFkX3VubG9j
aygpOwogfQogCiBzdGF0aWMgdm9pZCBibGtfYWRkX3RyYWNlX3JxX2Fib3J0KHZvaWQgKmlnbm9y
ZSwKQEAgLTgyOSwxMyArODM3LDE4IEBAIHN0YXRpYyB2b2lkIGJsa19hZGRfdHJhY2VfcnFfY29t
cGxldGUodm9pZCAqaWdub3JlLAogc3RhdGljIHZvaWQgYmxrX2FkZF90cmFjZV9iaW8oc3RydWN0
IHJlcXVlc3RfcXVldWUgKnEsIHN0cnVjdCBiaW8gKmJpbywKIAkJCSAgICAgIHUzMiB3aGF0LCBp
bnQgZXJyb3IpCiB7Ci0Jc3RydWN0IGJsa190cmFjZSAqYnQgPSBxLT5ibGtfdHJhY2U7CisJc3Ry
dWN0IGJsa190cmFjZSAqYnQ7CiAKLQlpZiAobGlrZWx5KCFidCkpCisJcmN1X3JlYWRfbG9jaygp
OworCWJ0ID0gcmN1X2RlcmVmZXJlbmNlKHEtPmJsa190cmFjZSk7CisJaWYgKGxpa2VseSghYnQp
KSB7CisJCXJjdV9yZWFkX3VubG9jaygpOwogCQlyZXR1cm47CisJfQogCiAJX19ibGtfYWRkX3Ry
YWNlKGJ0LCBiaW8tPmJpX2l0ZXIuYmlfc2VjdG9yLCBiaW8tPmJpX2l0ZXIuYmlfc2l6ZSwKIAkJ
CWJpb19vcChiaW8pLCBiaW8tPmJpX29wZiwgd2hhdCwgZXJyb3IsIDAsIE5VTEwpOworCXJjdV9y
ZWFkX3VubG9jaygpOwogfQogCiBzdGF0aWMgdm9pZCBibGtfYWRkX3RyYWNlX2Jpb19ib3VuY2Uo
dm9pZCAqaWdub3JlLApAQCAtODgwLDExICs4OTMsMTQgQEAgc3RhdGljIHZvaWQgYmxrX2FkZF90
cmFjZV9nZXRycSh2b2lkICppZ25vcmUsCiAJaWYgKGJpbykKIAkJYmxrX2FkZF90cmFjZV9iaW8o
cSwgYmlvLCBCTEtfVEFfR0VUUlEsIDApOwogCWVsc2UgewotCQlzdHJ1Y3QgYmxrX3RyYWNlICpi
dCA9IHEtPmJsa190cmFjZTsKKwkJc3RydWN0IGJsa190cmFjZSAqYnQ7CiAKKwkJcmN1X3JlYWRf
bG9jaygpOworCQlidCA9IHJjdV9kZXJlZmVyZW5jZShxLT5ibGtfdHJhY2UpOwogCQlpZiAoYnQp
CiAJCQlfX2Jsa19hZGRfdHJhY2UoYnQsIDAsIDAsIHJ3LCAwLCBCTEtfVEFfR0VUUlEsIDAsIDAs
CiAJCQkJCU5VTEwpOworCQlyY3VfcmVhZF91bmxvY2soKTsKIAl9CiB9CiAKQEAgLTg5NiwyNyAr
OTEyLDM1IEBAIHN0YXRpYyB2b2lkIGJsa19hZGRfdHJhY2Vfc2xlZXBycSh2b2lkICppZ25vcmUs
CiAJaWYgKGJpbykKIAkJYmxrX2FkZF90cmFjZV9iaW8ocSwgYmlvLCBCTEtfVEFfU0xFRVBSUSwg
MCk7CiAJZWxzZSB7Ci0JCXN0cnVjdCBibGtfdHJhY2UgKmJ0ID0gcS0+YmxrX3RyYWNlOworCQlz
dHJ1Y3QgYmxrX3RyYWNlICpidDsKIAorCQlyY3VfcmVhZF9sb2NrKCk7CisJCWJ0ID0gcmN1X2Rl
cmVmZXJlbmNlKHEtPmJsa190cmFjZSk7CiAJCWlmIChidCkKIAkJCV9fYmxrX2FkZF90cmFjZShi
dCwgMCwgMCwgcncsIDAsIEJMS19UQV9TTEVFUFJRLAogCQkJCQkwLCAwLCBOVUxMKTsKKwkJcmN1
X3JlYWRfdW5sb2NrKCk7CiAJfQogfQogCiBzdGF0aWMgdm9pZCBibGtfYWRkX3RyYWNlX3BsdWco
dm9pZCAqaWdub3JlLCBzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSkKIHsKLQlzdHJ1Y3QgYmxrX3Ry
YWNlICpidCA9IHEtPmJsa190cmFjZTsKKwlzdHJ1Y3QgYmxrX3RyYWNlICpidDsKIAorCXJjdV9y
ZWFkX2xvY2soKTsKKwlidCA9IHJjdV9kZXJlZmVyZW5jZShxLT5ibGtfdHJhY2UpOwogCWlmIChi
dCkKIAkJX19ibGtfYWRkX3RyYWNlKGJ0LCAwLCAwLCAwLCAwLCBCTEtfVEFfUExVRywgMCwgMCwg
TlVMTCk7CisJcmN1X3JlYWRfdW5sb2NrKCk7CiB9CiAKIHN0YXRpYyB2b2lkIGJsa19hZGRfdHJh
Y2VfdW5wbHVnKHZvaWQgKmlnbm9yZSwgc3RydWN0IHJlcXVlc3RfcXVldWUgKnEsCiAJCQkJICAg
IHVuc2lnbmVkIGludCBkZXB0aCwgYm9vbCBleHBsaWNpdCkKIHsKLQlzdHJ1Y3QgYmxrX3RyYWNl
ICpidCA9IHEtPmJsa190cmFjZTsKKwlzdHJ1Y3QgYmxrX3RyYWNlICpidDsKIAorCXJjdV9yZWFk
X2xvY2soKTsKKwlidCA9IHJjdV9kZXJlZmVyZW5jZShxLT5ibGtfdHJhY2UpOwogCWlmIChidCkg
ewogCQlfX2JlNjQgcnBkdSA9IGNwdV90b19iZTY0KGRlcHRoKTsKIAkJdTMyIHdoYXQ7CkBAIC05
MjgsMTQgKzk1MiwxNyBAQCBzdGF0aWMgdm9pZCBibGtfYWRkX3RyYWNlX3VucGx1Zyh2b2lkICpp
Z25vcmUsIHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLAogCiAJCV9fYmxrX2FkZF90cmFjZShidCwg
MCwgMCwgMCwgMCwgd2hhdCwgMCwgc2l6ZW9mKHJwZHUpLCAmcnBkdSk7CiAJfQorCXJjdV9yZWFk
X3VubG9jaygpOwogfQogCiBzdGF0aWMgdm9pZCBibGtfYWRkX3RyYWNlX3NwbGl0KHZvaWQgKmln
bm9yZSwKIAkJCQlzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSwgc3RydWN0IGJpbyAqYmlvLAogCQkJ
CXVuc2lnbmVkIGludCBwZHUpCiB7Ci0Jc3RydWN0IGJsa190cmFjZSAqYnQgPSBxLT5ibGtfdHJh
Y2U7CisJc3RydWN0IGJsa190cmFjZSAqYnQ7CiAKKwlyY3VfcmVhZF9sb2NrKCk7CisJYnQgPSBy
Y3VfZGVyZWZlcmVuY2UocS0+YmxrX3RyYWNlKTsKIAlpZiAoYnQpIHsKIAkJX19iZTY0IHJwZHUg
PSBjcHVfdG9fYmU2NChwZHUpOwogCkBAIC05NDQsNiArOTcxLDcgQEAgc3RhdGljIHZvaWQgYmxr
X2FkZF90cmFjZV9zcGxpdCh2b2lkICppZ25vcmUsCiAJCQkJQkxLX1RBX1NQTElULCBiaW8tPmJp
X2Vycm9yLCBzaXplb2YocnBkdSksCiAJCQkJJnJwZHUpOwogCX0KKwlyY3VfcmVhZF91bmxvY2so
KTsKIH0KIAogLyoqCkBAIC05NjMsMTEgKzk5MSwxNSBAQCBzdGF0aWMgdm9pZCBibGtfYWRkX3Ry
YWNlX2Jpb19yZW1hcCh2b2lkICppZ25vcmUsCiAJCQkJICAgIHN0cnVjdCByZXF1ZXN0X3F1ZXVl
ICpxLCBzdHJ1Y3QgYmlvICpiaW8sCiAJCQkJICAgIGRldl90IGRldiwgc2VjdG9yX3QgZnJvbSkK
IHsKLQlzdHJ1Y3QgYmxrX3RyYWNlICpidCA9IHEtPmJsa190cmFjZTsKKwlzdHJ1Y3QgYmxrX3Ry
YWNlICpidDsKIAlzdHJ1Y3QgYmxrX2lvX3RyYWNlX3JlbWFwIHI7CiAKLQlpZiAobGlrZWx5KCFi
dCkpCisJcmN1X3JlYWRfbG9jaygpOworCWJ0ID0gcmN1X2RlcmVmZXJlbmNlKHEtPmJsa190cmFj
ZSk7CisJaWYgKGxpa2VseSghYnQpKSB7CisJCXJjdV9yZWFkX3VubG9jaygpOwogCQlyZXR1cm47
CisJfQogCiAJci5kZXZpY2VfZnJvbSA9IGNwdV90b19iZTMyKGRldik7CiAJci5kZXZpY2VfdG8g
ICA9IGNwdV90b19iZTMyKGJpby0+YmlfYmRldi0+YmRfZGV2KTsKQEAgLTk3Niw2ICsxMDA4LDcg
QEAgc3RhdGljIHZvaWQgYmxrX2FkZF90cmFjZV9iaW9fcmVtYXAodm9pZCAqaWdub3JlLAogCV9f
YmxrX2FkZF90cmFjZShidCwgYmlvLT5iaV9pdGVyLmJpX3NlY3RvciwgYmlvLT5iaV9pdGVyLmJp
X3NpemUsCiAJCQliaW9fb3AoYmlvKSwgYmlvLT5iaV9vcGYsIEJMS19UQV9SRU1BUCwgYmlvLT5i
aV9lcnJvciwKIAkJCXNpemVvZihyKSwgJnIpOworCXJjdV9yZWFkX3VubG9jaygpOwogfQogCiAv
KioKQEAgLTk5NiwxMSArMTAyOSwxNSBAQCBzdGF0aWMgdm9pZCBibGtfYWRkX3RyYWNlX3JxX3Jl
bWFwKHZvaWQgKmlnbm9yZSwKIAkJCQkgICBzdHJ1Y3QgcmVxdWVzdCAqcnEsIGRldl90IGRldiwK
IAkJCQkgICBzZWN0b3JfdCBmcm9tKQogewotCXN0cnVjdCBibGtfdHJhY2UgKmJ0ID0gcS0+Ymxr
X3RyYWNlOworCXN0cnVjdCBibGtfdHJhY2UgKmJ0OwogCXN0cnVjdCBibGtfaW9fdHJhY2VfcmVt
YXAgcjsKIAotCWlmIChsaWtlbHkoIWJ0KSkKKwlyY3VfcmVhZF9sb2NrKCk7CisJYnQgPSByY3Vf
ZGVyZWZlcmVuY2UocS0+YmxrX3RyYWNlKTsKKwlpZiAobGlrZWx5KCFidCkpIHsKKwkJcmN1X3Jl
YWRfdW5sb2NrKCk7CiAJCXJldHVybjsKKwl9CiAKIAlyLmRldmljZV9mcm9tID0gY3B1X3RvX2Jl
MzIoZGV2KTsKIAlyLmRldmljZV90byAgID0gY3B1X3RvX2JlMzIoZGlza19kZXZ0KHJxLT5ycV9k
aXNrKSk7CkBAIC0xMDA5LDYgKzEwNDYsNyBAQCBzdGF0aWMgdm9pZCBibGtfYWRkX3RyYWNlX3Jx
X3JlbWFwKHZvaWQgKmlnbm9yZSwKIAlfX2Jsa19hZGRfdHJhY2UoYnQsIGJsa19ycV9wb3MocnEp
LCBibGtfcnFfYnl0ZXMocnEpLAogCQkJcnFfZGF0YV9kaXIocnEpLCAwLCBCTEtfVEFfUkVNQVAs
ICEhcnEtPmVycm9ycywKIAkJCXNpemVvZihyKSwgJnIpOworCXJjdV9yZWFkX3VubG9jaygpOwog
fQogCiAvKioKQEAgLTEwMjYsMTAgKzEwNjQsMTQgQEAgdm9pZCBibGtfYWRkX2RyaXZlcl9kYXRh
KHN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxLAogCQkJIHN0cnVjdCByZXF1ZXN0ICpycSwKIAkJCSB2
b2lkICpkYXRhLCBzaXplX3QgbGVuKQogewotCXN0cnVjdCBibGtfdHJhY2UgKmJ0ID0gcS0+Ymxr
X3RyYWNlOworCXN0cnVjdCBibGtfdHJhY2UgKmJ0OwogCi0JaWYgKGxpa2VseSghYnQpKQorCXJj
dV9yZWFkX2xvY2soKTsKKwlidCA9IHJjdV9kZXJlZmVyZW5jZShxLT5ibGtfdHJhY2UpOworCWlm
IChsaWtlbHkoIWJ0KSkgeworCQlyY3VfcmVhZF91bmxvY2soKTsKIAkJcmV0dXJuOworCX0KIAog
CWlmIChycS0+Y21kX3R5cGUgPT0gUkVRX1RZUEVfQkxPQ0tfUEMpCiAJCV9fYmxrX2FkZF90cmFj
ZShidCwgMCwgYmxrX3JxX2J5dGVzKHJxKSwgMCwgMCwKQEAgLTEwMzcsNiArMTA3OSw3IEBAIHZv
aWQgYmxrX2FkZF9kcml2ZXJfZGF0YShzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSwKIAllbHNlCiAJ
CV9fYmxrX2FkZF90cmFjZShidCwgYmxrX3JxX3BvcyhycSksIGJsa19ycV9ieXRlcyhycSksIDAs
IDAsCiAJCQkJQkxLX1RBX0RSVl9EQVRBLCBycS0+ZXJyb3JzLCBsZW4sIGRhdGEpOworCXJjdV9y
ZWFkX3VubG9jaygpOwogfQogRVhQT1JUX1NZTUJPTF9HUEwoYmxrX2FkZF9kcml2ZXJfZGF0YSk7
CiAKQEAgLTE1MjksNiArMTU3Miw3IEBAIHN0YXRpYyBpbnQgYmxrX3RyYWNlX3JlbW92ZV9xdWV1
ZShzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSkKIAkJcmV0dXJuIC1FSU5WQUw7CiAKIAlwdXRfcHJv
YmVfcmVmKCk7CisJc3luY2hyb25pemVfcmN1KCk7CiAJYmxrX3RyYWNlX2ZyZWUoYnQpOwogCXJl
dHVybiAwOwogfQpAQCAtMTY5MCw2ICsxNzM0LDcgQEAgc3RhdGljIHNzaXplX3Qgc3lzZnNfYmxr
X3RyYWNlX2F0dHJfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCiAJc3RydWN0IGhkX3N0cnVjdCAq
cCA9IGRldl90b19wYXJ0KGRldik7CiAJc3RydWN0IHJlcXVlc3RfcXVldWUgKnE7CiAJc3RydWN0
IGJsb2NrX2RldmljZSAqYmRldjsKKwlzdHJ1Y3QgYmxrX3RyYWNlICpidDsKIAlzc2l6ZV90IHJl
dCA9IC1FTlhJTzsKIAogCWJkZXYgPSBiZGdldChwYXJ0X2RldnQocCkpOwpAQCAtMTcwMiwyMSAr
MTc0NywyMyBAQCBzdGF0aWMgc3NpemVfdCBzeXNmc19ibGtfdHJhY2VfYXR0cl9zaG93KHN0cnVj
dCBkZXZpY2UgKmRldiwKIAogCW11dGV4X2xvY2soJnEtPmJsa190cmFjZV9tdXRleCk7CiAKKwli
dCA9IHJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQocS0+YmxrX3RyYWNlLAorCQkJCSAgICAgICBs
b2NrZGVwX2lzX2hlbGQoJnEtPmJsa190cmFjZV9tdXRleCkpOwogCWlmIChhdHRyID09ICZkZXZf
YXR0cl9lbmFibGUpIHsKLQkJcmV0ID0gc3ByaW50ZihidWYsICIldVxuIiwgISFxLT5ibGtfdHJh
Y2UpOworCQlyZXQgPSBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCAhIWJ0KTsKIAkJZ290byBvdXRfdW5s
b2NrX2JkZXY7CiAJfQogCi0JaWYgKHEtPmJsa190cmFjZSA9PSBOVUxMKQorCWlmIChidCA9PSBO
VUxMKQogCQlyZXQgPSBzcHJpbnRmKGJ1ZiwgImRpc2FibGVkXG4iKTsKIAllbHNlIGlmIChhdHRy
ID09ICZkZXZfYXR0cl9hY3RfbWFzaykKLQkJcmV0ID0gYmxrX3RyYWNlX21hc2syc3RyKGJ1Ziwg
cS0+YmxrX3RyYWNlLT5hY3RfbWFzayk7CisJCXJldCA9IGJsa190cmFjZV9tYXNrMnN0cihidWYs
IGJ0LT5hY3RfbWFzayk7CiAJZWxzZSBpZiAoYXR0ciA9PSAmZGV2X2F0dHJfcGlkKQotCQlyZXQg
PSBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCBxLT5ibGtfdHJhY2UtPnBpZCk7CisJCXJldCA9IHNwcmlu
dGYoYnVmLCAiJXVcbiIsIGJ0LT5waWQpOwogCWVsc2UgaWYgKGF0dHIgPT0gJmRldl9hdHRyX3N0
YXJ0X2xiYSkKLQkJcmV0ID0gc3ByaW50ZihidWYsICIlbGx1XG4iLCBxLT5ibGtfdHJhY2UtPnN0
YXJ0X2xiYSk7CisJCXJldCA9IHNwcmludGYoYnVmLCAiJWxsdVxuIiwgYnQtPnN0YXJ0X2xiYSk7
CiAJZWxzZSBpZiAoYXR0ciA9PSAmZGV2X2F0dHJfZW5kX2xiYSkKLQkJcmV0ID0gc3ByaW50Zihi
dWYsICIlbGx1XG4iLCBxLT5ibGtfdHJhY2UtPmVuZF9sYmEpOworCQlyZXQgPSBzcHJpbnRmKGJ1
ZiwgIiVsbHVcbiIsIGJ0LT5lbmRfbGJhKTsKIAogb3V0X3VubG9ja19iZGV2OgogCW11dGV4X3Vu
bG9jaygmcS0+YmxrX3RyYWNlX211dGV4KTsKQEAgLTE3MzMsNiArMTc4MCw3IEBAIHN0YXRpYyBz
c2l6ZV90IHN5c2ZzX2Jsa190cmFjZV9hdHRyX3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKIAlz
dHJ1Y3QgYmxvY2tfZGV2aWNlICpiZGV2OwogCXN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxOwogCXN0
cnVjdCBoZF9zdHJ1Y3QgKnA7CisJc3RydWN0IGJsa190cmFjZSAqYnQ7CiAJdTY0IHZhbHVlOwog
CXNzaXplX3QgcmV0ID0gLUVJTlZBTDsKIApAQCAtMTc2Myw4ICsxODExLDEwIEBAIHN0YXRpYyBz
c2l6ZV90IHN5c2ZzX2Jsa190cmFjZV9hdHRyX3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKIAog
CW11dGV4X2xvY2soJnEtPmJsa190cmFjZV9tdXRleCk7CiAKKwlidCA9IHJjdV9kZXJlZmVyZW5j
ZV9wcm90ZWN0ZWQocS0+YmxrX3RyYWNlLAorCQkJCSAgICAgICBsb2NrZGVwX2lzX2hlbGQoJnEt
PmJsa190cmFjZV9tdXRleCkpOwogCWlmIChhdHRyID09ICZkZXZfYXR0cl9lbmFibGUpIHsKLQkJ
aWYgKCEhdmFsdWUgPT0gISFxLT5ibGtfdHJhY2UpIHsKKwkJaWYgKCEhdmFsdWUgPT0gISFidCkg
ewogCQkJcmV0ID0gMDsKIAkJCWdvdG8gb3V0X3VubG9ja19iZGV2OwogCQl9CkBAIC0xNzc2LDE4
ICsxODI2LDE4IEBAIHN0YXRpYyBzc2l6ZV90IHN5c2ZzX2Jsa190cmFjZV9hdHRyX3N0b3JlKHN0
cnVjdCBkZXZpY2UgKmRldiwKIAl9CiAKIAlyZXQgPSAwOwotCWlmIChxLT5ibGtfdHJhY2UgPT0g
TlVMTCkKKwlpZiAoYnQgPT0gTlVMTCkKIAkJcmV0ID0gYmxrX3RyYWNlX3NldHVwX3F1ZXVlKHEs
IGJkZXYpOwogCiAJaWYgKHJldCA9PSAwKSB7CiAJCWlmIChhdHRyID09ICZkZXZfYXR0cl9hY3Rf
bWFzaykKLQkJCXEtPmJsa190cmFjZS0+YWN0X21hc2sgPSB2YWx1ZTsKKwkJCWJ0LT5hY3RfbWFz
ayA9IHZhbHVlOwogCQllbHNlIGlmIChhdHRyID09ICZkZXZfYXR0cl9waWQpCi0JCQlxLT5ibGtf
dHJhY2UtPnBpZCA9IHZhbHVlOworCQkJYnQtPnBpZCA9IHZhbHVlOwogCQllbHNlIGlmIChhdHRy
ID09ICZkZXZfYXR0cl9zdGFydF9sYmEpCi0JCQlxLT5ibGtfdHJhY2UtPnN0YXJ0X2xiYSA9IHZh
bHVlOworCQkJYnQtPnN0YXJ0X2xiYSA9IHZhbHVlOwogCQllbHNlIGlmIChhdHRyID09ICZkZXZf
YXR0cl9lbmRfbGJhKQotCQkJcS0+YmxrX3RyYWNlLT5lbmRfbGJhID0gdmFsdWU7CisJCQlidC0+
ZW5kX2xiYSA9IHZhbHVlOwogCX0KIAogb3V0X3VubG9ja19iZGV2OgoKRnJvbSBkMDg1OTJmMWQw
MTI1MzA4OGFiZjc3N2VjYzRiYmFkZTMzZDEwZmE5IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpG
cm9tOiBDZW5naXogQ2FuIDxjZW5naXpAa2VybmVsLnd0Zj4KRGF0ZTogV2VkLCA0IE1hciAyMDIw
IDEzOjU4OjE5ICswMzAwClN1YmplY3Q6IGJsa3RyYWNlOiBmaXggZGVyZWZlcmVuY2UgYWZ0ZXIg
bnVsbCBjaGVjawoKY29tbWl0IDE1MzAzMWEzMDFiYjA3MTk0ZTljMzc0NjZjZmNlOGVhY2I5Nzc2
MjEgdXBzdHJlYW0uCgpUaGVyZSB3YXMgYSByZWNlbnQgY2hhbmdlIGluIGJsa3RyYWNlLmMgdGhh
dCBhZGRlZCBhIFJDVSBwcm90ZWN0aW9uIHRvCmBxLT5ibGtfdHJhY2VgIGluIG9yZGVyIHRvIGZp
eCBhIHVzZS1hZnRlci1mcmVlIGlzc3VlIGR1cmluZyBhY2Nlc3MuCgpIb3dldmVyIHRoZSBjaGFu
Z2UgbWlzc2VkIGFuIGVkZ2UgY2FzZSB0aGF0IGNhbiBsZWFkIHRvIGRlcmVmZXJlbmNpbmcgb2YK
YGJ0YCBwb2ludGVyIGV2ZW4gd2hlbiBpdCdzIE5VTEw6CgpDb3Zlcml0eSBzdGF0aWMgYW5hbHl6
ZXIgbWFya2VkIHRoaXMgYXMgYSBGT1JXQVJEX05VTEwgaXNzdWUgd2l0aCBDSUQKMTQ2MDQ1OC4K
CmBgYAova2VybmVsL3RyYWNlL2Jsa3RyYWNlLmM6IDE5MDQgaW4gc3lzZnNfYmxrX3RyYWNlX2F0
dHJfc3RvcmUoKQoxODk4ICAgICAgICAgICAgcmV0ID0gMDsKMTg5OSAgICAgICAgICAgIGlmIChi
dCA9PSBOVUxMKQoxOTAwICAgICAgICAgICAgICAgICAgICByZXQgPSBibGtfdHJhY2Vfc2V0dXBf
cXVldWUocSwgYmRldik7CjE5MDEKMTkwMiAgICAgICAgICAgIGlmIChyZXQgPT0gMCkgewoxOTAz
ICAgICAgICAgICAgICAgICAgICBpZiAoYXR0ciA9PSAmZGV2X2F0dHJfYWN0X21hc2spCj4+PiAg
ICAgQ0lEIDE0NjA0NTg6ICBOdWxsIHBvaW50ZXIgZGVyZWZlcmVuY2VzICAoRk9SV0FSRF9OVUxM
KQo+Pj4gICAgIERlcmVmZXJlbmNpbmcgbnVsbCBwb2ludGVyICJidCIuCjE5MDQgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgYnQtPmFjdF9tYXNrID0gdmFsdWU7CjE5MDUgICAgICAgICAgICAg
ICAgICAgIGVsc2UgaWYgKGF0dHIgPT0gJmRldl9hdHRyX3BpZCkKMTkwNiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBidC0+cGlkID0gdmFsdWU7CjE5MDcgICAgICAgICAgICAgICAgICAgIGVs
c2UgaWYgKGF0dHIgPT0gJmRldl9hdHRyX3N0YXJ0X2xiYSkKMTkwOCAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBidC0+c3RhcnRfbGJhID0gdmFsdWU7CjE5MDkgICAgICAgICAgICAgICAgICAg
IGVsc2UgaWYgKGF0dHIgPT0gJmRldl9hdHRyX2VuZF9sYmEpCmBgYAoKQWRkZWQgYSByZWFzc2ln
bm1lbnQgd2l0aCBSQ1UgYW5ub3RhdGlvbiB0byBmaXggdGhlIGlzc3VlLgoKRml4ZXM6IGM3ODBl
ODZkZDQ4ICgiYmxrdHJhY2U6IFByb3RlY3QgcS0+YmxrX3RyYWNlIHdpdGggUkNVIikKUmV2aWV3
ZWQtYnk6IE1pbmcgTGVpIDxtaW5nLmxlaUByZWRoYXQuY29tPgpSZXZpZXdlZC1ieTogQm9iIExp
dSA8Ym9iLmxpdUBvcmFjbGUuY29tPgpSZXZpZXdlZC1ieTogU3RldmVuIFJvc3RlZHQgKFZNd2Fy
ZSkgPHJvc3RlZHRAZ29vZG1pcy5vcmc+ClNpZ25lZC1vZmYtYnk6IENlbmdpeiBDYW4gPGNlbmdp
ekBrZXJuZWwud3RmPgpTaWduZWQtb2ZmLWJ5OiBKZW5zIEF4Ym9lIDxheGJvZUBrZXJuZWwuZGs+
ClNpZ25lZC1vZmYtYnk6IEJlbiBIdXRjaGluZ3MgPGJlbi5odXRjaGluZ3NAY29kZXRoaW5rLmNv
LnVrPgotLS0KIGtlcm5lbC90cmFjZS9ibGt0cmFjZS5jIHwgNSArKysrLQogMSBmaWxlIGNoYW5n
ZWQsIDQgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigtKQoKZGlmZiAtLWdpdCBhL2tlcm5lbC90
cmFjZS9ibGt0cmFjZS5jIGIva2VybmVsL3RyYWNlL2Jsa3RyYWNlLmMKaW5kZXggNzhhODk2YWNk
MjFhLi42ZDNiNDMyYTc0OGEgMTAwNjQ0Ci0tLSBhL2tlcm5lbC90cmFjZS9ibGt0cmFjZS5jCisr
KyBiL2tlcm5lbC90cmFjZS9ibGt0cmFjZS5jCkBAIC0xODI2LDggKzE4MjYsMTEgQEAgc3RhdGlj
IHNzaXplX3Qgc3lzZnNfYmxrX3RyYWNlX2F0dHJfc3RvcmUoc3RydWN0IGRldmljZSAqZGV2LAog
CX0KIAogCXJldCA9IDA7Ci0JaWYgKGJ0ID09IE5VTEwpCisJaWYgKGJ0ID09IE5VTEwpIHsKIAkJ
cmV0ID0gYmxrX3RyYWNlX3NldHVwX3F1ZXVlKHEsIGJkZXYpOworCQlidCA9IHJjdV9kZXJlZmVy
ZW5jZV9wcm90ZWN0ZWQocS0+YmxrX3RyYWNlLAorCQkJCWxvY2tkZXBfaXNfaGVsZCgmcS0+Ymxr
X3RyYWNlX211dGV4KSk7CisJfQogCiAJaWYgKHJldCA9PSAwKSB7CiAJCWlmIChhdHRyID09ICZk
ZXZfYXR0cl9hY3RfbWFzaykKCkZyb20gNWUxZjdhZjM4OTc4ZDY2OWRiODE4ZWUxODcxY2Q3ZDM0
MGE3YjY1ZSBNb24gU2VwIDE3IDAwOjAwOjAwIDIwMDEKRnJvbTogRG1pdHJ5IFRvcm9raG92IDxk
bWl0cnkudG9yb2tob3ZAZ21haWwuY29tPgpEYXRlOiBUdWUsIDE0IEZlYiAyMDE3IDEwOjIzOjMx
IC0wODAwClN1YmplY3Q6IHB0cDogZG8gbm90IGV4cGxpY2l0bHkgc2V0IGRydmRhdGEgaW4gcHRw
X2Nsb2NrX3JlZ2lzdGVyKCkKCmNvbW1pdCA4ODJmMzEyZGMwNzUxYzk3M2RiMjY0NzhmMDdmMDgy
YzU4NGQxNmFhIHVwc3RyZWFtLgoKV2UgZG8gbm90IG5lZWQgZXhwbGljaXRseSBjYWxsIGRldl9z
ZXRfZHJ2ZGF0YSgpLCBhcyBpdCBpcyBkb25lIGZvciB1cyBieQpkZXZpY2VfY3JlYXRlKCkuCgpB
Y2tlZC1ieTogUmljaGFyZCBDb2NocmFuIDxyaWNoYXJkY29jaHJhbkBnbWFpbC5jb20+ClNpZ25l
ZC1vZmYtYnk6IERtaXRyeSBUb3Jva2hvdiA8ZG1pdHJ5LnRvcm9raG92QGdtYWlsLmNvbT4KU2ln
bmVkLW9mZi1ieTogRGF2aWQgUy4gTWlsbGVyIDxkYXZlbUBkYXZlbWxvZnQubmV0PgpTaWduZWQt
b2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxiZW4uaHV0Y2hpbmdzQGNvZGV0aGluay5jby51az4KLS0t
CiBkcml2ZXJzL3B0cC9wdHBfY2xvY2suYyB8IDIgLS0KIDEgZmlsZSBjaGFuZ2VkLCAyIGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvcHRwL3B0cF9jbG9jay5jIGIvZHJpdmVycy9w
dHAvcHRwX2Nsb2NrLmMKaW5kZXggMmFhNWIzN2NjNmQyLi4wOGYzMDRiODNhZDEgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvcHRwL3B0cF9jbG9jay5jCisrKyBiL2RyaXZlcnMvcHRwL3B0cF9jbG9jay5j
CkBAIC0yMjAsOCArMjIwLDYgQEAgc3RydWN0IHB0cF9jbG9jayAqcHRwX2Nsb2NrX3JlZ2lzdGVy
KHN0cnVjdCBwdHBfY2xvY2tfaW5mbyAqaW5mbywKIAlpZiAoSVNfRVJSKHB0cC0+ZGV2KSkKIAkJ
Z290byBub19kZXZpY2U7CiAKLQlkZXZfc2V0X2RydmRhdGEocHRwLT5kZXYsIHB0cCk7Ci0KIAll
cnIgPSBwdHBfcG9wdWxhdGVfc3lzZnMocHRwKTsKIAlpZiAoZXJyKQogCQlnb3RvIG5vX3N5c2Zz
OwoKRnJvbSAxNDI2MjMyNjI3YWVjMWNmYmNmMGIzN2Q2ODg4NmUwYjY5ZjAyMmVjIE1vbiBTZXAg
MTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBEbWl0cnkgVG9yb2tob3YgPGRtaXRyeS50b3Jva2hvdkBn
bWFpbC5jb20+CkRhdGU6IFR1ZSwgMTQgRmViIDIwMTcgMTA6MjM6MzMgLTA4MDAKU3ViamVjdDog
cHRwOiB1c2UgaXNfdmlzaWJsZSBtZXRob2QgdG8gaGlkZSB1bnVzZWQgYXR0cmlidXRlcwoKY29t
bWl0IGFmNTllNzE3ZDVmZjljOGRiZjliY2M1ODFjMGRmYjNiMmE5YzkwMzAgdXBzdHJlYW0uCgpJ
bnN0ZWFkIG9mIGNyZWF0aW5nIHNlbGVjdGVkIGF0dHJpYnV0ZXMgYWZ0ZXIgdGhlIGRldmljZSBp
cyBjcmVhdGVkIChhbmQKYWZ0ZXIgdXNlcnNwYWNlIHBvdGVudGlhbGx5IHNlZW4gdWV2ZW50KSwg
bGV0cyB1c2UgYXR0cmlidXRlIGdyb3VwCmlzX3Zpc2libGUoKSBtZXRob2QgdG8gY29udHJvbCB3
aGljaCBhdHRyaWJ1dGVzIGFyZSBzaG93bi4gVGhpcyB3aWxsIGFsbG93CnVzIHRvIGNyZWF0ZSBh
bGwgYXR0cmlidXRlcyAoZXhjZXB0ICJwaW5zIiBncm91cCwgd2hpY2ggd2lsbCBiZSB0YWtlbiBj
YXJlCm9mIGxhdGVyKSBiZWZvcmUgdXNlcnNwYWNlIGdldHMgbm90aWZpZWQgYWJvdXQgbmV3IHB0
cCBjbGFzcyBkZXZpY2UuCgpTaWduZWQtb2ZmLWJ5OiBEbWl0cnkgVG9yb2tob3YgPGRtaXRyeS50
b3Jva2hvdkBnbWFpbC5jb20+ClNpZ25lZC1vZmYtYnk6IERhdmlkIFMuIE1pbGxlciA8ZGF2ZW1A
ZGF2ZW1sb2Z0Lm5ldD4KU2lnbmVkLW9mZi1ieTogQmVuIEh1dGNoaW5ncyA8YmVuLmh1dGNoaW5n
c0Bjb2RldGhpbmsuY28udWs+Ci0tLQogZHJpdmVycy9wdHAvcHRwX3N5c2ZzLmMgfCAxMjUgKysr
KysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDU1
IGluc2VydGlvbnMoKyksIDcwIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvcHRw
L3B0cF9zeXNmcy5jIGIvZHJpdmVycy9wdHAvcHRwX3N5c2ZzLmMKaW5kZXggMzAyZTYyNmZlNmIw
Li5hNTVhNmViNGRmZGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvcHRwL3B0cF9zeXNmcy5jCisrKyBi
L2RyaXZlcnMvcHRwL3B0cF9zeXNmcy5jCkBAIC00NiwyNyArNDYsNiBAQCBQVFBfU0hPV19JTlQo
bl9wZXJpb2RpY19vdXRwdXRzLCBuX3Blcl9vdXQpOwogUFRQX1NIT1dfSU5UKG5fcHJvZ3JhbW1h
YmxlX3BpbnMsIG5fcGlucyk7CiBQVFBfU0hPV19JTlQocHBzX2F2YWlsYWJsZSwgcHBzKTsKIAot
c3RhdGljIHN0cnVjdCBhdHRyaWJ1dGUgKnB0cF9hdHRyc1tdID0gewotCSZkZXZfYXR0cl9jbG9j
a19uYW1lLmF0dHIsCi0JJmRldl9hdHRyX21heF9hZGp1c3RtZW50LmF0dHIsCi0JJmRldl9hdHRy
X25fYWxhcm1zLmF0dHIsCi0JJmRldl9hdHRyX25fZXh0ZXJuYWxfdGltZXN0YW1wcy5hdHRyLAot
CSZkZXZfYXR0cl9uX3BlcmlvZGljX291dHB1dHMuYXR0ciwKLQkmZGV2X2F0dHJfbl9wcm9ncmFt
bWFibGVfcGlucy5hdHRyLAotCSZkZXZfYXR0cl9wcHNfYXZhaWxhYmxlLmF0dHIsCi0JTlVMTCwK
LX07Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwIHB0cF9ncm91cCA9IHsK
LQkuYXR0cnMgPSBwdHBfYXR0cnMsCi19OwotCi1jb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3Vw
ICpwdHBfZ3JvdXBzW10gPSB7Ci0JJnB0cF9ncm91cCwKLQlOVUxMLAotfTsKLQotCiBzdGF0aWMg
c3NpemVfdCBleHR0c19lbmFibGVfc3RvcmUoc3RydWN0IGRldmljZSAqZGV2LAogCQkJCSAgc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCiAJCQkJICBjb25zdCBjaGFyICpidWYsIHNpemVf
dCBjb3VudCkKQEAgLTkxLDYgKzcwLDcgQEAgc3RhdGljIHNzaXplX3QgZXh0dHNfZW5hYmxlX3N0
b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKIG91dDoKIAlyZXR1cm4gZXJyOwogfQorc3RhdGljIERF
VklDRV9BVFRSKGV4dHRzX2VuYWJsZSwgMDIyMCwgTlVMTCwgZXh0dHNfZW5hYmxlX3N0b3JlKTsK
IAogc3RhdGljIHNzaXplX3QgZXh0dHNfZmlmb19zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKIAkJ
CSAgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqcGFnZSkKQEAgLTEy
NCw2ICsxMDQsNyBAQCBzdGF0aWMgc3NpemVfdCBleHR0c19maWZvX3Nob3coc3RydWN0IGRldmlj
ZSAqZGV2LAogCW11dGV4X3VubG9jaygmcHRwLT50c2V2cV9tdXgpOwogCXJldHVybiBjbnQ7CiB9
CitzdGF0aWMgREVWSUNFX0FUVFIoZmlmbywgMDQ0NCwgZXh0dHNfZmlmb19zaG93LCBOVUxMKTsK
IAogc3RhdGljIHNzaXplX3QgcGVyaW9kX3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKIAkJCSAg
ICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKQEAgLTE1MSw2ICsxMzIsNyBAQCBzdGF0
aWMgc3NpemVfdCBwZXJpb2Rfc3RvcmUoc3RydWN0IGRldmljZSAqZGV2LAogb3V0OgogCXJldHVy
biBlcnI7CiB9CitzdGF0aWMgREVWSUNFX0FUVFIocGVyaW9kLCAwMjIwLCBOVUxMLCBwZXJpb2Rf
c3RvcmUpOwogCiBzdGF0aWMgc3NpemVfdCBwcHNfZW5hYmxlX3N0b3JlKHN0cnVjdCBkZXZpY2Ug
KmRldiwKIAkJCQlzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKQEAgLTE3Nyw2ICsxNTks
NTcgQEAgc3RhdGljIHNzaXplX3QgcHBzX2VuYWJsZV9zdG9yZShzdHJ1Y3QgZGV2aWNlICpkZXYs
CiBvdXQ6CiAJcmV0dXJuIGVycjsKIH0KK3N0YXRpYyBERVZJQ0VfQVRUUihwcHNfZW5hYmxlLCAw
MjIwLCBOVUxMLCBwcHNfZW5hYmxlX3N0b3JlKTsKKworc3RhdGljIHN0cnVjdCBhdHRyaWJ1dGUg
KnB0cF9hdHRyc1tdID0geworCSZkZXZfYXR0cl9jbG9ja19uYW1lLmF0dHIsCisKKwkmZGV2X2F0
dHJfbWF4X2FkanVzdG1lbnQuYXR0ciwKKwkmZGV2X2F0dHJfbl9hbGFybXMuYXR0ciwKKwkmZGV2
X2F0dHJfbl9leHRlcm5hbF90aW1lc3RhbXBzLmF0dHIsCisJJmRldl9hdHRyX25fcGVyaW9kaWNf
b3V0cHV0cy5hdHRyLAorCSZkZXZfYXR0cl9uX3Byb2dyYW1tYWJsZV9waW5zLmF0dHIsCisJJmRl
dl9hdHRyX3Bwc19hdmFpbGFibGUuYXR0ciwKKworCSZkZXZfYXR0cl9leHR0c19lbmFibGUuYXR0
ciwKKwkmZGV2X2F0dHJfZmlmby5hdHRyLAorCSZkZXZfYXR0cl9wZXJpb2QuYXR0ciwKKwkmZGV2
X2F0dHJfcHBzX2VuYWJsZS5hdHRyLAorCU5VTEwKK307CisKK3N0YXRpYyB1bW9kZV90IHB0cF9p
c19hdHRyaWJ1dGVfdmlzaWJsZShzdHJ1Y3Qga29iamVjdCAqa29iaiwKKwkJCQkJc3RydWN0IGF0
dHJpYnV0ZSAqYXR0ciwgaW50IG4pCit7CisJc3RydWN0IGRldmljZSAqZGV2ID0ga29ial90b19k
ZXYoa29iaik7CisJc3RydWN0IHB0cF9jbG9jayAqcHRwID0gZGV2X2dldF9kcnZkYXRhKGRldik7
CisJc3RydWN0IHB0cF9jbG9ja19pbmZvICppbmZvID0gcHRwLT5pbmZvOworCXVtb2RlX3QgbW9k
ZSA9IGF0dHItPm1vZGU7CisKKwlpZiAoYXR0ciA9PSAmZGV2X2F0dHJfZXh0dHNfZW5hYmxlLmF0
dHIgfHwKKwkgICAgYXR0ciA9PSAmZGV2X2F0dHJfZmlmby5hdHRyKSB7CisJCWlmICghaW5mby0+
bl9leHRfdHMpCisJCQltb2RlID0gMDsKKwl9IGVsc2UgaWYgKGF0dHIgPT0gJmRldl9hdHRyX3Bl
cmlvZC5hdHRyKSB7CisJCWlmICghaW5mby0+bl9wZXJfb3V0KQorCQkJbW9kZSA9IDA7CisJfSBl
bHNlIGlmIChhdHRyID09ICZkZXZfYXR0cl9wcHNfZW5hYmxlLmF0dHIpIHsKKwkJaWYgKCFpbmZv
LT5wcHMpCisJCQltb2RlID0gMDsKKwl9CisKKwlyZXR1cm4gbW9kZTsKK30KKworc3RhdGljIGNv
bnN0IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgcHRwX2dyb3VwID0geworCS5pc192aXNpYmxlCT0g
cHRwX2lzX2F0dHJpYnV0ZV92aXNpYmxlLAorCS5hdHRycwkJPSBwdHBfYXR0cnMsCit9OworCitj
b25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwICpwdHBfZ3JvdXBzW10gPSB7CisJJnB0cF9ncm91
cCwKKwlOVUxMCit9OwogCiBzdGF0aWMgaW50IHB0cF9waW5fbmFtZTJpbmRleChzdHJ1Y3QgcHRw
X2Nsb2NrICpwdHAsIGNvbnN0IGNoYXIgKm5hbWUpCiB7CkBAIC0yMzUsMjYgKzI2OCwxMSBAQCBz
dGF0aWMgc3NpemVfdCBwdHBfcGluX3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRl
dmljZV9hdHRyaWJ1dGUgKmF0dHIsCiAJcmV0dXJuIGNvdW50OwogfQogCi1zdGF0aWMgREVWSUNF
X0FUVFIoZXh0dHNfZW5hYmxlLCAwMjIwLCBOVUxMLCBleHR0c19lbmFibGVfc3RvcmUpOwotc3Rh
dGljIERFVklDRV9BVFRSKGZpZm8sICAgICAgICAgMDQ0NCwgZXh0dHNfZmlmb19zaG93LCBOVUxM
KTsKLXN0YXRpYyBERVZJQ0VfQVRUUihwZXJpb2QsICAgICAgIDAyMjAsIE5VTEwsIHBlcmlvZF9z
dG9yZSk7Ci1zdGF0aWMgREVWSUNFX0FUVFIocHBzX2VuYWJsZSwgICAwMjIwLCBOVUxMLCBwcHNf
ZW5hYmxlX3N0b3JlKTsKLQogaW50IHB0cF9jbGVhbnVwX3N5c2ZzKHN0cnVjdCBwdHBfY2xvY2sg
KnB0cCkKIHsKIAlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBwdHAtPmRldjsKIAlzdHJ1Y3QgcHRwX2Ns
b2NrX2luZm8gKmluZm8gPSBwdHAtPmluZm87CiAKLQlpZiAoaW5mby0+bl9leHRfdHMpIHsKLQkJ
ZGV2aWNlX3JlbW92ZV9maWxlKGRldiwgJmRldl9hdHRyX2V4dHRzX2VuYWJsZSk7Ci0JCWRldmlj
ZV9yZW1vdmVfZmlsZShkZXYsICZkZXZfYXR0cl9maWZvKTsKLQl9Ci0JaWYgKGluZm8tPm5fcGVy
X291dCkKLQkJZGV2aWNlX3JlbW92ZV9maWxlKGRldiwgJmRldl9hdHRyX3BlcmlvZCk7Ci0KLQlp
ZiAoaW5mby0+cHBzKQotCQlkZXZpY2VfcmVtb3ZlX2ZpbGUoZGV2LCAmZGV2X2F0dHJfcHBzX2Vu
YWJsZSk7Ci0KIAlpZiAoaW5mby0+bl9waW5zKSB7CiAJCXN5c2ZzX3JlbW92ZV9ncm91cCgmZGV2
LT5rb2JqLCAmcHRwLT5waW5fYXR0cl9ncm91cCk7CiAJCWtmcmVlKHB0cC0+cGluX2F0dHIpOwpA
QCAtMzA3LDQ2ICszMjUsMTMgQEAgc3RhdGljIGludCBwdHBfcG9wdWxhdGVfcGlucyhzdHJ1Y3Qg
cHRwX2Nsb2NrICpwdHApCiAKIGludCBwdHBfcG9wdWxhdGVfc3lzZnMoc3RydWN0IHB0cF9jbG9j
ayAqcHRwKQogewotCXN0cnVjdCBkZXZpY2UgKmRldiA9IHB0cC0+ZGV2OwogCXN0cnVjdCBwdHBf
Y2xvY2tfaW5mbyAqaW5mbyA9IHB0cC0+aW5mbzsKIAlpbnQgZXJyOwogCi0JaWYgKGluZm8tPm5f
ZXh0X3RzKSB7Ci0JCWVyciA9IGRldmljZV9jcmVhdGVfZmlsZShkZXYsICZkZXZfYXR0cl9leHR0
c19lbmFibGUpOwotCQlpZiAoZXJyKQotCQkJZ290byBvdXQxOwotCQllcnIgPSBkZXZpY2VfY3Jl
YXRlX2ZpbGUoZGV2LCAmZGV2X2F0dHJfZmlmbyk7Ci0JCWlmIChlcnIpCi0JCQlnb3RvIG91dDI7
Ci0JfQotCWlmIChpbmZvLT5uX3Blcl9vdXQpIHsKLQkJZXJyID0gZGV2aWNlX2NyZWF0ZV9maWxl
KGRldiwgJmRldl9hdHRyX3BlcmlvZCk7Ci0JCWlmIChlcnIpCi0JCQlnb3RvIG91dDM7Ci0JfQot
CWlmIChpbmZvLT5wcHMpIHsKLQkJZXJyID0gZGV2aWNlX2NyZWF0ZV9maWxlKGRldiwgJmRldl9h
dHRyX3Bwc19lbmFibGUpOwotCQlpZiAoZXJyKQotCQkJZ290byBvdXQ0OwotCX0KIAlpZiAoaW5m
by0+bl9waW5zKSB7CiAJCWVyciA9IHB0cF9wb3B1bGF0ZV9waW5zKHB0cCk7CiAJCWlmIChlcnIp
Ci0JCQlnb3RvIG91dDU7CisJCQlyZXR1cm4gZXJyOwogCX0KIAlyZXR1cm4gMDsKLW91dDU6Ci0J
aWYgKGluZm8tPnBwcykKLQkJZGV2aWNlX3JlbW92ZV9maWxlKGRldiwgJmRldl9hdHRyX3Bwc19l
bmFibGUpOwotb3V0NDoKLQlpZiAoaW5mby0+bl9wZXJfb3V0KQotCQlkZXZpY2VfcmVtb3ZlX2Zp
bGUoZGV2LCAmZGV2X2F0dHJfcGVyaW9kKTsKLW91dDM6Ci0JaWYgKGluZm8tPm5fZXh0X3RzKQot
CQlkZXZpY2VfcmVtb3ZlX2ZpbGUoZGV2LCAmZGV2X2F0dHJfZmlmbyk7Ci1vdXQyOgotCWlmIChp
bmZvLT5uX2V4dF90cykKLQkJZGV2aWNlX3JlbW92ZV9maWxlKGRldiwgJmRldl9hdHRyX2V4dHRz
X2VuYWJsZSk7Ci1vdXQxOgotCXJldHVybiBlcnI7CiB9CgpGcm9tIDEyZjg3ZWM3N2JmOGI0Yjc4
ODg3YWM0Mzc5ZjNjNDgwYTE3ZDI4M2UgTW9uIFNlcCAxNyAwMDowMDowMCAyMDAxCkZyb206IERt
aXRyeSBUb3Jva2hvdiA8ZG1pdHJ5LnRvcm9raG92QGdtYWlsLmNvbT4KRGF0ZTogVHVlLCAxNCBG
ZWIgMjAxNyAxMDoyMzozNCAtMDgwMApTdWJqZWN0OiBwdHA6IGNyZWF0ZSAicGlucyIgdG9nZXRo
ZXIgd2l0aCB0aGUgcmVzdCBvZiBhdHRyaWJ1dGVzCgpjb21taXQgODVhNjZlNTUwMTk1ODNkYTFl
MGYxODcwNmI3YTgyODFjOWY2ZGU1YiB1cHN0cmVhbS4KCkxldCdzIHN3aXRjaCB0byB1c2luZyBk
ZXZpY2VfY3JlYXRlX3dpdGhfZ3JvdXBzKCksIHdoaWNoIHdpbGwgYWxsb3cgdXMgdG8KY3JlYXRl
ICJwaW5zIiBhdHRyaWJ1dGUgZ3JvdXAgdG9nZXRoZXIgd2l0aCB0aGUgcmVzdCBvZiBwdHAgZGV2
aWNlCmF0dHJpYnV0ZXMsIGFuZCBiZWZvcmUgdXNlcnNwYWNlIGdldHMgbm90aWZpZWQgYWJvdXQg
cHRwIGRldmljZSBjcmVhdGlvbi4KClNpZ25lZC1vZmYtYnk6IERtaXRyeSBUb3Jva2hvdiA8ZG1p
dHJ5LnRvcm9raG92QGdtYWlsLmNvbT4KU2lnbmVkLW9mZi1ieTogRGF2aWQgUy4gTWlsbGVyIDxk
YXZlbUBkYXZlbWxvZnQubmV0PgpbYndoOiBCYWNrcG9ydGVkIHRvIDQuOTogYWRqdXN0IGNvbnRl
eHRdClNpZ25lZC1vZmYtYnk6IEJlbiBIdXRjaGluZ3MgPGJlbi5odXRjaGluZ3NAY29kZXRoaW5r
LmNvLnVrPgotLS0KIGRyaXZlcnMvcHRwL3B0cF9jbG9jay5jICAgfCAyMCArKysrKysrKysrKy0t
LS0tLS0tLQogZHJpdmVycy9wdHAvcHRwX3ByaXZhdGUuaCB8ICA3ICsrKystLS0KIGRyaXZlcnMv
cHRwL3B0cF9zeXNmcy5jICAgfCAzOSArKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0KIDMgZmlsZXMgY2hhbmdlZCwgMjQgaW5zZXJ0aW9ucygrKSwgNDIgZGVsZXRpb25zKC0p
CgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9wdHAvcHRwX2Nsb2NrLmMgYi9kcml2ZXJzL3B0cC9wdHBf
Y2xvY2suYwppbmRleCAwOGYzMDRiODNhZDEuLmQ1YWMzMzM1MDg4OSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9wdHAvcHRwX2Nsb2NrLmMKKysrIGIvZHJpdmVycy9wdHAvcHRwX2Nsb2NrLmMKQEAgLTIx
NCwxNiArMjE0LDE3IEBAIHN0cnVjdCBwdHBfY2xvY2sgKnB0cF9jbG9ja19yZWdpc3RlcihzdHJ1
Y3QgcHRwX2Nsb2NrX2luZm8gKmluZm8sCiAJbXV0ZXhfaW5pdCgmcHRwLT5waW5jZmdfbXV4KTsK
IAlpbml0X3dhaXRxdWV1ZV9oZWFkKCZwdHAtPnRzZXZfd3EpOwogCisJZXJyID0gcHRwX3BvcHVs
YXRlX3Bpbl9ncm91cHMocHRwKTsKKwlpZiAoZXJyKQorCQlnb3RvIG5vX3Bpbl9ncm91cHM7CisK
IAkvKiBDcmVhdGUgYSBuZXcgZGV2aWNlIGluIG91ciBjbGFzcy4gKi8KLQlwdHAtPmRldiA9IGRl
dmljZV9jcmVhdGUocHRwX2NsYXNzLCBwYXJlbnQsIHB0cC0+ZGV2aWQsIHB0cCwKLQkJCQkgInB0
cCVkIiwgcHRwLT5pbmRleCk7CisJcHRwLT5kZXYgPSBkZXZpY2VfY3JlYXRlX3dpdGhfZ3JvdXBz
KHB0cF9jbGFzcywgcGFyZW50LCBwdHAtPmRldmlkLAorCQkJCQkgICAgIHB0cCwgcHRwLT5waW5f
YXR0cl9ncm91cHMsCisJCQkJCSAgICAgInB0cCVkIiwgcHRwLT5pbmRleCk7CiAJaWYgKElTX0VS
UihwdHAtPmRldikpCiAJCWdvdG8gbm9fZGV2aWNlOwogCi0JZXJyID0gcHRwX3BvcHVsYXRlX3N5
c2ZzKHB0cCk7Ci0JaWYgKGVycikKLQkJZ290byBub19zeXNmczsKLQogCS8qIFJlZ2lzdGVyIGEg
bmV3IFBQUyBzb3VyY2UuICovCiAJaWYgKGluZm8tPnBwcykgewogCQlzdHJ1Y3QgcHBzX3NvdXJj
ZV9pbmZvIHBwczsKQEAgLTI1MSwxMCArMjUyLDEwIEBAIHN0cnVjdCBwdHBfY2xvY2sgKnB0cF9j
bG9ja19yZWdpc3RlcihzdHJ1Y3QgcHRwX2Nsb2NrX2luZm8gKmluZm8sCiAJaWYgKHB0cC0+cHBz
X3NvdXJjZSkKIAkJcHBzX3VucmVnaXN0ZXJfc291cmNlKHB0cC0+cHBzX3NvdXJjZSk7CiBub19w
cHM6Ci0JcHRwX2NsZWFudXBfc3lzZnMocHRwKTsKLW5vX3N5c2ZzOgogCWRldmljZV9kZXN0cm95
KHB0cF9jbGFzcywgcHRwLT5kZXZpZCk7CiBub19kZXZpY2U6CisJcHRwX2NsZWFudXBfcGluX2dy
b3VwcyhwdHApOworbm9fcGluX2dyb3VwczoKIAltdXRleF9kZXN0cm95KCZwdHAtPnRzZXZxX211
eCk7CiAJbXV0ZXhfZGVzdHJveSgmcHRwLT5waW5jZmdfbXV4KTsKIAlpZGFfc2ltcGxlX3JlbW92
ZSgmcHRwX2Nsb2Nrc19tYXAsIGluZGV4KTsKQEAgLTI3Myw4ICsyNzQsOSBAQCBpbnQgcHRwX2Ns
b2NrX3VucmVnaXN0ZXIoc3RydWN0IHB0cF9jbG9jayAqcHRwKQogCS8qIFJlbGVhc2UgdGhlIGNs
b2NrJ3MgcmVzb3VyY2VzLiAqLwogCWlmIChwdHAtPnBwc19zb3VyY2UpCiAJCXBwc191bnJlZ2lz
dGVyX3NvdXJjZShwdHAtPnBwc19zb3VyY2UpOwotCXB0cF9jbGVhbnVwX3N5c2ZzKHB0cCk7CisK
IAlkZXZpY2VfZGVzdHJveShwdHBfY2xhc3MsIHB0cC0+ZGV2aWQpOworCXB0cF9jbGVhbnVwX3Bp
bl9ncm91cHMocHRwKTsKIAogCXBvc2l4X2Nsb2NrX3VucmVnaXN0ZXIoJnB0cC0+Y2xvY2spOwog
CXJldHVybiAwOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9wdHAvcHRwX3ByaXZhdGUuaCBiL2RyaXZl
cnMvcHRwL3B0cF9wcml2YXRlLmgKaW5kZXggOWM1ZDQxNDIxYjY1Li5kOTU4ODg5NzRkMGMgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvcHRwL3B0cF9wcml2YXRlLmgKKysrIGIvZHJpdmVycy9wdHAvcHRw
X3ByaXZhdGUuaApAQCAtNTQsNiArNTQsOCBAQCBzdHJ1Y3QgcHRwX2Nsb2NrIHsKIAlzdHJ1Y3Qg
ZGV2aWNlX2F0dHJpYnV0ZSAqcGluX2Rldl9hdHRyOwogCXN0cnVjdCBhdHRyaWJ1dGUgKipwaW5f
YXR0cjsKIAlzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwIHBpbl9hdHRyX2dyb3VwOworCS8qIDFzdCBl
bnRyeSBpcyBhIHBvaW50ZXIgdG8gdGhlIHJlYWwgZ3JvdXAsIDJuZCBpcyBOVUxMIHRlcm1pbmF0
b3IgKi8KKwljb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwICpwaW5fYXR0cl9ncm91cHNbMl07
CiB9OwogCiAvKgpAQCAtOTQsOCArOTYsNyBAQCB1aW50IHB0cF9wb2xsKHN0cnVjdCBwb3NpeF9j
bG9jayAqcGMsCiAKIGV4dGVybiBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwICpwdHBfZ3Jv
dXBzW107CiAKLWludCBwdHBfY2xlYW51cF9zeXNmcyhzdHJ1Y3QgcHRwX2Nsb2NrICpwdHApOwot
Ci1pbnQgcHRwX3BvcHVsYXRlX3N5c2ZzKHN0cnVjdCBwdHBfY2xvY2sgKnB0cCk7CitpbnQgcHRw
X3BvcHVsYXRlX3Bpbl9ncm91cHMoc3RydWN0IHB0cF9jbG9jayAqcHRwKTsKK3ZvaWQgcHRwX2Ns
ZWFudXBfcGluX2dyb3VwcyhzdHJ1Y3QgcHRwX2Nsb2NrICpwdHApOwogCiAjZW5kaWYKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvcHRwL3B0cF9zeXNmcy5jIGIvZHJpdmVycy9wdHAvcHRwX3N5c2ZzLmMK
aW5kZXggYTU1YTZlYjRkZmRlLi43MzFkMDQyM2M4YWEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvcHRw
L3B0cF9zeXNmcy5jCisrKyBiL2RyaXZlcnMvcHRwL3B0cF9zeXNmcy5jCkBAIC0yNjgsMjUgKzI2
OCwxNCBAQCBzdGF0aWMgc3NpemVfdCBwdHBfcGluX3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwg
c3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCiAJcmV0dXJuIGNvdW50OwogfQogCi1pbnQg
cHRwX2NsZWFudXBfc3lzZnMoc3RydWN0IHB0cF9jbG9jayAqcHRwKQoraW50IHB0cF9wb3B1bGF0
ZV9waW5fZ3JvdXBzKHN0cnVjdCBwdHBfY2xvY2sgKnB0cCkKIHsKLQlzdHJ1Y3QgZGV2aWNlICpk
ZXYgPSBwdHAtPmRldjsKLQlzdHJ1Y3QgcHRwX2Nsb2NrX2luZm8gKmluZm8gPSBwdHAtPmluZm87
Ci0KLQlpZiAoaW5mby0+bl9waW5zKSB7Ci0JCXN5c2ZzX3JlbW92ZV9ncm91cCgmZGV2LT5rb2Jq
LCAmcHRwLT5waW5fYXR0cl9ncm91cCk7Ci0JCWtmcmVlKHB0cC0+cGluX2F0dHIpOwotCQlrZnJl
ZShwdHAtPnBpbl9kZXZfYXR0cik7Ci0JfQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50IHB0
cF9wb3B1bGF0ZV9waW5zKHN0cnVjdCBwdHBfY2xvY2sgKnB0cCkKLXsKLQlzdHJ1Y3QgZGV2aWNl
ICpkZXYgPSBwdHAtPmRldjsKIAlzdHJ1Y3QgcHRwX2Nsb2NrX2luZm8gKmluZm8gPSBwdHAtPmlu
Zm87CiAJaW50IGVyciA9IC1FTk9NRU0sIGksIG5fcGlucyA9IGluZm8tPm5fcGluczsKIAorCWlm
ICghbl9waW5zKQorCQlyZXR1cm4gMDsKKwogCXB0cC0+cGluX2Rldl9hdHRyID0ga3phbGxvYyhu
X3BpbnMgKiBzaXplb2YoKnB0cC0+cGluX2Rldl9hdHRyKSwKIAkJCQkgICAgR0ZQX0tFUk5FTCk7
CiAJaWYgKCFwdHAtPnBpbl9kZXZfYXR0cikKQEAgLTMxMCwyOCArMjk5LDE4IEBAIHN0YXRpYyBp
bnQgcHRwX3BvcHVsYXRlX3BpbnMoc3RydWN0IHB0cF9jbG9jayAqcHRwKQogCXB0cC0+cGluX2F0
dHJfZ3JvdXAubmFtZSA9ICJwaW5zIjsKIAlwdHAtPnBpbl9hdHRyX2dyb3VwLmF0dHJzID0gcHRw
LT5waW5fYXR0cjsKIAotCWVyciA9IHN5c2ZzX2NyZWF0ZV9ncm91cCgmZGV2LT5rb2JqLCAmcHRw
LT5waW5fYXR0cl9ncm91cCk7Ci0JaWYgKGVycikKLQkJZ290byBub19ncm91cDsKKwlwdHAtPnBp
bl9hdHRyX2dyb3Vwc1swXSA9ICZwdHAtPnBpbl9hdHRyX2dyb3VwOworCiAJcmV0dXJuIDA7CiAK
LW5vX2dyb3VwOgotCWtmcmVlKHB0cC0+cGluX2F0dHIpOwogbm9fcGluX2F0dHI6CiAJa2ZyZWUo
cHRwLT5waW5fZGV2X2F0dHIpOwogbm9fZGV2X2F0dHI6CiAJcmV0dXJuIGVycjsKIH0KIAotaW50
IHB0cF9wb3B1bGF0ZV9zeXNmcyhzdHJ1Y3QgcHRwX2Nsb2NrICpwdHApCit2b2lkIHB0cF9jbGVh
bnVwX3Bpbl9ncm91cHMoc3RydWN0IHB0cF9jbG9jayAqcHRwKQogewotCXN0cnVjdCBwdHBfY2xv
Y2tfaW5mbyAqaW5mbyA9IHB0cC0+aW5mbzsKLQlpbnQgZXJyOwotCi0JaWYgKGluZm8tPm5fcGlu
cykgewotCQllcnIgPSBwdHBfcG9wdWxhdGVfcGlucyhwdHApOwotCQlpZiAoZXJyKQotCQkJcmV0
dXJuIGVycjsKLQl9Ci0JcmV0dXJuIDA7CisJa2ZyZWUocHRwLT5waW5fYXR0cik7CisJa2ZyZWUo
cHRwLT5waW5fZGV2X2F0dHIpOwogfQoKRnJvbSAzNjMyZThkNzlkMjUwN2UxZjM3NjQ4N2UzZjhi
ZjJlNTczZTEzZTkyIE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBMb2dhbiBHdW50aG9y
cGUgPGxvZ2FuZ0BkZWx0YXRlZS5jb20+CkRhdGU6IEZyaSwgMTcgTWFyIDIwMTcgMTI6NDg6MDgg
LTA2MDAKU3ViamVjdDogY2hhcmRldjogYWRkIGhlbHBlciBmdW5jdGlvbiB0byByZWdpc3RlciBj
aGFyIGRldnMgd2l0aCBhIHN0cnVjdAogZGV2aWNlCgpjb21taXQgMjMzZWQwOWQ3ZmRhY2Y1OTJl
ZTkxZTZjOTdjZTVmNDM2NGZiZTdjMCB1cHN0cmVhbS4KCkNyZWRpdCBmb3IgdGhpcyBwYXRjaCBn
b2VzIGlzIHNoYXJlZCB3aXRoIERhbiBXaWxsaWFtcyBbMV0uIEkndmUKdGFrZW4gdGhpbmdzIG9u
ZSBzdGVwIGZ1cnRoZXIgdG8gbWFrZSB0aGUgaGVscGVyIGZ1bmN0aW9uIG1vcmUKdXNlZnVsIGFu
ZCBjbGVhbiB1cCBjYWxsaW5nIGNvZGUuCgpUaGVyZSdzIGEgY29tbW9uIHBhdHRlcm4gaW4gdGhl
IGtlcm5lbCB3aGVyZWJ5IGEgc3RydWN0IGNkZXYgaXMgcGxhY2VkCmluIGEgc3RydWN0dXJlIGFs
b25nIHNpZGUgYSBzdHJ1Y3QgZGV2aWNlIHdoaWNoIG1hbmFnZXMgdGhlIGxpZmUtY3ljbGUKb2Yg
Ym90aC4gSW4gdGhlIG5haXZlIGFwcHJvYWNoLCB0aGUgcmVmZXJlbmNlIGNvdW50aW5nIGlzIGJy
b2tlbiBhbmQKdGhlIHN0cnVjdCBkZXZpY2UgY2FuIGZyZWUgZXZlcnl0aGluZyBiZWZvcmUgdGhl
IGNoYXJkZXYgY29kZQppcyBlbnRpcmVseSByZWxlYXNlZC4KCk1hbnkgZGV2ZWxvcGVycyBoYXZl
IHNvbHZlZCB0aGlzIHByb2JsZW0gYnkgbGlua2luZyB0aGUgaW50ZXJuYWwga29ianMKaW4gdGhp
cyBmYXNoaW9uOgoKY2Rldi5rb2JqLnBhcmVudCA9ICZwYXJlbnRfZGV2LmtvYmo7CgpUaGUgY2Rl
diBjb2RlIGV4cGxpY2l0bHkgZ2V0cyBhbmQgcHV0cyBhIHJlZmVyZW5jZSB0byBpdCdzIGtvYmog
cGFyZW50LgpTbyB0aGlzIHNlZW1zIGxpa2UgaXQgd2FzIGludGVuZGVkIHRvIGJlIHVzZWQgdGhp
cyB3YXkuIERtaXRydHkgVG9yb2tob3YKZmlyc3QgcHV0IHRoaXMgaW4gcGxhY2UgaW4gMjAxMiB3
aXRoIHRoaXMgY29tbWl0OgoKMmYwMTU3ZiBjaGFyX2RldjogcGluIHBhcmVudCBrb2JqZWN0Cgph
bmQgdGhlIGZpcnN0IGluc3RhbmNlIG9mIHRoZSBmaXggd2FzIHRoZW4gZG9uZSBpbiB0aGUgaW5w
dXQgc3Vic3lzdGVtCmluIHRoZSBmb2xsb3dpbmcgY29tbWl0OgoKNGEyMTVhYSBJbnB1dDogZml4
IHVzZS1hZnRlci1mcmVlIGludHJvZHVjZWQgd2l0aCBkeW5hbWljIG1pbm9yIGNoYW5nZXMKClN1
YnNlcXVlbnRseSBvdmVyIHRoZSB5ZWFycywgaG93ZXZlciwgdGhpcyBpc3N1ZSBzZWVtcyB0byBo
YXZlIHRyaXBwZWQKdXAgbXVsdGlwbGUgZGV2ZWxvcGVycyBpbmRlcGVuZGVudGx5LiBGb3IgZXhh
bXBsZSwgc2VlIHRoZXNlIGNvbW1pdHM6CgowZDViN2RhIGlpbzogUHJldmVudCByYWNlIGJldHdl
ZW4gSUlPIGNoYXJkZXYgb3BlbmluZyBhbmQgSUlPIGRldmljZQooYnkgTGFycy1QZXRlciBDbGF1
c2VuIGluIDIwMTMpCgpiYTBlZjg1IHRwbTogRml4IGluaXRpYWxpemF0aW9uIG9mIHRoZSBjZGV2
CihieSBKYXNvbiBHdW50aG9ycGUgaW4gMjAxNSkKCjViMjhkZGUgW21lZGlhXSBtZWRpYTogZml4
IHVzZS1hZnRlci1mcmVlIGluIGNkZXZfcHV0KCkgd2hlbiBhcHAgZXhpdHMKYWZ0ZXIgZHJpdmVy
IHVuYmluZAooYnkgU2hhdWggS2hhbiBpbiAyMDE2KQoKVGhpcyB0ZWNobmlxdWUgaXMgc2ltaWxh
cmx5IGRvbmUgaW4gYXQgbGVhc3QgMTUgcGxhY2VzIHdpdGhpbiB0aGUga2VybmVsCmFuZCBwcm9i
YWJseSBzaG91bGQgaGF2ZSBiZWVuIGRvbmUgc28gaW4gYW5vdGhlciwgYXQgbGVhc3QsIDUgcGxh
Y2VzLgpUaGUga29iaiBsaW5lIGFsc28gbG9va3MgdmVyeSBzdXNwZWN0IGluIHRoYXQgb25lIHdv
dWxkIG5vdCBleHBlY3QKZHJpdmVycyB0byBoYXZlIHRvIG1lc3Mgd2l0aCBrb2JqZWN0IGludGVy
bmFscyBpbiB0aGlzIHdheS4KRXZlbiBoaWdobHkgZXhwZXJpZW5jZWQga2VybmVsIGRldmVsb3Bl
cnMgY2FuIGJlIHN1cnByaXNlZCBieSB0aGlzCmNvZGUsIGFzIHNlZW4gaW4gWzJdLgoKVG8gaGVs
cCBhbGxldmlhdGUgdGhpcyBzaXR1YXRpb24sIGFuZCBob3BlZnVsbHkgcHJldmVudCBmdXR1cmUK
d2FzdGVkIGVmZm9ydCBvbiB0aGlzIHByb2JsZW0sIHRoaXMgcGF0Y2ggaW50cm9kdWNlcyBhIGhl
bHBlciBmdW5jdGlvbgp0byByZWdpc3RlciBhIGNoYXIgZGV2aWNlIGFsb25nIHdpdGggaXRzIHBh
cmVudCBzdHJ1Y3QgZGV2aWNlLgpUaGlzIGNyZWF0ZXMgYSBtb3JlIHJlZ3VsYXIgQVBJIGZvciB0
eWluZyBhIGNoYXIgZGV2aWNlIHRvIGl0cyBwYXJlbnQKd2l0aG91dCB0aGUgZGV2ZWxvcGVyIGhh
dmluZyB0byBzZXQgbWVtYmVycyBpbiB0aGUgdW5kZXJseWluZyBrb2JqZWN0LgoKVGhpcyBwYXRj
aCBpbnRyb2R1Y2UgY2Rldl9kZXZpY2VfYWRkIGFuZCBjZGV2X2RldmljZV9kZWwgd2hpY2gKcmVw
bGFjZXMgYSBjb21tb24gcGF0dGVybiBpbmNsdWRpbmcgc2V0dGluZyB0aGUga29iaiBwYXJlbnQs
IGNhbGxpbmcKY2Rldl9hZGQgYW5kIHRoZW4gY2FsbGluZyBkZXZpY2VfYWRkLiBJdCBhbHNvIGlu
dHJvZHVjZXMgY2Rldl9zZXRfcGFyZW50CmZvciB0aGUgZmV3IGNhc2VzIHRoYXQgc2V0IHRoZSBr
b2JqZWN0IHBhcmVudCB3aXRob3V0IHVzaW5nIGRldmljZV9hZGQuCgpbMV0gaHR0cHM6Ly9sa21s
Lm9yZy9sa21sLzIwMTcvMi8xMy83MDAKWzJdIGh0dHBzOi8vbGttbC5vcmcvbGttbC8yMDE3LzIv
MTAvMzcwCgpTaWduZWQtb2ZmLWJ5OiBMb2dhbiBHdW50aG9ycGUgPGxvZ2FuZ0BkZWx0YXRlZS5j
b20+ClNpZ25lZC1vZmYtYnk6IERhbiBXaWxsaWFtcyA8ZGFuLmoud2lsbGlhbXNAaW50ZWwuY29t
PgpSZXZpZXdlZC1ieTogSGFucyBWZXJrdWlsIDxoYW5zLnZlcmt1aWxAY2lzY28uY29tPgpSZXZp
ZXdlZC1ieTogQWxleGFuZHJlIEJlbGxvbmkgPGFsZXhhbmRyZS5iZWxsb25pQGZyZWUtZWxlY3Ry
b25zLmNvbT4KU2lnbmVkLW9mZi1ieTogR3JlZyBLcm9haC1IYXJ0bWFuIDxncmVna2hAbGludXhm
b3VuZGF0aW9uLm9yZz4KU2lnbmVkLW9mZi1ieTogQmVuIEh1dGNoaW5ncyA8YmVuLmh1dGNoaW5n
c0Bjb2RldGhpbmsuY28udWs+Ci0tLQogZnMvY2hhcl9kZXYuYyAgICAgICAgfCA4NiArKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogaW5jbHVkZS9saW51eC9jZGV2
LmggfCAgNSArKysKIDIgZmlsZXMgY2hhbmdlZCwgOTEgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdp
dCBhL2ZzL2NoYXJfZGV2LmMgYi9mcy9jaGFyX2Rldi5jCmluZGV4IDIzZTA0NzdlZGY3ZC4uMWJi
Yjk2NmMwNzgzIDEwMDY0NAotLS0gYS9mcy9jaGFyX2Rldi5jCisrKyBiL2ZzL2NoYXJfZGV2LmMK
QEAgLTQ3Nyw2ICs0NzcsODUgQEAgaW50IGNkZXZfYWRkKHN0cnVjdCBjZGV2ICpwLCBkZXZfdCBk
ZXYsIHVuc2lnbmVkIGNvdW50KQogCXJldHVybiAwOwogfQogCisvKioKKyAqIGNkZXZfc2V0X3Bh
cmVudCgpIC0gc2V0IHRoZSBwYXJlbnQga29iamVjdCBmb3IgYSBjaGFyIGRldmljZQorICogQHA6
IHRoZSBjZGV2IHN0cnVjdHVyZQorICogQGtvYmo6IHRoZSBrb2JqZWN0IHRvIHRha2UgYSByZWZl
cmVuY2UgdG8KKyAqCisgKiBjZGV2X3NldF9wYXJlbnQoKSBzZXRzIGEgcGFyZW50IGtvYmplY3Qg
d2hpY2ggd2lsbCBiZSByZWZlcmVuY2VkCisgKiBhcHByb3ByaWF0ZWx5IHNvIHRoZSBwYXJlbnQg
aXMgbm90IGZyZWVkIGJlZm9yZSB0aGUgY2Rldi4gVGhpcworICogc2hvdWxkIGJlIGNhbGxlZCBi
ZWZvcmUgY2Rldl9hZGQuCisgKi8KK3ZvaWQgY2Rldl9zZXRfcGFyZW50KHN0cnVjdCBjZGV2ICpw
LCBzdHJ1Y3Qga29iamVjdCAqa29iaikKK3sKKwlXQVJOX09OKCFrb2JqLT5zdGF0ZV9pbml0aWFs
aXplZCk7CisJcC0+a29iai5wYXJlbnQgPSBrb2JqOworfQorCisvKioKKyAqIGNkZXZfZGV2aWNl
X2FkZCgpIC0gYWRkIGEgY2hhciBkZXZpY2UgYW5kIGl0J3MgY29ycmVzcG9uZGluZworICoJc3Ry
dWN0IGRldmljZSwgbGlua2luaworICogQGRldjogdGhlIGRldmljZSBzdHJ1Y3R1cmUKKyAqIEBj
ZGV2OiB0aGUgY2RldiBzdHJ1Y3R1cmUKKyAqCisgKiBjZGV2X2RldmljZV9hZGQoKSBhZGRzIHRo
ZSBjaGFyIGRldmljZSByZXByZXNlbnRlZCBieSBAY2RldiB0byB0aGUgc3lzdGVtLAorICoganVz
dCBhcyBjZGV2X2FkZCBkb2VzLiBJdCB0aGVuIGFkZHMgQGRldiB0byB0aGUgc3lzdGVtIHVzaW5n
IGRldmljZV9hZGQKKyAqIFRoZSBkZXZfdCBmb3IgdGhlIGNoYXIgZGV2aWNlIHdpbGwgYmUgdGFr
ZW4gZnJvbSB0aGUgc3RydWN0IGRldmljZSB3aGljaAorICogbmVlZHMgdG8gYmUgaW5pdGlhbGl6
ZWQgZmlyc3QuIFRoaXMgaGVscGVyIGZ1bmN0aW9uIGNvcnJlY3RseSB0YWtlcyBhCisgKiByZWZl
cmVuY2UgdG8gdGhlIHBhcmVudCBkZXZpY2Ugc28gdGhlIHBhcmVudCB3aWxsIG5vdCBnZXQgcmVs
ZWFzZWQgdW50aWwKKyAqIGFsbCByZWZlcmVuY2VzIHRvIHRoZSBjZGV2IGFyZSByZWxlYXNlZC4K
KyAqCisgKiBUaGlzIGhlbHBlciB1c2VzIGRldi0+ZGV2dCBmb3IgdGhlIGRldmljZSBudW1iZXIu
IElmIGl0IGlzIG5vdCBzZXQKKyAqIGl0IHdpbGwgbm90IGFkZCB0aGUgY2RldiBhbmQgaXQgd2ls
bCBiZSBlcXVpdmFsZW50IHRvIGRldmljZV9hZGQuCisgKgorICogVGhpcyBmdW5jdGlvbiBzaG91
bGQgYmUgdXNlZCB3aGVuZXZlciB0aGUgc3RydWN0IGNkZXYgYW5kIHRoZQorICogc3RydWN0IGRl
dmljZSBhcmUgbWVtYmVycyBvZiB0aGUgc2FtZSBzdHJ1Y3R1cmUgd2hvc2UgbGlmZXRpbWUgaXMK
KyAqIG1hbmFnZWQgYnkgdGhlIHN0cnVjdCBkZXZpY2UuCisgKgorICogTk9URTogQ2FsbGVycyBt
dXN0IGFzc3VtZSB0aGF0IHVzZXJzcGFjZSB3YXMgYWJsZSB0byBvcGVuIHRoZSBjZGV2IGFuZAor
ICogY2FuIGNhbGwgY2RldiBmb3BzIGNhbGxiYWNrcyBhdCBhbnkgdGltZSwgZXZlbiBpZiB0aGlz
IGZ1bmN0aW9uIGZhaWxzLgorICovCitpbnQgY2Rldl9kZXZpY2VfYWRkKHN0cnVjdCBjZGV2ICpj
ZGV2LCBzdHJ1Y3QgZGV2aWNlICpkZXYpCit7CisJaW50IHJjID0gMDsKKworCWlmIChkZXYtPmRl
dnQpIHsKKwkJY2Rldl9zZXRfcGFyZW50KGNkZXYsICZkZXYtPmtvYmopOworCisJCXJjID0gY2Rl
dl9hZGQoY2RldiwgZGV2LT5kZXZ0LCAxKTsKKwkJaWYgKHJjKQorCQkJcmV0dXJuIHJjOworCX0K
KworCXJjID0gZGV2aWNlX2FkZChkZXYpOworCWlmIChyYykKKwkJY2Rldl9kZWwoY2Rldik7CisK
KwlyZXR1cm4gcmM7Cit9CisKKy8qKgorICogY2Rldl9kZXZpY2VfZGVsKCkgLSBpbnZlcnNlIG9m
IGNkZXZfZGV2aWNlX2FkZAorICogQGRldjogdGhlIGRldmljZSBzdHJ1Y3R1cmUKKyAqIEBjZGV2
OiB0aGUgY2RldiBzdHJ1Y3R1cmUKKyAqCisgKiBjZGV2X2RldmljZV9kZWwoKSBpcyBhIGhlbHBl
ciBmdW5jdGlvbiB0byBjYWxsIGNkZXZfZGVsIGFuZCBkZXZpY2VfZGVsLgorICogSXQgc2hvdWxk
IGJlIHVzZWQgd2hlbmV2ZXIgY2Rldl9kZXZpY2VfYWRkIGlzIHVzZWQuCisgKgorICogSWYgZGV2
LT5kZXZ0IGlzIG5vdCBzZXQgaXQgd2lsbCBub3QgcmVtb3ZlIHRoZSBjZGV2IGFuZCB3aWxsIGJl
IGVxdWl2YWxlbnQKKyAqIHRvIGRldmljZV9kZWwuCisgKgorICogTk9URTogVGhpcyBndWFyYW50
ZWVzIHRoYXQgYXNzb2NpYXRlZCBzeXNmcyBjYWxsYmFja3MgYXJlIG5vdCBydW5uaW5nCisgKiBv
ciBydW5uYWJsZSwgaG93ZXZlciBhbnkgY2RldnMgYWxyZWFkeSBvcGVuIHdpbGwgcmVtYWluIGFu
ZCB0aGVpciBmb3BzCisgKiB3aWxsIHN0aWxsIGJlIGNhbGxhYmxlIGV2ZW4gYWZ0ZXIgdGhpcyBm
dW5jdGlvbiByZXR1cm5zLgorICovCit2b2lkIGNkZXZfZGV2aWNlX2RlbChzdHJ1Y3QgY2RldiAq
Y2Rldiwgc3RydWN0IGRldmljZSAqZGV2KQoreworCWRldmljZV9kZWwoZGV2KTsKKwlpZiAoZGV2
LT5kZXZ0KQorCQljZGV2X2RlbChjZGV2KTsKK30KKwogc3RhdGljIHZvaWQgY2Rldl91bm1hcChk
ZXZfdCBkZXYsIHVuc2lnbmVkIGNvdW50KQogewogCWtvYmpfdW5tYXAoY2Rldl9tYXAsIGRldiwg
Y291bnQpOwpAQCAtNDg4LDYgKzU2NywxMCBAQCBzdGF0aWMgdm9pZCBjZGV2X3VubWFwKGRldl90
IGRldiwgdW5zaWduZWQgY291bnQpCiAgKgogICogY2Rldl9kZWwoKSByZW1vdmVzIEBwIGZyb20g
dGhlIHN5c3RlbSwgcG9zc2libHkgZnJlZWluZyB0aGUgc3RydWN0dXJlCiAgKiBpdHNlbGYuCisg
KgorICogTk9URTogVGhpcyBndWFyYW50ZWVzIHRoYXQgY2RldiBkZXZpY2Ugd2lsbCBubyBsb25n
ZXIgYmUgYWJsZSB0byBiZQorICogb3BlbmVkLCBob3dldmVyIGFueSBjZGV2cyBhbHJlYWR5IG9w
ZW4gd2lsbCByZW1haW4gYW5kIHRoZWlyIGZvcHMgd2lsbAorICogc3RpbGwgYmUgY2FsbGFibGUg
ZXZlbiBhZnRlciBjZGV2X2RlbCByZXR1cm5zLgogICovCiB2b2lkIGNkZXZfZGVsKHN0cnVjdCBj
ZGV2ICpwKQogewpAQCAtNTc2LDUgKzY1OSw4IEBAIEVYUE9SVF9TWU1CT0woY2Rldl9pbml0KTsK
IEVYUE9SVF9TWU1CT0woY2Rldl9hbGxvYyk7CiBFWFBPUlRfU1lNQk9MKGNkZXZfZGVsKTsKIEVY
UE9SVF9TWU1CT0woY2Rldl9hZGQpOworRVhQT1JUX1NZTUJPTChjZGV2X3NldF9wYXJlbnQpOwor
RVhQT1JUX1NZTUJPTChjZGV2X2RldmljZV9hZGQpOworRVhQT1JUX1NZTUJPTChjZGV2X2Rldmlj
ZV9kZWwpOwogRVhQT1JUX1NZTUJPTChfX3JlZ2lzdGVyX2NocmRldik7CiBFWFBPUlRfU1lNQk9M
KF9fdW5yZWdpc3Rlcl9jaHJkZXYpOwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9jZGV2Lmgg
Yi9pbmNsdWRlL2xpbnV4L2NkZXYuaAppbmRleCBmODc2MzYxNWE1ZjIuLjQwOGJjMDljZTQ5NyAx
MDA2NDQKLS0tIGEvaW5jbHVkZS9saW51eC9jZGV2LmgKKysrIGIvaW5jbHVkZS9saW51eC9jZGV2
LmgKQEAgLTQsNiArNCw3IEBACiAjaW5jbHVkZSA8bGludXgva29iamVjdC5oPgogI2luY2x1ZGUg
PGxpbnV4L2tkZXZfdC5oPgogI2luY2x1ZGUgPGxpbnV4L2xpc3QuaD4KKyNpbmNsdWRlIDxsaW51
eC9kZXZpY2UuaD4KIAogc3RydWN0IGZpbGVfb3BlcmF0aW9uczsKIHN0cnVjdCBpbm9kZTsKQEAg
LTI2LDYgKzI3LDEwIEBAIHZvaWQgY2Rldl9wdXQoc3RydWN0IGNkZXYgKnApOwogCiBpbnQgY2Rl
dl9hZGQoc3RydWN0IGNkZXYgKiwgZGV2X3QsIHVuc2lnbmVkKTsKIAordm9pZCBjZGV2X3NldF9w
YXJlbnQoc3RydWN0IGNkZXYgKnAsIHN0cnVjdCBrb2JqZWN0ICprb2JqKTsKK2ludCBjZGV2X2Rl
dmljZV9hZGQoc3RydWN0IGNkZXYgKmNkZXYsIHN0cnVjdCBkZXZpY2UgKmRldik7Cit2b2lkIGNk
ZXZfZGV2aWNlX2RlbChzdHJ1Y3QgY2RldiAqY2Rldiwgc3RydWN0IGRldmljZSAqZGV2KTsKKwog
dm9pZCBjZGV2X2RlbChzdHJ1Y3QgY2RldiAqKTsKIAogdm9pZCBjZF9mb3JnZXQoc3RydWN0IGlu
b2RlICopOwoKRnJvbSA1ZTcxODJlNDU1OWMxOTU4OWI3MjliOTYxZWNiNWU2NGY3MjQyOGY2IE1v
biBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBZdWVIYWliaW5nIDx5dWVoYWliaW5nQGh1YXdl
aS5jb20+CkRhdGU6IEZyaSwgMjMgTm92IDIwMTggMDk6NTQ6NTUgKzA4MDAKU3ViamVjdDogcHRw
OiBGaXggcGFzcyB6ZXJvIHRvIEVSUl9QVFIoKSBpbiBwdHBfY2xvY2tfcmVnaXN0ZXIKCmNvbW1p
dCBhZWEwYTg5N2FmOWU0NGMyNThlOGFiOTI5NmZhZDQxN2YxYmMwNjNhIHVwc3RyZWFtLgoKRml4
IHNtYXRjaCB3YXJuaW5nOgoKZHJpdmVycy9wdHAvcHRwX2Nsb2NrLmM6Mjk4IHB0cF9jbG9ja19y
ZWdpc3RlcigpIHdhcm46CiBwYXNzaW5nIHplcm8gdG8gJ0VSUl9QVFInCgonZXJyJyBzaG91bGQg
YmUgc2V0IHdoaWxlIGRldmljZV9jcmVhdGVfd2l0aF9ncm91cHMgYW5kCnBwc19yZWdpc3Rlcl9z
b3VyY2UgZmFpbHMKCkZpeGVzOiA4NWE2NmU1NTAxOTUgKCJwdHA6IGNyZWF0ZSAicGlucyIgdG9n
ZXRoZXIgd2l0aCB0aGUgcmVzdCBvZiBhdHRyaWJ1dGVzIikKU2lnbmVkLW9mZi1ieTogWXVlSGFp
YmluZyA8eXVlaGFpYmluZ0BodWF3ZWkuY29tPgpBY2tlZC1ieTogUmljaGFyZCBDb2NocmFuIDxy
aWNoYXJkY29jaHJhbkBnbWFpbC5jb20+ClNpZ25lZC1vZmYtYnk6IERhdmlkIFMuIE1pbGxlciA8
ZGF2ZW1AZGF2ZW1sb2Z0Lm5ldD4KU2lnbmVkLW9mZi1ieTogQmVuIEh1dGNoaW5ncyA8YmVuLmh1
dGNoaW5nc0Bjb2RldGhpbmsuY28udWs+Ci0tLQogZHJpdmVycy9wdHAvcHRwX2Nsb2NrLmMgfCA1
ICsrKystCiAxIGZpbGUgY2hhbmdlZCwgNCBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9wdHAvcHRwX2Nsb2NrLmMgYi9kcml2ZXJzL3B0cC9wdHBfY2xv
Y2suYwppbmRleCBkNWFjMzMzNTA4ODkuLmI4N2I3YjA4NjdhNCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9wdHAvcHRwX2Nsb2NrLmMKKysrIGIvZHJpdmVycy9wdHAvcHRwX2Nsb2NrLmMKQEAgLTIyMiw4
ICsyMjIsMTAgQEAgc3RydWN0IHB0cF9jbG9jayAqcHRwX2Nsb2NrX3JlZ2lzdGVyKHN0cnVjdCBw
dHBfY2xvY2tfaW5mbyAqaW5mbywKIAlwdHAtPmRldiA9IGRldmljZV9jcmVhdGVfd2l0aF9ncm91
cHMocHRwX2NsYXNzLCBwYXJlbnQsIHB0cC0+ZGV2aWQsCiAJCQkJCSAgICAgcHRwLCBwdHAtPnBp
bl9hdHRyX2dyb3VwcywKIAkJCQkJICAgICAicHRwJWQiLCBwdHAtPmluZGV4KTsKLQlpZiAoSVNf
RVJSKHB0cC0+ZGV2KSkKKwlpZiAoSVNfRVJSKHB0cC0+ZGV2KSkgeworCQllcnIgPSBQVFJfRVJS
KHB0cC0+ZGV2KTsKIAkJZ290byBub19kZXZpY2U7CisJfQogCiAJLyogUmVnaXN0ZXIgYSBuZXcg
UFBTIHNvdXJjZS4gKi8KIAlpZiAoaW5mby0+cHBzKSB7CkBAIC0yMzQsNiArMjM2LDcgQEAgc3Ry
dWN0IHB0cF9jbG9jayAqcHRwX2Nsb2NrX3JlZ2lzdGVyKHN0cnVjdCBwdHBfY2xvY2tfaW5mbyAq
aW5mbywKIAkJcHBzLm93bmVyID0gaW5mby0+b3duZXI7CiAJCXB0cC0+cHBzX3NvdXJjZSA9IHBw
c19yZWdpc3Rlcl9zb3VyY2UoJnBwcywgUFRQX1BQU19ERUZBVUxUUyk7CiAJCWlmICghcHRwLT5w
cHNfc291cmNlKSB7CisJCQllcnIgPSAtRUlOVkFMOwogCQkJcHJfZXJyKCJmYWlsZWQgdG8gcmVn
aXN0ZXIgcHBzIHNvdXJjZVxuIik7CiAJCQlnb3RvIG5vX3BwczsKIAkJfQoKRnJvbSA1YjEwNjk3
YmFkYTJkNTMyMDQ5Y2YzN2NjOGNlODUyMjI4Y2IxN2ZkIE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAw
MQpGcm9tOiBWbGFkaXMgRHJvbm92IDx2ZHJvbm92QHJlZGhhdC5jb20+CkRhdGU6IEZyaSwgMjcg
RGVjIDIwMTkgMDM6MjY6MjcgKzAxMDAKU3ViamVjdDogcHRwOiBmaXggdGhlIHJhY2UgYmV0d2Vl
biB0aGUgcmVsZWFzZSBvZiBwdHBfY2xvY2sgYW5kIGNkZXYKCmNvbW1pdCBhMzMxMjFlNTQ4N2I0
MjQzMzk2MzZiMjVjMzVkM2ExODBlYWE1ZjVlIHVwc3RyZWFtLgoKSW4gYSBjYXNlIHdoZW4gYSBw
dHAgY2hhcmRldiAobGlrZSAvZGV2L3B0cDApIGlzIG9wZW4gYnV0IGFuIHVuZGVybHlpbmcKZGV2
aWNlIGlzIHJlbW92ZWQsIGNsb3NpbmcgdGhpcyBmaWxlIGxlYWRzIHRvIGEgcmFjZS4gVGhpcyBy
ZXByb2R1Y2VzCmVhc2lseSBpbiBhIGt2bSB2aXJ0dWFsIG1hY2hpbmU6Cgp0cyMgY2F0IG9wZW5w
dHAwLmMKaW50IG1haW4oKSB7IC4uLiBmcCA9IGZvcGVuKCIvZGV2L3B0cDAiLCAiciIpOyAuLi4g
c2xlZXAoMTApOyB9CnRzIyB1bmFtZSAtcgo1LjUuMC1yYzMtNDZjZjA1M2UKdHMjIGNhdCAvcHJv
Yy9jbWRsaW5lCi4uLiBzbHViX2RlYnVnPUZaUAp0cyMgbW9kcHJvYmUgcHRwX2t2bQp0cyMgLi9v
cGVucHRwMCAmClsxXSA2NzAKb3BlbmVkIC9kZXYvcHRwMCwgc2xlZXBpbmcgMTBzLi4uCnRzIyBy
bW1vZCBwdHBfa3ZtCnRzIyBscyAvZGV2L3B0cCoKbHM6IGNhbm5vdCBhY2Nlc3MgJy9kZXYvcHRw
Kic6IE5vIHN1Y2ggZmlsZSBvciBkaXJlY3RvcnkKdHMjIC4uLndva2VuIHVwClsgICA0OC4wMTA4
MDldIGdlbmVyYWwgcHJvdGVjdGlvbiBmYXVsdDogMDAwMCBbIzFdIFNNUApbICAgNDguMDEyNTAy
XSBDUFU6IDYgUElEOiA2NTggQ29tbTogb3BlbnB0cDAgTm90IHRhaW50ZWQgNS41LjAtcmMzLTQ2
Y2YwNTNlICMyNQpbICAgNDguMDE0NjI0XSBIYXJkd2FyZSBuYW1lOiBRRU1VIFN0YW5kYXJkIFBD
IChpNDQwRlggKyBQSUlYLCAxOTk2KSwgLi4uClsgICA0OC4wMTYyNzBdIFJJUDogMDAxMDptb2R1
bGVfcHV0LnBhcnQuMCsweDcvMHg4MApbICAgNDguMDE3OTM5XSBSU1A6IDAwMTg6ZmZmZmIzODUw
MDczYmUwMCBFRkxBR1M6IDAwMDEwMjAyClsgICA0OC4wMTgzMzldIFJBWDogMDAwMDAwMDA2YjZi
NmI2YiBSQlg6IDZiNmI2YjZiNmI2YjZiNmIgUkNYOiBmZmZmODlhNDc2YzAwYWQwClsgICA0OC4w
MTg5MzZdIFJEWDogZmZmZmY2NWEwOGQzZWEwOCBSU0k6IDAwMDAwMDAwMDAwMDAyNDcgUkRJOiA2
YjZiNmI2YjZiNmI2YjZiClsgICA0OC4wMTk0NzBdIC4uLiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBeXl4gYSBzbHViIHBvaXNvbgpbICAgNDguMDIzODU0XSBD
YWxsIFRyYWNlOgpbICAgNDguMDI0MDUwXSAgX19mcHV0KzB4MjFmLzB4MjQwClsgICA0OC4wMjQy
ODhdICB0YXNrX3dvcmtfcnVuKzB4NzkvMHg5MApbICAgNDguMDI0NTU1XSAgZG9fZXhpdCsweDJh
Zi8weGFiMApbICAgNDguMDI0Nzk5XSAgPyB2ZnNfd3JpdGUrMHgxNmEvMHgxOTAKWyAgIDQ4LjAy
NTA4Ml0gIGRvX2dyb3VwX2V4aXQrMHgzNS8weDkwClsgICA0OC4wMjUzODddICBfX3g2NF9zeXNf
ZXhpdF9ncm91cCsweGYvMHgxMApbICAgNDguMDI1NzM3XSAgZG9fc3lzY2FsbF82NCsweDNkLzB4
MTMwClsgICA0OC4wMjYwNTZdICBlbnRyeV9TWVNDQUxMXzY0X2FmdGVyX2h3ZnJhbWUrMHg0NC8w
eGE5ClsgICA0OC4wMjY0NzldIFJJUDogMDAzMzoweDdmNTNiMTIwODJmNgpbICAgNDguMDI2Nzky
XSAuLi4KWyAgIDQ4LjAzMDk0NV0gTW9kdWxlcyBsaW5rZWQgaW46IHB0cCBpNjMwMGVzYiB3YXRj
aGRvZyBbbGFzdCB1bmxvYWRlZDogcHRwX2t2bV0KWyAgIDQ4LjA0NTAwMV0gRml4aW5nIHJlY3Vy
c2l2ZSBmYXVsdCBidXQgcmVib290IGlzIG5lZWRlZCEKClRoaXMgaGFwcGVucyBpbjoKCnN0YXRp
YyB2b2lkIF9fZnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSkKeyAgIC4uLgogICAgaWYgKGZpbGUtPmZf
b3AtPnJlbGVhc2UpCiAgICAgICAgZmlsZS0+Zl9vcC0+cmVsZWFzZShpbm9kZSwgZmlsZSk7IDw8
PCBjZGV2IGlzIGtmcmVlJ2QgaGVyZQogICAgaWYgKHVubGlrZWx5KFNfSVNDSFIoaW5vZGUtPmlf
bW9kZSkgJiYgaW5vZGUtPmlfY2RldiAhPSBOVUxMICYmCiAgICAgICAgICAgICAhKG1vZGUgJiBG
TU9ERV9QQVRIKSkpIHsKICAgICAgICBjZGV2X3B1dChpbm9kZS0+aV9jZGV2KTsgPDw8IGNkZXYg
ZmllbGRzIGFyZSBhY2Nlc3NlZCBoZXJlCgpOYW1lbHk6CgpfX2ZwdXQoKQogIHBvc2l4X2Nsb2Nr
X3JlbGVhc2UoKQogICAga3JlZl9wdXQoJmNsay0+a3JlZiwgZGVsZXRlX2Nsb2NrKSA8PDwgdGhl
IGxhc3QgcmVmZXJlbmNlCiAgICAgIGRlbGV0ZV9jbG9jaygpCiAgICAgICAgZGVsZXRlX3B0cF9j
bG9jaygpCiAgICAgICAgICBrZnJlZShwdHApIDw8PCBjZGV2IGlzIGVtYmVkZGVkIGluIHB0cAog
IGNkZXZfcHV0CiAgICBtb2R1bGVfcHV0KHAtPm93bmVyKSA8PDwgKnAgaXMga2ZyZWUnZCwgYmFu
ZyEKCkhlcmUgY2RldiBpcyBlbWJlZGRlZCBpbiBwb3NpeF9jbG9jayB3aGljaCBpcyBlbWJlZGRl
ZCBpbiBwdHBfY2xvY2suClRoZSByYWNlIGhhcHBlbnMgYmVjYXVzZSBwdHBfY2xvY2sncyBsaWZl
dGltZSBpcyBjb250cm9sbGVkIGJ5IHR3bwpyZWZjb3VudHM6IGtyZWYgYW5kIGNkZXYua29iaiBp
biBwb3NpeF9jbG9jay4gVGhpcyBpcyB3cm9uZy4KCk1ha2UgcHRwX2Nsb2NrJ3Mgc3lzZnMgZGV2
aWNlIGEgcGFyZW50IG9mIGNkZXYgd2l0aCBjZGV2X2RldmljZV9hZGQoKQpjcmVhdGVkIGVzcGVj
aWFsbHkgZm9yIHN1Y2ggY2FzZXMuIFRoaXMgd2F5IHRoZSBwYXJlbnQgZGV2aWNlIHdpdGggaXRz
CnB0cF9jbG9jayBpcyBub3QgcmVsZWFzZWQgdW50aWwgYWxsIHJlZmVyZW5jZXMgdG8gdGhlIGNk
ZXYgYXJlIHJlbGVhc2VkLgpUaGlzIGFkZHMgYSByZXF1aXJlbWVudCB0aGF0IGFuIGluaXRpYWxp
emVkIGJ1dCBub3QgZXhwb3NlZCBzdHJ1Y3QKZGV2aWNlIHNob3VsZCBiZSBwcm92aWRlZCB0byBw
b3NpeF9jbG9ja19yZWdpc3RlcigpIGJ5IGEgY2FsbGVyIGluc3RlYWQKb2YgYSBzaW1wbGUgZGV2
X3QuCgpUaGlzIGFwcHJvYWNoIHdhcyBhZG9wdGVkIGZyb20gdGhlIGNvbW1pdCA3MjEzOWRmYTI0
NjQgKCJ3YXRjaGRvZzogRml4CnRoZSByYWNlIGJldHdlZW4gdGhlIHJlbGVhc2Ugb2Ygd2F0Y2hk
b2dfY29yZV9kYXRhIGFuZCBjZGV2IikuIFNlZQpkZXRhaWxzIG9mIHRoZSBpbXBsZW1lbnRhdGlv
biBpbiB0aGUgY29tbWl0IDIzM2VkMDlkN2ZkYSAoImNoYXJkZXY6IGFkZApoZWxwZXIgZnVuY3Rp
b24gdG8gcmVnaXN0ZXIgY2hhciBkZXZzIHdpdGggYSBzdHJ1Y3QgZGV2aWNlIikuCgpMaW5rOiBo
dHRwczovL2xvcmUua2VybmVsLm9yZy9saW51eC1mc2RldmVsLzIwMTkxMTI1MTI1MzQyLjYxODkt
MS12ZHJvbm92QHJlZGhhdC5jb20vVC8jdQpBbmFseXplZC1ieTogU3RlcGhlbiBKb2huc3RvbiA8
c2pvaG5zdG9AcmVkaGF0LmNvbT4KQW5hbHl6ZWQtYnk6IFZlcm4gTG92ZWpveSA8dmxvdmVqb3lA
cmVkaGF0LmNvbT4KU2lnbmVkLW9mZi1ieTogVmxhZGlzIERyb25vdiA8dmRyb25vdkByZWRoYXQu
Y29tPgpBY2tlZC1ieTogUmljaGFyZCBDb2NocmFuIDxyaWNoYXJkY29jaHJhbkBnbWFpbC5jb20+
ClNpZ25lZC1vZmYtYnk6IERhdmlkIFMuIE1pbGxlciA8ZGF2ZW1AZGF2ZW1sb2Z0Lm5ldD4KU2ln
bmVkLW9mZi1ieTogQmVuIEh1dGNoaW5ncyA8YmVuLmh1dGNoaW5nc0Bjb2RldGhpbmsuY28udWs+
Ci0tLQogZHJpdmVycy9wdHAvcHRwX2Nsb2NrLmMgICAgIHwgMzEgKysrKysrKysrKysrKystLS0t
LS0tLS0tLS0tLS0tLQogZHJpdmVycy9wdHAvcHRwX3ByaXZhdGUuaCAgIHwgIDIgKy0KIGluY2x1
ZGUvbGludXgvcG9zaXgtY2xvY2suaCB8IDE5ICsrKysrKysrKysrLS0tLS0tLS0KIGtlcm5lbC90
aW1lL3Bvc2l4LWNsb2NrLmMgICB8IDMxICsrKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0K
IDQgZmlsZXMgY2hhbmdlZCwgMzkgaW5zZXJ0aW9ucygrKSwgNDQgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9wdHAvcHRwX2Nsb2NrLmMgYi9kcml2ZXJzL3B0cC9wdHBfY2xvY2su
YwppbmRleCBiODdiN2IwODY3YTQuLjJjMWFlMzI0ZGExOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9w
dHAvcHRwX2Nsb2NrLmMKKysrIGIvZHJpdmVycy9wdHAvcHRwX2Nsb2NrLmMKQEAgLTE3MSw5ICsx
NzEsOSBAQCBzdGF0aWMgc3RydWN0IHBvc2l4X2Nsb2NrX29wZXJhdGlvbnMgcHRwX2Nsb2NrX29w
cyA9IHsKIAkucmVhZAkJPSBwdHBfcmVhZCwKIH07CiAKLXN0YXRpYyB2b2lkIGRlbGV0ZV9wdHBf
Y2xvY2soc3RydWN0IHBvc2l4X2Nsb2NrICpwYykKK3N0YXRpYyB2b2lkIHB0cF9jbG9ja19yZWxl
YXNlKHN0cnVjdCBkZXZpY2UgKmRldikKIHsKLQlzdHJ1Y3QgcHRwX2Nsb2NrICpwdHAgPSBjb250
YWluZXJfb2YocGMsIHN0cnVjdCBwdHBfY2xvY2ssIGNsb2NrKTsKKwlzdHJ1Y3QgcHRwX2Nsb2Nr
ICpwdHAgPSBjb250YWluZXJfb2YoZGV2LCBzdHJ1Y3QgcHRwX2Nsb2NrLCBkZXYpOwogCiAJbXV0
ZXhfZGVzdHJveSgmcHRwLT50c2V2cV9tdXgpOwogCW11dGV4X2Rlc3Ryb3koJnB0cC0+cGluY2Zn
X211eCk7CkBAIC0yMDUsNyArMjA1LDYgQEAgc3RydWN0IHB0cF9jbG9jayAqcHRwX2Nsb2NrX3Jl
Z2lzdGVyKHN0cnVjdCBwdHBfY2xvY2tfaW5mbyAqaW5mbywKIAl9CiAKIAlwdHAtPmNsb2NrLm9w
cyA9IHB0cF9jbG9ja19vcHM7Ci0JcHRwLT5jbG9jay5yZWxlYXNlID0gZGVsZXRlX3B0cF9jbG9j
azsKIAlwdHAtPmluZm8gPSBpbmZvOwogCXB0cC0+ZGV2aWQgPSBNS0RFVihtYWpvciwgaW5kZXgp
OwogCXB0cC0+aW5kZXggPSBpbmRleDsKQEAgLTIxOCwxNSArMjE3LDYgQEAgc3RydWN0IHB0cF9j
bG9jayAqcHRwX2Nsb2NrX3JlZ2lzdGVyKHN0cnVjdCBwdHBfY2xvY2tfaW5mbyAqaW5mbywKIAlp
ZiAoZXJyKQogCQlnb3RvIG5vX3Bpbl9ncm91cHM7CiAKLQkvKiBDcmVhdGUgYSBuZXcgZGV2aWNl
IGluIG91ciBjbGFzcy4gKi8KLQlwdHAtPmRldiA9IGRldmljZV9jcmVhdGVfd2l0aF9ncm91cHMo
cHRwX2NsYXNzLCBwYXJlbnQsIHB0cC0+ZGV2aWQsCi0JCQkJCSAgICAgcHRwLCBwdHAtPnBpbl9h
dHRyX2dyb3VwcywKLQkJCQkJICAgICAicHRwJWQiLCBwdHAtPmluZGV4KTsKLQlpZiAoSVNfRVJS
KHB0cC0+ZGV2KSkgewotCQllcnIgPSBQVFJfRVJSKHB0cC0+ZGV2KTsKLQkJZ290byBub19kZXZp
Y2U7Ci0JfQotCiAJLyogUmVnaXN0ZXIgYSBuZXcgUFBTIHNvdXJjZS4gKi8KIAlpZiAoaW5mby0+
cHBzKSB7CiAJCXN0cnVjdCBwcHNfc291cmNlX2luZm8gcHBzOwpAQCAtMjQyLDggKzIzMiwxOCBA
QCBzdHJ1Y3QgcHRwX2Nsb2NrICpwdHBfY2xvY2tfcmVnaXN0ZXIoc3RydWN0IHB0cF9jbG9ja19p
bmZvICppbmZvLAogCQl9CiAJfQogCi0JLyogQ3JlYXRlIGEgcG9zaXggY2xvY2suICovCi0JZXJy
ID0gcG9zaXhfY2xvY2tfcmVnaXN0ZXIoJnB0cC0+Y2xvY2ssIHB0cC0+ZGV2aWQpOworCS8qIElu
aXRpYWxpemUgYSBuZXcgZGV2aWNlIG9mIG91ciBjbGFzcyBpbiBvdXIgY2xvY2sgc3RydWN0dXJl
LiAqLworCWRldmljZV9pbml0aWFsaXplKCZwdHAtPmRldik7CisJcHRwLT5kZXYuZGV2dCA9IHB0
cC0+ZGV2aWQ7CisJcHRwLT5kZXYuY2xhc3MgPSBwdHBfY2xhc3M7CisJcHRwLT5kZXYucGFyZW50
ID0gcGFyZW50OworCXB0cC0+ZGV2Lmdyb3VwcyA9IHB0cC0+cGluX2F0dHJfZ3JvdXBzOworCXB0
cC0+ZGV2LnJlbGVhc2UgPSBwdHBfY2xvY2tfcmVsZWFzZTsKKwlkZXZfc2V0X2RydmRhdGEoJnB0
cC0+ZGV2LCBwdHApOworCWRldl9zZXRfbmFtZSgmcHRwLT5kZXYsICJwdHAlZCIsIHB0cC0+aW5k
ZXgpOworCisJLyogQ3JlYXRlIGEgcG9zaXggY2xvY2sgYW5kIGxpbmsgaXQgdG8gdGhlIGRldmlj
ZS4gKi8KKwllcnIgPSBwb3NpeF9jbG9ja19yZWdpc3RlcigmcHRwLT5jbG9jaywgJnB0cC0+ZGV2
KTsKIAlpZiAoZXJyKSB7CiAJCXByX2VycigiZmFpbGVkIHRvIGNyZWF0ZSBwb3NpeCBjbG9ja1xu
Iik7CiAJCWdvdG8gbm9fY2xvY2s7CkBAIC0yNTUsOCArMjU1LDYgQEAgc3RydWN0IHB0cF9jbG9j
ayAqcHRwX2Nsb2NrX3JlZ2lzdGVyKHN0cnVjdCBwdHBfY2xvY2tfaW5mbyAqaW5mbywKIAlpZiAo
cHRwLT5wcHNfc291cmNlKQogCQlwcHNfdW5yZWdpc3Rlcl9zb3VyY2UocHRwLT5wcHNfc291cmNl
KTsKIG5vX3BwczoKLQlkZXZpY2VfZGVzdHJveShwdHBfY2xhc3MsIHB0cC0+ZGV2aWQpOwotbm9f
ZGV2aWNlOgogCXB0cF9jbGVhbnVwX3Bpbl9ncm91cHMocHRwKTsKIG5vX3Bpbl9ncm91cHM6CiAJ
bXV0ZXhfZGVzdHJveSgmcHRwLT50c2V2cV9tdXgpOwpAQCAtMjc4LDcgKzI3Niw2IEBAIGludCBw
dHBfY2xvY2tfdW5yZWdpc3RlcihzdHJ1Y3QgcHRwX2Nsb2NrICpwdHApCiAJaWYgKHB0cC0+cHBz
X3NvdXJjZSkKIAkJcHBzX3VucmVnaXN0ZXJfc291cmNlKHB0cC0+cHBzX3NvdXJjZSk7CiAKLQlk
ZXZpY2VfZGVzdHJveShwdHBfY2xhc3MsIHB0cC0+ZGV2aWQpOwogCXB0cF9jbGVhbnVwX3Bpbl9n
cm91cHMocHRwKTsKIAogCXBvc2l4X2Nsb2NrX3VucmVnaXN0ZXIoJnB0cC0+Y2xvY2spOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9wdHAvcHRwX3ByaXZhdGUuaCBiL2RyaXZlcnMvcHRwL3B0cF9wcml2
YXRlLmgKaW5kZXggZDk1ODg4OTc0ZDBjLi4xNTM0NmU4NDBjYWEgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvcHRwL3B0cF9wcml2YXRlLmgKKysrIGIvZHJpdmVycy9wdHAvcHRwX3ByaXZhdGUuaApAQCAt
NDAsNyArNDAsNyBAQCBzdHJ1Y3QgdGltZXN0YW1wX2V2ZW50X3F1ZXVlIHsKIAogc3RydWN0IHB0
cF9jbG9jayB7CiAJc3RydWN0IHBvc2l4X2Nsb2NrIGNsb2NrOwotCXN0cnVjdCBkZXZpY2UgKmRl
djsKKwlzdHJ1Y3QgZGV2aWNlIGRldjsKIAlzdHJ1Y3QgcHRwX2Nsb2NrX2luZm8gKmluZm87CiAJ
ZGV2X3QgZGV2aWQ7CiAJaW50IGluZGV4OyAvKiBpbmRleCBpbnRvIGNsb2Nrcy5tYXAgKi8KZGlm
ZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvcG9zaXgtY2xvY2suaCBiL2luY2x1ZGUvbGludXgvcG9z
aXgtY2xvY2suaAppbmRleCA4M2IyMmFlOWFlMTIuLmIzOTQyMGEwMzIxYyAxMDA2NDQKLS0tIGEv
aW5jbHVkZS9saW51eC9wb3NpeC1jbG9jay5oCisrKyBiL2luY2x1ZGUvbGludXgvcG9zaXgtY2xv
Y2suaApAQCAtMTA0LDI5ICsxMDQsMzIgQEAgc3RydWN0IHBvc2l4X2Nsb2NrX29wZXJhdGlvbnMg
ewogICoKICAqIEBvcHM6ICAgICBGdW5jdGlvbmFsIGludGVyZmFjZSB0byB0aGUgY2xvY2sKICAq
IEBjZGV2OiAgICBDaGFyYWN0ZXIgZGV2aWNlIGluc3RhbmNlIGZvciB0aGlzIGNsb2NrCi0gKiBA
a3JlZjogICAgUmVmZXJlbmNlIGNvdW50LgorICogQGRldjogICAgIFBvaW50ZXIgdG8gdGhlIGNs
b2NrJ3MgZGV2aWNlLgogICogQHJ3c2VtOiAgIFByb3RlY3RzIHRoZSAnem9tYmllJyBmaWVsZCBm
cm9tIGNvbmN1cnJlbnQgYWNjZXNzLgogICogQHpvbWJpZTogIElmICd6b21iaWUnIGlzIHRydWUs
IHRoZW4gdGhlIGhhcmR3YXJlIGhhcyBkaXNhcHBlYXJlZC4KLSAqIEByZWxlYXNlOiBBIGZ1bmN0
aW9uIHRvIGZyZWUgdGhlIHN0cnVjdHVyZSB3aGVuIHRoZSByZWZlcmVuY2UgY291bnQgcmVhY2hl
cwotICogICAgICAgICAgIHplcm8uIE1heSBiZSBOVUxMIGlmIHN0cnVjdHVyZSBpcyBzdGF0aWNh
bGx5IGFsbG9jYXRlZC4KICAqCiAgKiBEcml2ZXJzIHNob3VsZCBlbWJlZCB0aGVpciBzdHJ1Y3Qg
cG9zaXhfY2xvY2sgd2l0aGluIGEgcHJpdmF0ZQogICogc3RydWN0dXJlLCBvYnRhaW5pbmcgYSBy
ZWZlcmVuY2UgdG8gaXQgZHVyaW5nIGNhbGxiYWNrcyB1c2luZwogICogY29udGFpbmVyX29mKCku
CisgKgorICogRHJpdmVycyBzaG91bGQgc3VwcGx5IGFuIGluaXRpYWxpemVkIGJ1dCBub3QgZXhw
b3NlZCBzdHJ1Y3QgZGV2aWNlCisgKiB0byBwb3NpeF9jbG9ja19yZWdpc3RlcigpLiBJdCBpcyB1
c2VkIHRvIG1hbmFnZSBsaWZldGltZSBvZiB0aGUKKyAqIGRyaXZlcidzIHByaXZhdGUgc3RydWN0
dXJlLiBJdCdzICdyZWxlYXNlJyBmaWVsZCBzaG91bGQgYmUgc2V0IHRvCisgKiBhIHJlbGVhc2Ug
ZnVuY3Rpb24gZm9yIHRoaXMgcHJpdmF0ZSBzdHJ1Y3R1cmUuCiAgKi8KIHN0cnVjdCBwb3NpeF9j
bG9jayB7CiAJc3RydWN0IHBvc2l4X2Nsb2NrX29wZXJhdGlvbnMgb3BzOwogCXN0cnVjdCBjZGV2
IGNkZXY7Ci0Jc3RydWN0IGtyZWYga3JlZjsKKwlzdHJ1Y3QgZGV2aWNlICpkZXY7CiAJc3RydWN0
IHJ3X3NlbWFwaG9yZSByd3NlbTsKIAlib29sIHpvbWJpZTsKLQl2b2lkICgqcmVsZWFzZSkoc3Ry
dWN0IHBvc2l4X2Nsb2NrICpjbGspOwogfTsKIAogLyoqCiAgKiBwb3NpeF9jbG9ja19yZWdpc3Rl
cigpIC0gcmVnaXN0ZXIgYSBuZXcgY2xvY2sKLSAqIEBjbGs6ICAgUG9pbnRlciB0byB0aGUgY2xv
Y2suIENhbGxlciBtdXN0IHByb3ZpZGUgJ29wcycgYW5kICdyZWxlYXNlJwotICogQGRldmlkOiBB
bGxvY2F0ZWQgZGV2aWNlIGlkCisgKiBAY2xrOiAgIFBvaW50ZXIgdG8gdGhlIGNsb2NrLiBDYWxs
ZXIgbXVzdCBwcm92aWRlICdvcHMnIGZpZWxkCisgKiBAZGV2OiAgIFBvaW50ZXIgdG8gdGhlIGlu
aXRpYWxpemVkIGRldmljZS4gQ2FsbGVyIG11c3QgcHJvdmlkZQorICogICAgICAgICAncmVsZWFz
ZScgZmllbGQKICAqCiAgKiBBIGNsb2NrIGRyaXZlciBjYWxscyB0aGlzIGZ1bmN0aW9uIHRvIHJl
Z2lzdGVyIGl0c2VsZiB3aXRoIHRoZQogICogY2xvY2sgZGV2aWNlIHN1YnN5c3RlbS4gSWYgJ2Ns
aycgcG9pbnRzIHRvIGR5bmFtaWNhbGx5IGFsbG9jYXRlZApAQCAtMTM1LDcgKzEzOCw3IEBAIHN0
cnVjdCBwb3NpeF9jbG9jayB7CiAgKgogICogUmV0dXJucyB6ZXJvIG9uIHN1Y2Nlc3MsIG5vbi16
ZXJvIG90aGVyd2lzZS4KICAqLwotaW50IHBvc2l4X2Nsb2NrX3JlZ2lzdGVyKHN0cnVjdCBwb3Np
eF9jbG9jayAqY2xrLCBkZXZfdCBkZXZpZCk7CitpbnQgcG9zaXhfY2xvY2tfcmVnaXN0ZXIoc3Ry
dWN0IHBvc2l4X2Nsb2NrICpjbGssIHN0cnVjdCBkZXZpY2UgKmRldik7CiAKIC8qKgogICogcG9z
aXhfY2xvY2tfdW5yZWdpc3RlcigpIC0gdW5yZWdpc3RlciBhIGNsb2NrCmRpZmYgLS1naXQgYS9r
ZXJuZWwvdGltZS9wb3NpeC1jbG9jay5jIGIva2VybmVsL3RpbWUvcG9zaXgtY2xvY2suYwppbmRl
eCBlMjQwMDhjMDk4YzYuLjQ1YTBhMjYwMjNkNCAxMDA2NDQKLS0tIGEva2VybmVsL3RpbWUvcG9z
aXgtY2xvY2suYworKysgYi9rZXJuZWwvdGltZS9wb3NpeC1jbG9jay5jCkBAIC0yNSw4ICsyNSw2
IEBACiAjaW5jbHVkZSA8bGludXgvc3lzY2FsbHMuaD4KICNpbmNsdWRlIDxsaW51eC91YWNjZXNz
Lmg+CiAKLXN0YXRpYyB2b2lkIGRlbGV0ZV9jbG9jayhzdHJ1Y3Qga3JlZiAqa3JlZik7Ci0KIC8q
CiAgKiBSZXR1cm5zIE5VTEwgaWYgdGhlIHBvc2l4X2Nsb2NrIGluc3RhbmNlIGF0dGFjaGVkIHRv
ICdmcCcgaXMgb2xkIGFuZCBzdGFsZS4KICAqLwpAQCAtMTY4LDcgKzE2Niw3IEBAIHN0YXRpYyBp
bnQgcG9zaXhfY2xvY2tfb3BlbihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZnAp
CiAJCWVyciA9IDA7CiAKIAlpZiAoIWVycikgewotCQlrcmVmX2dldCgmY2xrLT5rcmVmKTsKKwkJ
Z2V0X2RldmljZShjbGstPmRldik7CiAJCWZwLT5wcml2YXRlX2RhdGEgPSBjbGs7CiAJfQogb3V0
OgpAQCAtMTg0LDcgKzE4Miw3IEBAIHN0YXRpYyBpbnQgcG9zaXhfY2xvY2tfcmVsZWFzZShzdHJ1
Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZnApCiAJaWYgKGNsay0+b3BzLnJlbGVhc2Up
CiAJCWVyciA9IGNsay0+b3BzLnJlbGVhc2UoY2xrKTsKIAotCWtyZWZfcHV0KCZjbGstPmtyZWYs
IGRlbGV0ZV9jbG9jayk7CisJcHV0X2RldmljZShjbGstPmRldik7CiAKIAlmcC0+cHJpdmF0ZV9k
YXRhID0gTlVMTDsKIApAQCAtMjA2LDM4ICsyMDQsMzUgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBm
aWxlX29wZXJhdGlvbnMgcG9zaXhfY2xvY2tfZmlsZV9vcGVyYXRpb25zID0gewogI2VuZGlmCiB9
OwogCi1pbnQgcG9zaXhfY2xvY2tfcmVnaXN0ZXIoc3RydWN0IHBvc2l4X2Nsb2NrICpjbGssIGRl
dl90IGRldmlkKQoraW50IHBvc2l4X2Nsb2NrX3JlZ2lzdGVyKHN0cnVjdCBwb3NpeF9jbG9jayAq
Y2xrLCBzdHJ1Y3QgZGV2aWNlICpkZXYpCiB7CiAJaW50IGVycjsKIAotCWtyZWZfaW5pdCgmY2xr
LT5rcmVmKTsKIAlpbml0X3J3c2VtKCZjbGstPnJ3c2VtKTsKIAogCWNkZXZfaW5pdCgmY2xrLT5j
ZGV2LCAmcG9zaXhfY2xvY2tfZmlsZV9vcGVyYXRpb25zKTsKKwllcnIgPSBjZGV2X2RldmljZV9h
ZGQoJmNsay0+Y2RldiwgZGV2KTsKKwlpZiAoZXJyKSB7CisJCXByX2VycigiJXMgdW5hYmxlIHRv
IGFkZCBkZXZpY2UgJWQ6JWRcbiIsCisJCQlkZXZfbmFtZShkZXYpLCBNQUpPUihkZXYtPmRldnQp
LCBNSU5PUihkZXYtPmRldnQpKTsKKwkJcmV0dXJuIGVycjsKKwl9CiAJY2xrLT5jZGV2Lm93bmVy
ID0gY2xrLT5vcHMub3duZXI7Ci0JZXJyID0gY2Rldl9hZGQoJmNsay0+Y2RldiwgZGV2aWQsIDEp
OworCWNsay0+ZGV2ID0gZGV2OwogCi0JcmV0dXJuIGVycjsKKwlyZXR1cm4gMDsKIH0KIEVYUE9S
VF9TWU1CT0xfR1BMKHBvc2l4X2Nsb2NrX3JlZ2lzdGVyKTsKIAotc3RhdGljIHZvaWQgZGVsZXRl
X2Nsb2NrKHN0cnVjdCBrcmVmICprcmVmKQotewotCXN0cnVjdCBwb3NpeF9jbG9jayAqY2xrID0g
Y29udGFpbmVyX29mKGtyZWYsIHN0cnVjdCBwb3NpeF9jbG9jaywga3JlZik7Ci0KLQlpZiAoY2xr
LT5yZWxlYXNlKQotCQljbGstPnJlbGVhc2UoY2xrKTsKLX0KLQogdm9pZCBwb3NpeF9jbG9ja191
bnJlZ2lzdGVyKHN0cnVjdCBwb3NpeF9jbG9jayAqY2xrKQogewotCWNkZXZfZGVsKCZjbGstPmNk
ZXYpOworCWNkZXZfZGV2aWNlX2RlbCgmY2xrLT5jZGV2LCBjbGstPmRldik7CiAKIAlkb3duX3dy
aXRlKCZjbGstPnJ3c2VtKTsKIAljbGstPnpvbWJpZSA9IHRydWU7CiAJdXBfd3JpdGUoJmNsay0+
cndzZW0pOwogCi0Ja3JlZl9wdXQoJmNsay0+a3JlZiwgZGVsZXRlX2Nsb2NrKTsKKwlwdXRfZGV2
aWNlKGNsay0+ZGV2KTsKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKHBvc2l4X2Nsb2NrX3VucmVnaXN0
ZXIpOwogCgpGcm9tIDQzMDZhZjg2ZmY0NjBjNjQxMGZiMTk1Mzc2MWM3YWY3ZjA5YTM5NDUgTW9u
IFNlcCAxNyAwMDowMDowMCAyMDAxCkZyb206IFZsYWRpcyBEcm9ub3YgPHZkcm9ub3ZAcmVkaGF0
LmNvbT4KRGF0ZTogTW9uLCAxMyBKYW4gMjAyMCAxNDowMDowOSArMDEwMApTdWJqZWN0OiBwdHA6
IGZyZWUgcHRwIGRldmljZSBwaW4gZGVzY3JpcHRvcnMgcHJvcGVybHkKCmNvbW1pdCA3NTcxODU4
NGNiM2M2NGU2MjY5MTA5ZDRkNTRmODg4YWM1YTVmZDE1IHVwc3RyZWFtLgoKVGhlcmUgaXMgYSBi
dWcgaW4gcHRwX2Nsb2NrX3VucmVnaXN0ZXIoKSwgd2hlcmUgcHRwX2NsZWFudXBfcGluX2dyb3Vw
cygpCmZpcnN0IGZyZWVzIHB0cC0+cGluX3ssZGV2X31hdHRyLCBidXQgdGhlbiBwb3NpeF9jbG9j
a191bnJlZ2lzdGVyKCkgbmVlZHMKdGhlbSB0byBkZXN0cm95IGEgcmVsYXRlZCBzeXNmcyBkZXZp
Y2UuCgpUaGVzZSBmdW5jdGlvbnMgY2FuIG5vdCBiZSBqdXN0IHN3YXBwZWQsIGFzIHBvc2l4X2Ns
b2NrX3VucmVnaXN0ZXIoKSBmcmVlcwpwdHAgd2hpY2ggaXMgbmVlZGVkIGluIHRoZSBwdHBfY2xl
YW51cF9waW5fZ3JvdXBzKCkuIEZpeCB0aGlzIGJ5IGNhbGxpbmcKcHRwX2NsZWFudXBfcGluX2dy
b3VwcygpIGluIHB0cF9jbG9ja19yZWxlYXNlKCksIHJpZ2h0IGJlZm9yZSBwdHAgaXMgZnJlZWQu
CgpUaGlzIG1ha2VzIHRoaXMgcGF0Y2ggZml4IGFuIFVBRiBidWcgaW4gYSBwYXRjaCB3aGljaCBm
aXhlcyBhbiBVQUYgYnVnLgoKUmVwb3J0ZWQtYnk6IEFudHRpIExhYWtzbyA8YW50dGkubGFha3Nv
QGludGVsLmNvbT4KRml4ZXM6IGEzMzEyMWU1NDg3YiAoInB0cDogZml4IHRoZSByYWNlIGJldHdl
ZW4gdGhlIHJlbGVhc2Ugb2YgcHRwX2Nsb2NrIGFuZCBjZGV2IikKTGluazogaHR0cHM6Ly9sb3Jl
Lmtlcm5lbC5vcmcvbmV0ZGV2LzNkMmJkMDk3MzVkYmRhZjAwMzU4NWNhMzc2YjdjMWU1YjY5YTE5
YmQuY2FtZWxAaW50ZWwuY29tLwpTaWduZWQtb2ZmLWJ5OiBWbGFkaXMgRHJvbm92IDx2ZHJvbm92
QHJlZGhhdC5jb20+CkFja2VkLWJ5OiBSaWNoYXJkIENvY2hyYW4gPHJpY2hhcmRjb2NocmFuQGdt
YWlsLmNvbT4KU2lnbmVkLW9mZi1ieTogRGF2aWQgUy4gTWlsbGVyIDxkYXZlbUBkYXZlbWxvZnQu
bmV0PgpTaWduZWQtb2ZmLWJ5OiBCZW4gSHV0Y2hpbmdzIDxiZW4uaHV0Y2hpbmdzQGNvZGV0aGlu
ay5jby51az4KLS0tCiBkcml2ZXJzL3B0cC9wdHBfY2xvY2suYyB8IDQgKystLQogMSBmaWxlIGNo
YW5nZWQsIDIgaW5zZXJ0aW9ucygrKSwgMiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2
ZXJzL3B0cC9wdHBfY2xvY2suYyBiL2RyaXZlcnMvcHRwL3B0cF9jbG9jay5jCmluZGV4IDJjMWFl
MzI0ZGExOC4uYmYxNTM2ZjFjOTBiIDEwMDY0NAotLS0gYS9kcml2ZXJzL3B0cC9wdHBfY2xvY2su
YworKysgYi9kcml2ZXJzL3B0cC9wdHBfY2xvY2suYwpAQCAtMTc1LDYgKzE3NSw3IEBAIHN0YXRp
YyB2b2lkIHB0cF9jbG9ja19yZWxlYXNlKHN0cnVjdCBkZXZpY2UgKmRldikKIHsKIAlzdHJ1Y3Qg
cHRwX2Nsb2NrICpwdHAgPSBjb250YWluZXJfb2YoZGV2LCBzdHJ1Y3QgcHRwX2Nsb2NrLCBkZXYp
OwogCisJcHRwX2NsZWFudXBfcGluX2dyb3VwcyhwdHApOwogCW11dGV4X2Rlc3Ryb3koJnB0cC0+
dHNldnFfbXV4KTsKIAltdXRleF9kZXN0cm95KCZwdHAtPnBpbmNmZ19tdXgpOwogCWlkYV9zaW1w
bGVfcmVtb3ZlKCZwdHBfY2xvY2tzX21hcCwgcHRwLT5pbmRleCk7CkBAIC0yNzYsOSArMjc3LDgg
QEAgaW50IHB0cF9jbG9ja191bnJlZ2lzdGVyKHN0cnVjdCBwdHBfY2xvY2sgKnB0cCkKIAlpZiAo
cHRwLT5wcHNfc291cmNlKQogCQlwcHNfdW5yZWdpc3Rlcl9zb3VyY2UocHRwLT5wcHNfc291cmNl
KTsKIAotCXB0cF9jbGVhbnVwX3Bpbl9ncm91cHMocHRwKTsKLQogCXBvc2l4X2Nsb2NrX3VucmVn
aXN0ZXIoJnB0cC0+Y2xvY2spOworCiAJcmV0dXJuIDA7CiB9CiBFWFBPUlRfU1lNQk9MKHB0cF9j
bG9ja191bnJlZ2lzdGVyKTsK


--=-EHwstzCwUMQpJPrpPoxo--

